var Oa,c=c||{tl:"56"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};self.Int32Array=self.Int32Array||Array;self.Float32Array=self.Float32Array||Array;String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};
c.extend=function(a,b){if(Object.keys)for(var d=Object.keys(b),e=0,f=d.length;e<f;e++){var h=d[e];Object.defineProperty(a,h,Object.getOwnPropertyDescriptor(b,h))}else for(h in d={}.hasOwnProperty,b)d.call(b,h)&&(a[h]=b[h]);return a};
(function(){for(var a=0,b=["ms","moz","webkit","o"],d=0;d<b.length&&!window.requestAnimationFrame;++d)window.requestAnimationFrame=window[b[d]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[d]+"CancelAnimationFrame"]||window[b[d]+"CancelRequestAnimationFrame"];void 0===window.requestAnimationFrame&&(window.requestAnimationFrame=function(e){var f=Date.now(),h=Math.max(0,16-(f-a)),g=window.setTimeout(function(){e(f+h)},h);return a=f+h,g});window.cancelAnimationFrame=window.cancelAnimationFrame||
function(e){window.clearTimeout(e)}})();c.ct=0;c.$s=1;c.Wi=2;c.bt=3;c.ft=0;c.et=1;c.Ws=0;c.ol=1;c.pl=2;c.ih=0;c.df=1;c.Ed=2;c.jt=0;c.ef=1;c.mc=2;c.Zf=0;c.ne=1;c.eg=2;c.ml=0;c.nh=1;c.Yk=2;c.Fl=3;c.Fo=4;c.al=5;c.Xk=100;c.Wo=101;c.Po=102;c.gp=200;c.Io=201;c.Vo=202;c.Lo=203;c.El=204;c.nl=205;c.vo=206;c.Jo=207;c.wo=208;c.Ko=209;c.Uo=210;c.mh=0;c.it=1;c.Vs=2;c.Il=function(){};c.Ys=function(){};c.so=function(){};c.So=function(){};c.mt=function(){};c.kd=1E3;c.Vf=1001;c.hj=1002;c.kf=1003;c.ll=1004;c.kl=1005;
c.oe=1006;c.Bo=1007;c.fj=1008;c.pj=1009;c.ko=1010;c.Ro=1011;c.fp=1012;c.xo=1013;c.ap=1014;c.Xi=1015;c.bp=1016;c.cp=1017;c.ep=1018;c.fo=1019;c.jj=1020;c.bg=1021;c.Do=1022;c.Co=1023;c.wl=2001;c.No=2002;c.ul=2003;c.vl=2004;c.G=function(a){return void 0!==a&&this.set(a),this};
c.extend(c.G.prototype,{r:1,v:1,b:1,set:function(a){switch(typeof a){case "number":this.uc(a);break;case "string":this.hs(a)}},uc:function(a){return a=Math.floor(a),this.r=(a>>16&255)/255,this.v=(a>>8&255)/255,this.b=(255&a)/255,this},rb:function(a,b,d){return this.r=a,this.v=b,this.b=d,this},Px:function(a,b,d){return console.log("DEPRECATED: Color's .setHSV() will be removed. Use .setHSL( h, s, l ) instead."),this.sn(a,b*d/(1>(a=(2-b)*d)?a:2-a),a/2)},sn:function(a,b,d){if(0===b)this.r=this.v=this.b=
d;else{var e=function(f,h,g){return 0>g&&(g+=1),1<g&&--g,g<1/6?f+6*(h-f)*g:.5>g?h:g<2/3?f+6*(h-f)*(2/3-g):f};d=2*d-(b=.5>=d?d*(1+b):d+b-d*b);this.r=e(d,b,a+1/3);this.v=e(d,b,a);this.b=e(d,b,a-1/3)}return this},hs:function(a){return/^rgb\((\d+),(\d+),(\d+)\)$/i.test(a)?(a=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(a),this.r=Math.min(255,parseInt(a[1],10))/255,this.v=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,this):/^rgb\((\d+)%,(\d+)%,(\d+)%\)$/i.test(a)?(a=/^rgb\((\d+)%,(\d+)%,(\d+)%\)$/i.exec(a),
this.r=Math.min(100,parseInt(a[1],10))/100,this.v=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,this):/^#([0-9a-f]{6})$/i.test(a)?(a=/^#([0-9a-f]{6})$/i.exec(a),this.uc(parseInt(a[1],16)),this):/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a)?(a=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.uc(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this):/^(\w+)$/i.test(a)?(this.uc(c.po[a]),this):void 0},i:function(a){return this.r=a.r,this.v=a.v,this.b=a.b,this},Af:function(a){return this.r=
a.r*a.r,this.v=a.v*a.v,this.b=a.b*a.b,this},Yt:function(a){return this.r=Math.sqrt(a.r),this.v=Math.sqrt(a.v),this.b=Math.sqrt(a.b),this},Wt:function(){var a=this.r,b=this.v,d=this.b;return this.r=a*a,this.v=b*b,this.b=d*d,this},Xt:function(){return this.r=Math.sqrt(this.r),this.v=Math.sqrt(this.v),this.b=Math.sqrt(this.b),this},Xc:function(){return 255*this.r<<16^255*this.v<<8^255*this.b<<0},Yu:function(){return("000000"+this.Xc().toString(16)).slice(-6)},Cq:function(){var a={ei:0,Bi:0,hi:0};return function(){var b,
d=this.r,e=this.v,f=this.b,h=Math.max(d,e,f),g=((m=Math.min(d,e,f))+h)/2;if(m===h)m=b=0;else{var n=h-m,m=.5>=g?n/(h+m):n/(2-h-m);switch(h){case d:b=(e-f)/n+(e<f?6:0);break;case e:b=(f-d)/n+2;break;case f:b=(d-e)/n+4}b/=6}return a.ei=b,a.Bi=m,a.hi=g,a}}(),Fe:function(){return"rgb("+(255*this.r|0)+","+(255*this.v|0)+","+(255*this.b|0)+")"},Qw:function(a,b,d){var e=this.Cq();return e.ei+=a,e.Bi+=b,e.hi+=d,this.sn(e.ei,e.Bi,e.hi),this},add:function(a){return this.r+=a.r,this.v+=a.v,this.b+=a.b,this},
Fh:function(a,b){return this.r=a.r+b.r,this.v=a.v+b.v,this.b=a.b+b.b,this},pb:function(a){return this.r+=a,this.v+=a,this.b+=a,this},multiply:function(a){return this.r*=a.r,this.v*=a.v,this.b*=a.b,this},A:function(a){return this.r*=a,this.v*=a,this.b*=a,this},Gg:function(a,b){return this.r+=(a.r-this.r)*b,this.v+=(a.v-this.v)*b,this.b+=(a.b-this.b)*b,this},clone:function(){return(new c.G).rb(this.r,this.v,this.b)}});
c.po={tt:15792383,vt:16444375,yt:65535,zt:8388564,Bt:15794175,Dt:16119260,Et:16770244,Ft:0,Gt:16772045,blue:255,Ht:9055202,Mt:10824234,Nt:14596231,Ot:6266528,Rt:8388352,St:13789470,Zt:16744272,$t:6591981,au:16775388,cu:14423100,gu:65535,iu:139,ju:35723,ku:12092939,lu:11119017,mu:25600,nu:11119017,ou:12433259,pu:9109643,qu:5597999,ru:16747520,su:10040012,tu:9109504,uu:15308410,vu:9419919,wu:4734347,xu:3100495,yu:3100495,zu:52945,Au:9699539,Cu:16716947,Du:49151,Eu:6908265,Fu:6908265,Lu:2003199,Ru:11674146,
Su:16775920,Tu:2263842,Uu:16711935,Vu:14474460,cv:16316671,dv:16766720,ev:14329120,fv:8421504,green:32768,gv:11403055,hv:8421504,lv:15794160,mv:16738740,nv:13458524,ov:4915330,uv:16777200,vv:15787660,xv:15132410,yv:16773365,zv:8190976,Av:16775885,Bv:11393254,Cv:15761536,Dv:14745599,Ev:16448210,Fv:13882323,Gv:9498256,Hv:13882323,Iv:16758465,Jv:16752762,Kv:2142890,Lv:8900346,Mv:7833753,Nv:7833753,Ov:11584734,Pv:16777184,Qv:65280,Rv:3329330,Sv:16445670,Tv:16711935,rw:8388608,uw:6737322,vw:205,ww:12211667,
xw:9662683,yw:3978097,zw:8087790,Aw:64154,Bw:4772300,Cw:13047173,Dw:1644912,Iw:16121850,Jw:16770273,Kw:16770229,Nw:16768685,Ow:128,Rw:16643558,Sw:8421376,Tw:7048739,Uw:16753920,Vw:16729344,Ww:14315734,Xw:15657130,Yw:10025880,Zw:11529966,$w:14381203,ax:16773077,ex:16767673,gx:13468991,ix:16761035,kx:14524637,mx:11591910,px:8388736,red:16711680,Bx:12357519,Ex:4286945,Fx:9127187,Gx:16416882,Hx:16032864,Ix:3050327,Jx:16774638,Sx:10506797,Tx:12632256,Ux:8900331,Vx:6970061,Wx:7372944,Xx:7372944,Zx:16775930,
$x:65407,ay:4620980,tan:13808780,hy:32896,iy:14204888,jy:16737095,sy:4251856,yy:15631086,Ay:16113331,By:16777215,Cy:16119285,Dy:16776960,Ey:10145074};c.Lb=function(a,b,d,e){this.x=a||0;this.y=b||0;this.z=d||0;this.w=void 0!==e?e:1};
c.extend(c.Lb.prototype,{set:function(a,b,d,e){return this.x=a,this.y=b,this.z=d,this.w=e,this},i:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w,this},fs:function(a,b){var d=Math.cos(a.x/2),e=Math.cos(a.y/2),f=Math.cos(a.z/2),h=Math.sin(a.x/2),g=Math.sin(a.y/2);a=Math.sin(a.z/2);return void 0===b||"XYZ"===b?(this.x=h*e*f+d*g*a,this.y=d*g*f-h*e*a,this.z=d*e*a+h*g*f,this.w=d*e*f-h*g*a):"YXZ"===b?(this.x=h*e*f+d*g*a,this.y=d*g*f-h*e*a,this.z=d*e*a-h*g*f,this.w=d*e*f+h*g*a):"ZXY"===b?
(this.x=h*e*f-d*g*a,this.y=d*g*f+h*e*a,this.z=d*e*a+h*g*f,this.w=d*e*f-h*g*a):"ZYX"===b?(this.x=h*e*f-d*g*a,this.y=d*g*f+h*e*a,this.z=d*e*a-h*g*f,this.w=d*e*f+h*g*a):"YZX"===b?(this.x=h*e*f+d*g*a,this.y=d*g*f+h*e*a,this.z=d*e*a-h*g*f,this.w=d*e*f-h*g*a):"XZY"===b&&(this.x=h*e*f-d*g*a,this.y=d*g*f-h*e*a,this.z=d*e*a+h*g*f,this.w=d*e*f+h*g*a),this},qn:function(a,b){b/=2;var d=Math.sin(b);return this.x=a.x*d,this.y=a.y*d,this.z=a.z*d,this.w=Math.cos(b),this},gs:function(a){var b,d=(b=a.elements)[0],
e=(a=b[4],b[8]),f=b[1],h=b[5],g=b[9],n=b[2],m=b[6],q=d+h+(b=b[10]);return 0<q?(d=.5/Math.sqrt(q+1),this.w=.25/d,this.x=(m-g)*d,this.y=(e-n)*d,this.z=(f-a)*d):d>h&&d>b?(d=2*Math.sqrt(1+d-h-b),this.w=(m-g)/d,this.x=.25*d,this.y=(a+f)/d,this.z=(e+n)/d):h>b?(d=2*Math.sqrt(1+h-d-b),this.w=(e-n)/d,this.x=(a+f)/d,this.y=.25*d,this.z=(g+m)/d):(d=2*Math.sqrt(1+b-d-h),this.w=(f-a)/d,this.x=(e+n)/d,this.y=(g+m)/d,this.z=.25*d),this},inverse:function(){return this.$p().normalize(),this},$p:function(){return this.x*=
-1,this.y*=-1,this.z*=-1,this},Eg:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var a=this.length();return 0===a?(this.z=this.y=this.x=0,this.w=1):(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a),this},multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),
this.Ym(a,b)):this.Ym(this,a)},Ym:function(a,b){var d=a.x,e=a.y,f=a.z;a=a.w;var h=b.x,g=b.y,n=b.z;b=b.w;return this.x=d*b+a*h+e*n-f*g,this.y=e*b+a*g+f*h-d*n,this.z=f*b+a*n+d*g-e*h,this.w=a*b-d*h-e*g-f*n,this},Zm:function(a){return console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),a.Dj(this)},Qk:function(a,b){var d=this.x,e=this.y,f=this.z,h=this.w,g=h*a.w+d*a.x+e*a.y+f*a.z;if(0>g?(this.w=-a.w,this.x=-a.x,this.y=-a.y,
this.z=-a.z,g=-g):this.i(a),1<=g)return this.w=h,this.x=d,this.y=e,this.z=f,this;a=Math.acos(g);var n=Math.sqrt(1-g*g);return.001>Math.abs(n)?(this.w=.5*(h+this.w),this.x=.5*(d+this.x),this.y=.5*(e+this.y),this.z=.5*(f+this.z),this):(g=Math.sin((1-b)*a)/n,a=Math.sin(b*a)/n,this.w=h*g+this.w*a,this.x=d*g+this.x*a,this.y=e*g+this.y*a,this.z=f*g+this.z*a,this)},ra:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},clone:function(){return new c.Lb(this.x,this.y,this.z,this.w)}});
c.Lb.Qk=function(a,b,d,e){return d.i(a).Qk(b,e)};c.o=function(a,b){this.x=a||0;this.y=b||0};
c.extend(c.o.prototype,{set:function(a,b){return this.x=a,this.y=b,this},vn:function(a){return this.x=a,this},Hi:function(a){return this.y=a,this},pn:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},wm:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},i:function(a){return this.x=a.x,this.y=a.y,this},add:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
this.pc(a,b)):(this.x+=a.x,this.y+=a.y,this)},pc:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},pb:function(a){return this.x+=a,this.y+=a,this},sub:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.O(a,b)):(this.x-=a.x,this.y-=a.y,this)},O:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},A:function(a){return this.x*=a,this.y*=a,this},Vc:function(a){return 0!==a?(this.x/=a,this.y/=a):
this.set(0,0),this},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this},Ya:function(a,b){return this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this},Ke:function(){return this.A(-1)},ba:function(a){return this.x*a.x+this.y*a.y},Eg:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.Vc(this.length())},
Td:function(a){return Math.sqrt(this.ud(a))},ud:function(a){var b=this.x-a.x;return b*b+(a=this.y-a.y)*a},Fi:function(a){var b=this.length();return 0!==b&&a!==b&&this.A(a/b),this},Gg:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},ra:function(a){return a.x===this.x&&a.y===this.y},On:function(){return[this.x,this.y]},clone:function(){return new c.o(this.x,this.y)}});c.g=function(a,b,d){this.x=a||0;this.y=b||0;this.z=d||0};
c.extend(c.g.prototype,{set:function(a,b,d){return this.x=a,this.y=b,this.z=d,this},vn:function(a){return this.x=a,this},Hi:function(a){return this.y=a,this},ks:function(a){return this.z=a,this},pn:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},wm:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},i:function(a){return this.x=
a.x,this.y=a.y,this.z=a.z,this},add:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.pc(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this)},pb:function(a){return this.x+=a,this.y+=a,this.z+=a,this},pc:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},sub:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.O(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this)},O:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.Cr(a,b)):(this.x*=a.x,this.y*=a.y,this.z*=a.z,this)},A:function(a){return this.x*=a,this.y*=a,this.z*=a,this},Cr:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},Bc:function(a){var b=
this.x,d=this.y,e=this.z;a=a.elements;return this.x=a[0]*b+a[3]*d+a[6]*e,this.y=a[1]*b+a[4]*d+a[7]*e,this.z=a[2]*b+a[5]*d+a[8]*e,this},Z:function(a){var b=this.x,d=this.y,e=this.z;a=a.elements;return this.x=a[0]*b+a[4]*d+a[8]*e+a[12],this.y=a[1]*b+a[5]*d+a[9]*e+a[13],this.z=a[2]*b+a[6]*d+a[10]*e+a[14],this},Sc:function(a){var b=this.x,d=this.y,e=this.z,f=1/((a=a.elements)[3]*b+a[7]*d+a[11]*e+a[15]);return this.x=(a[0]*b+a[4]*d+a[8]*e+a[12])*f,this.y=(a[1]*b+a[5]*d+a[9]*e+a[13])*f,this.z=(a[2]*b+a[6]*
d+a[10]*e+a[14])*f,this},Dj:function(a){var b=this.x,d=this.y,e=this.z,f=a.x,h=a.y,g=a.z,n=(a=a.w)*b+h*e-g*d,m=a*d+g*b-f*e,q=a*e+f*d-h*b;b=-f*b-h*d-g*e;return this.x=n*a+b*-f+m*-g-q*-h,this.y=m*a+b*-h+q*-f-n*-g,this.z=q*a+b*-g+n*-h-m*-f,this},xt:function(){var a=new c.Lb;return function(b,d){b=a.fs(b,d);return this.Dj(b),this}}(),wt:function(){var a=new c.Lb;return function(b,d){b=a.qn(b,d);return this.Dj(b),this}}(),oy:function(a){var b=this.x,d=this.y,e=this.z;a=a.elements;return this.x=a[0]*b+
a[4]*d+a[8]*e,this.y=a[1]*b+a[5]*d+a[9]*e,this.z=a[2]*b+a[6]*d+a[10]*e,this.normalize(),this},Ku:function(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this},Vc:function(a){return 0!==a?(this.x/=a,this.y/=a,this.z/=a):this.z=this.y=this.x=0,this},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this.z>a.z&&(this.z=a.z),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this.z<a.z&&(this.z=a.z),this},Ya:function(a,b){return this.x<a.x?this.x=a.x:
this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z),this},Ke:function(){return this.A(-1)},ba:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},Eg:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},Fm:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.Vc(this.length())},Fi:function(a){var b=
this.length();return 0!==b&&a!==b&&this.A(a/b),this},Gg:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this},Dc:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.Ab(a,b);b=this.x;var d=this.y,e=this.z;return this.x=d*a.z-e*a.y,this.y=e*a.x-b*a.z,this.z=b*a.y-d*a.x,this},Ab:function(a,b){return this.x=a.y*b.z-a.z*b.y,this.y=a.z*b.x-a.x*b.z,this.z=a.x*b.y-
a.y*b.x,this},fn:function(){var a=new c.g;return function(b){return a.i(b).normalize(),b=this.ba(a),this.i(a).A(b)}}(),nx:function(){var a=new c.g;return function(b){return a.i(this).fn(b),this.sub(a)}}(),yx:function(){var a=new c.g;return function(b){return a.i(this).fn(b).A(2),this.O(a,this)}}(),ut:function(a){return a=this.ba(a)/(this.length()*a.length()),Math.acos(c.Math.Ya(a,-1,1))},Td:function(a){return Math.sqrt(this.ud(a))},ud:function(a){var b=this.x-a.x,d=this.y-a.y;return b*b+d*d+(a=this.z-
a.z)*a},hb:function(a){return this.x=a.elements[12],this.y=a.elements[13],this.z=a.elements[14],this},Ik:function(a,b){function d(t){return Math.min(Math.max(t,-1),1)}a=(r=a.elements)[0];var e=r[4],f=r[8],h=r[1],g=r[5],n=r[9],m=r[2],q=r[6],r=r[10];return void 0===b||"XYZ"===b?(this.y=Math.asin(d(f)),.99999>Math.abs(f)?(this.x=Math.atan2(-n,r),this.z=Math.atan2(-e,a)):(this.x=Math.atan2(q,g),this.z=0)):"YXZ"===b?(this.x=Math.asin(-d(n)),.99999>Math.abs(n)?(this.y=Math.atan2(f,r),this.z=Math.atan2(h,
g)):(this.y=Math.atan2(-m,a),this.z=0)):"ZXY"===b?(this.x=Math.asin(d(q)),.99999>Math.abs(q)?(this.y=Math.atan2(-m,r),this.z=Math.atan2(-e,g)):(this.y=0,this.z=Math.atan2(h,a))):"ZYX"===b?(this.y=Math.asin(-d(m)),.99999>Math.abs(m)?(this.x=Math.atan2(q,r),this.z=Math.atan2(h,a)):(this.x=0,this.z=Math.atan2(-e,g))):"YZX"===b?(this.z=Math.asin(d(h)),.99999>Math.abs(h)?(this.x=Math.atan2(-n,g),this.y=Math.atan2(-m,a)):(this.x=0,this.y=Math.atan2(f,r))):"XZY"===b&&(this.z=Math.asin(-d(e)),.99999>Math.abs(e)?
(this.x=Math.atan2(q,g),this.y=Math.atan2(f,a)):(this.x=Math.atan2(-n,r),this.y=0)),this},bs:function(a,b){function d(n){return Math.min(Math.max(n,-1),1)}var e=a.x*a.x,f=a.y*a.y,h=a.z*a.z,g=a.w*a.w;return void 0===b||"XYZ"===b?(this.x=Math.atan2(2*(a.x*a.w-a.y*a.z),g-e-f+h),this.y=Math.asin(d(2*(a.x*a.z+a.y*a.w))),this.z=Math.atan2(2*(a.z*a.w-a.x*a.y),g+e-f-h)):"YXZ"===b?(this.x=Math.asin(d(2*(a.x*a.w-a.y*a.z))),this.y=Math.atan2(2*(a.x*a.z+a.y*a.w),g-e-f+h),this.z=Math.atan2(2*(a.x*a.y+a.z*a.w),
g-e+f-h)):"ZXY"===b?(this.x=Math.asin(d(2*(a.x*a.w+a.y*a.z))),this.y=Math.atan2(2*(a.y*a.w-a.z*a.x),g-e-f+h),this.z=Math.atan2(2*(a.z*a.w-a.x*a.y),g-e+f-h)):"ZYX"===b?(this.x=Math.atan2(2*(a.x*a.w+a.z*a.y),g-e-f+h),this.y=Math.asin(d(2*(a.y*a.w-a.x*a.z))),this.z=Math.atan2(2*(a.x*a.y+a.z*a.w),g+e-f-h)):"YZX"===b?(this.x=Math.atan2(2*(a.x*a.w-a.z*a.y),g-e+f-h),this.y=Math.atan2(2*(a.y*a.w-a.x*a.z),g+e-f-h),this.z=Math.asin(d(2*(a.x*a.y+a.z*a.w)))):"XZY"===b&&(this.x=Math.atan2(2*(a.x*a.w+a.y*a.z),
g-e+f-h),this.y=Math.atan2(2*(a.x*a.z+a.y*a.w),g+e-f-h),this.z=Math.asin(d(2*(a.z*a.w-a.x*a.y)))),this},Dq:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),d=this.set(a.elements[4],a.elements[5],a.elements[6]).length();a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();return this.x=b,this.y=d,this.z=a,this},ra:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},On:function(){return[this.x,this.y,this.z]},clone:function(){return new c.g(this.x,this.y,
this.z)}});c.oc=function(a,b,d,e){this.x=a||0;this.y=b||0;this.z=d||0;this.w=void 0!==e?e:1};
c.extend(c.oc.prototype,{set:function(a,b,d,e){return this.x=a,this.y=b,this.z=d,this.w=e,this},vn:function(a){return this.x=a,this},Hi:function(a){return this.y=a,this},ks:function(a){return this.z=a,this},Rx:function(a){return this.w=a,this},pn:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},wm:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;
default:throw Error("index is out of range: "+a);}},i:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=void 0!==a.w?a.w:1,this},add:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.pc(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this)},pb:function(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this},pc:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+
b.w,this},sub:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.O(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this)},O:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this},A:function(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this},Z:function(a){var b=this.x,d=this.y,e=this.z,f=this.w;a=a.elements;return this.x=a[0]*b+a[4]*d+a[8]*e+a[12]*f,this.y=a[1]*
b+a[5]*d+a[9]*e+a[13]*f,this.z=a[2]*b+a[6]*d+a[10]*e+a[14]*f,this.w=a[3]*b+a[7]*d+a[11]*e+a[15]*f,this},Vc:function(a){return 0!==a?(this.x/=a,this.y/=a,this.z/=a,this.w/=a):(this.z=this.y=this.x=0,this.w=1),this},Mx:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);return 1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b),this},Nx:function(a){var b=(a=a.elements)[0];var d=a[4];var e=a[8],f=a[1],h=a[5],g=a[9];var n=a[2];var m=a[6];var q=a[10];return.01>Math.abs(d-
f)&&.01>Math.abs(e-n)&&.01>Math.abs(g-m)?.1>Math.abs(d+f)&&.1>Math.abs(e+n)&&.1>Math.abs(g+m)&&.1>Math.abs(b+h+q-3)?(this.set(1,0,0,0),this):(a=Math.PI,q=(q+1)/2,d=(d+f)/4,e=(e+n)/4,g=(g+m)/4,(b=(b+1)/2)>(h=(h+1)/2)&&b>q?.01>b?(m=0,d=n=.707106781):(n=d/(m=Math.sqrt(b)),d=e/m):h>q?.01>h?(m=.707106781,n=0,d=.707106781):(m=d/(n=Math.sqrt(h)),d=g/n):.01>q?(n=m=.707106781,d=0):(m=e/(d=Math.sqrt(q)),n=g/d),this.set(m,n,d,a),this):(a=Math.sqrt((m-g)*(m-g)+(e-n)*(e-n)+(f-d)*(f-d)),.001>Math.abs(a)&&(a=1),
this.x=(m-g)/a,this.y=(e-n)/a,this.z=(f-d)/a,this.w=Math.acos((b+h+q-1)/2),this)},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this.z>a.z&&(this.z=a.z),this.w>a.w&&(this.w=a.w),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this.z<a.z&&(this.z=a.z),this.w<a.w&&(this.w=a.w),this},Ya:function(a,b){return this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z),
this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w),this},Ke:function(){return this.A(-1)},ba:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},Eg:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},Fm:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.Vc(this.length())},Fi:function(a){var b=this.length();
return 0!==b&&a!==b&&this.A(a/b),this},Gg:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this},ra:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},On:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new c.oc(this.x,this.y,this.z,this.w)}});c.hl=function(a,b){this.start=void 0!==a?a:new c.g;this.end=void 0!==b?b:new c.g};
c.extend(c.hl.prototype,{set:function(a,b){return this.start.i(a),this.end.i(b),this},i:function(a){return this.start.i(a.start),this.end.i(a.end),this},ha:function(a){return(a||new c.g).pc(this.start,this.end).A(.5)},Vj:function(a){return(a||new c.g).O(this.end,this.start)},Iu:function(){return this.start.ud(this.end)},Bb:function(){return this.start.Td(this.end)},at:function(a,b){return this.Vj(b||new c.g).A(a).add(this.start)},Vp:function(){var a=new c.g,b=new c.g;return function(d,e){a.O(d,this.start);
b.O(this.end,this.start);d=b.ba(b);d=b.ba(a)/d;return e&&(d=c.Math.Ya(d,0,1)),d}}(),Up:function(a,b,d){return a=this.Vp(a,b),d=d||new c.g,this.Vj(d).A(a).add(this.start)},Z:function(a){return this.start.Z(a),this.end.Z(a),this},ra:function(a){return a.start.ra(this.start)&&a.end.ra(this.end)},clone:function(){return(new c.hl).i(this)}});c.Tf=function(a,b){this.min=void 0!==a?a:new c.o(1/0,1/0);this.max=void 0!==b?b:new c.o(-1/0,-1/0)};
c.extend(c.Tf.prototype,{set:function(a,b){return this.min.i(a),this.max.i(b),this},ce:function(a){if(0<a.length){var b=a[0];this.min.i(b);this.max.i(b);for(var d=1,e=a.length;d<e;d++)(b=a[d]).x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y)}else this.Jf();return this},ds:function(){var a=new c.o;return function(b,d){d=a.i(d).A(.5);return this.min.i(b).sub(d),this.max.i(b).add(d),this}}(),i:function(a){return this.min.i(a.min),
this.max.i(a.max),this},Jf:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},ha:function(a){return(a||new c.o).pc(this.min,this.max).A(.5)},size:function(a){return(a||new c.o).O(this.max,this.min)},qq:function(a){return this.min.min(a),this.max.max(a),this},rq:function(a){return this.min.sub(a),this.max.add(a),this},Cf:function(a){return this.min.pb(-a),this.max.pb(a),this},zf:function(a){return!(a.x<
this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)},aq:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},getParameter:function(a){return new c.o((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},Ie:function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)},em:function(a,b){return(b||new c.o).i(a).Ya(this.min,this.max)},Cb:function(){var a=new c.o;return function(b){return a.i(b).Ya(this.min,
this.max).sub(b).length()}}(),Cm:function(a){return this.min.max(a.min),this.max.min(a.max),this},Yn:function(a){return this.min.min(a.min),this.max.max(a.max),this},translate:function(a){return this.min.add(a),this.max.add(a),this},ra:function(a){return a.min.ra(this.min)&&a.max.ra(this.max)},clone:function(){return(new c.Tf).i(this)}});c.ke=function(a,b){this.min=void 0!==a?a:new c.g(1/0,1/0,1/0);this.max=void 0!==b?b:new c.g(-1/0,-1/0,-1/0)};
c.extend(c.ke.prototype,{set:function(a,b){return this.min.i(a),this.max.i(b),this},ce:function(a){if(0<a.length){var b=a[0];this.min.i(b);this.max.i(b);for(var d=1,e=a.length;d<e;d++)(b=a[d]).x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y),b.z<this.min.z?this.min.z=b.z:b.z>this.max.z&&(this.max.z=b.z)}else this.Jf();return this},ds:function(){var a=new c.g;return function(b,d){d=a.i(d).A(.5);return this.min.i(b).sub(d),this.max.i(b).add(d),
this}}(),i:function(a){return this.min.i(a.min),this.max.i(a.max),this},Jf:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},ha:function(a){return(a||new c.g).pc(this.min,this.max).A(.5)},size:function(a){return(a||new c.g).O(this.max,this.min)},qq:function(a){return this.min.min(a),this.max.max(a),this},rq:function(a){return this.min.sub(a),this.max.add(a),
this},Cf:function(a){return this.min.pb(-a),this.max.pb(a),this},zf:function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z)},aq:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z},getParameter:function(a){return new c.g((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},Ie:function(a){return!(a.max.x<
this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z)},em:function(a,b){return(b||new c.g).i(a).Ya(this.min,this.max)},Cb:function(){var a=new c.g;return function(b){return a.i(b).Ya(this.min,this.max).sub(b).length()}}(),Xu:function(){var a=new c.g;return function(b){return(b=b||new c.Kd).ha=this.ha(),b.P=.5*this.size(a).length(),b}}(),Cm:function(a){return this.min.max(a.min),this.max.min(a.max),this},Yn:function(a){return this.min.min(a.min),
this.max.max(a.max),this},Z:function(){var a=[new c.g,new c.g,new c.g,new c.g,new c.g,new c.g,new c.g,new c.g];return function(b){return a[0].set(this.min.x,this.min.y,this.min.z).Z(b),a[1].set(this.min.x,this.min.y,this.max.z).Z(b),a[2].set(this.min.x,this.max.y,this.min.z).Z(b),a[3].set(this.min.x,this.max.y,this.max.z).Z(b),a[4].set(this.max.x,this.min.y,this.min.z).Z(b),a[5].set(this.max.x,this.min.y,this.max.z).Z(b),a[6].set(this.max.x,this.max.y,this.min.z).Z(b),a[7].set(this.max.x,this.max.y,
this.max.z).Z(b),this.Jf(),this.ce(a),this}}(),translate:function(a){return this.min.add(a),this.max.add(a),this},ra:function(a){return a.min.ra(this.min)&&a.max.ra(this.max)},clone:function(){return(new c.ke).i(this)}});c.hd=function(a,b,d,e,f,h,g,n,m){this.elements=new Float32Array(9);this.set(void 0!==a?a:1,b||0,d||0,e||0,void 0!==f?f:1,h||0,g||0,n||0,void 0!==m?m:1)};
c.extend(c.hd.prototype,{set:function(a,b,d,e,f,h,g,n,m){var q=this.elements;return q[0]=a,q[3]=b,q[6]=d,q[1]=e,q[4]=f,q[7]=h,q[2]=g,q[5]=n,q[8]=m,this},fi:function(){return this.set(1,0,0,0,1,0,0,0,1),this},i:function(a){return a=a.elements,this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]),this},Zm:function(a){return console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),a.Bc(this)},xk:function(){var a=new c.g;return function(b){for(var d=
0,e=b.length;d<e;d+=3)a.x=b[d],a.y=b[d+1],a.z=b[d+2],a.Bc(this),b[d]=a.x,b[d+1]=a.y,b[d+2]=a.z;return b}}(),A:function(a){var b=this.elements;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this},gq:function(){var a,b=(a=this.elements)[0],d=a[1],e=a[2],f=a[3],h=a[4],g=a[5],n=a[6],m=a[7];return b*h*(a=a[8])-b*g*m-d*f*a+d*g*n+e*f*m-e*h*n},gb:function(a,b){a=a.elements;var d=this.elements;if(d[0]=a[10]*a[5]-a[6]*a[9],d[1]=-a[10]*a[1]+a[2]*a[9],d[2]=a[6]*a[1]-a[2]*a[5],
d[3]=-a[10]*a[4]+a[6]*a[8],d[4]=a[10]*a[0]-a[2]*a[8],d[5]=-a[6]*a[0]+a[2]*a[4],d[6]=a[9]*a[4]-a[5]*a[8],d[7]=-a[9]*a[0]+a[1]*a[8],d[8]=a[5]*a[0]-a[1]*a[4],0===(a=a[0]*d[0]+a[1]*d[3]+a[2]*d[6])){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.fi(),this}return this.A(1/a),this},Bd:function(){var a,b=this.elements;return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],
b[7]=a,this},$u:function(a){return this.gb(a).Bd(),this},py:function(a){var b=this.elements;return a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8],this},clone:function(){var a=this.elements;return new c.hd(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}});
c.da=function(a,b,d,e,f,h,g,n,m,q,r,t,p,w,u,A){var y=this.elements=new Float32Array(16);y[0]=void 0!==a?a:1;y[4]=b||0;y[8]=d||0;y[12]=e||0;y[1]=f||0;y[5]=void 0!==h?h:1;y[9]=g||0;y[13]=n||0;y[2]=m||0;y[6]=q||0;y[10]=void 0!==r?r:1;y[14]=t||0;y[3]=p||0;y[7]=w||0;y[11]=u||0;y[15]=void 0!==A?A:1};
c.extend(c.da.prototype,{set:function(a,b,d,e,f,h,g,n,m,q,r,t,p,w,u,A){var y=this.elements;return y[0]=a,y[4]=b,y[8]=d,y[12]=e,y[1]=f,y[5]=h,y[9]=g,y[13]=n,y[2]=m,y[6]=q,y[10]=r,y[14]=t,y[3]=p,y[7]=w,y[11]=u,y[15]=A,this},fi:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},i:function(a){return a=a.elements,this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]),this},tn:function(a,b){var d=this.elements,e=a.x,f=a.y;a=a.z;var h=Math.cos(e),g=
(e=Math.sin(e),Math.cos(f)),n=(f=Math.sin(f),Math.cos(a));a=Math.sin(a);if(void 0===b||"XYZ"===b){var m=h*n,q=h*a,r=e*n,t=e*a;d[0]=g*n;d[4]=-g*a;d[8]=f;d[1]=q+r*f;d[5]=m-t*f;d[9]=-e*g;d[2]=t-m*f;d[6]=r+q*f;d[10]=h*g}else"YXZ"===b?(m=g*n,q=g*a,r=f*n,t=f*a,d[0]=m+t*e,d[4]=r*e-q,d[8]=h*f,d[1]=h*a,d[5]=h*n,d[9]=-e,d[2]=q*e-r,d[6]=t+m*e,d[10]=h*g):"ZXY"===b?(m=g*n,q=g*a,r=f*n,t=f*a,d[0]=m-t*e,d[4]=-h*a,d[8]=r+q*e,d[1]=q+r*e,d[5]=h*n,d[9]=t-m*e,d[2]=-h*f,d[6]=e,d[10]=h*g):"ZYX"===b?(m=h*n,q=h*a,r=e*n,t=
e*a,d[0]=g*n,d[4]=r*f-q,d[8]=m*f+t,d[1]=g*a,d[5]=t*f+m,d[9]=q*f-r,d[2]=-f,d[6]=e*g,d[10]=h*g):"YZX"===b?(m=h*g,q=h*f,r=e*g,t=e*f,d[0]=g*n,d[4]=t-m*a,d[8]=r*a+q,d[1]=a,d[5]=h*n,d[9]=-e*n,d[2]=-f*n,d[6]=q*a+r,d[10]=m-t*a):"XZY"===b&&(m=h*g,q=h*f,r=e*g,t=e*f,d[0]=g*n,d[4]=-a,d[8]=f*n,d[1]=m*a+t,d[5]=h*n,d[9]=q*a-r,d[2]=r*a-q,d[6]=e*n,d[10]=t*a+m);return this},un:function(a){var b=this.elements,d=a.x,e=a.y,f=a.z,h=a.w,g=f+f,n=(a=d*(q=d+d),d*(r=e+e)),m=(d*=g,e*r),q=(e*=g,f*=g,h*q),r=h*r;h*=g;return b[0]=
1-(m+f),b[4]=n-h,b[8]=d+r,b[1]=n+h,b[5]=1-(a+f),b[9]=e-q,b[2]=d-r,b[6]=e+q,b[10]=1-(a+m),this},jb:function(){var a=new c.g,b=new c.g,d=new c.g;return function(e,f,h){var g=this.elements;return d.O(e,f).normalize(),0===d.length()&&(d.z=1),a.Ab(h,d).normalize(),0===a.length()&&(d.x+=1E-4,a.Ab(h,d).normalize()),b.Ab(d,a),g[0]=a.x,g[4]=b.x,g[8]=d.x,g[1]=a.y,g[5]=b.y,g[9]=d.y,g[2]=a.z,g[6]=b.z,g[10]=d.z,this}}(),multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),
this.Ea(a,b)):this.Ea(this,a)},Ea:function(a,b){a=a.elements;b=b.elements;var d=this.elements,e=a[0],f=a[4],h=a[8],g=a[12],n=a[1],m=a[5],q=a[9],r=a[13],t=a[2],p=a[6],w=a[10],u=a[14],A=a[3],y=a[7],C=a[11],G=(a=a[15],b[0]),I=b[4],L=b[8],K=b[12],Q=b[1],O=b[5],fa=b[9],Z=b[13],Ga=b[2],R=b[6],V=b[10],aa=b[14],U=b[3],ba=b[7],da=b[11];b=b[15];return d[0]=e*G+f*Q+h*Ga+g*U,d[4]=e*I+f*O+h*R+g*ba,d[8]=e*L+f*fa+h*V+g*da,d[12]=e*K+f*Z+h*aa+g*b,d[1]=n*G+m*Q+q*Ga+r*U,d[5]=n*I+m*O+q*R+r*ba,d[9]=n*L+m*fa+q*V+r*da,
d[13]=n*K+m*Z+q*aa+r*b,d[2]=t*G+p*Q+w*Ga+u*U,d[6]=t*I+p*O+w*R+u*ba,d[10]=t*L+p*fa+w*V+u*da,d[14]=t*K+p*Z+w*aa+u*b,d[3]=A*G+y*Q+C*Ga+a*U,d[7]=A*I+y*O+C*R+a*ba,d[11]=A*L+y*fa+C*V+a*da,d[15]=A*K+y*Z+C*aa+a*b,this},Lw:function(a,b,d){var e=this.elements;return this.Ea(a,b),d[0]=e[0],d[1]=e[1],d[2]=e[2],d[3]=e[3],d[4]=e[4],d[5]=e[5],d[6]=e[6],d[7]=e[7],d[8]=e[8],d[9]=e[9],d[10]=e[10],d[11]=e[11],d[12]=e[12],d[13]=e[13],d[14]=e[14],d[15]=e[15],this},A:function(a){var b=this.elements;return b[0]*=a,b[4]*=
a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},Zm:function(a){return console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),a.Sc(this)},Mw:function(a){return console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.Z(this)},xk:function(){var a=new c.g;return function(b){for(var d=
0,e=b.length;d<e;d+=3)a.x=b[d],a.y=b[d+1],a.z=b[d+2],a.Sc(this),b[d]=a.x,b[d+1]=a.y,b[d+2]=a.z;return b}}(),Wr:function(a){var b=this.elements,d=a.x,e=a.y,f=a.z;return a.x=d*b[0]+e*b[4]+f*b[8],a.y=d*b[1]+e*b[5]+f*b[9],a.z=d*b[2]+e*b[6]+f*b[10],a.normalize(),a},du:function(a){var b=this.elements,d=new c.oc;return d.x=b[0]*a.x+b[4]*a.y+b[8]*a.z+b[12]*a.w,d.y=b[1]*a.x+b[5]*a.y+b[9]*a.z+b[13]*a.w,d.z=b[2]*a.x+b[6]*a.y+b[10]*a.z+b[14]*a.w,d.w=a.w?b[3]*a.x+b[7]*a.y+b[11]*a.z+b[15]*a.w:1,d},gq:function(){var a=
this.elements,b=a[0],d=a[4],e=a[8],f=a[12],h=a[1],g=a[5],n=a[9],m=a[13],q=a[2],r=a[6],t=a[10],p=a[14];return a[3]*(+f*n*r-e*m*r-f*g*t+d*m*t+e*g*p-d*n*p)+a[7]*(+b*n*p-b*m*t+f*h*t-e*h*p+e*m*q-f*n*q)+a[11]*(+b*m*r-b*g*p-f*h*r+d*h*p+f*g*q-d*m*q)+a[15]*(-e*g*q-b*n*r+b*g*t+e*h*r-d*h*t+d*n*q)},Bd:function(){var a,b=this.elements;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this},uq:function(a){var b=
this.elements;return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},pm:function(a,b){var d=this.elements;return a[b]=d[0],a[b+1]=d[1],a[b+2]=d[2],a[b+3]=d[3],a[b+4]=d[4],a[b+5]=d[5],a[b+6]=d[6],a[b+7]=d[7],a[b+8]=d[8],a[b+9]=d[9],a[b+10]=d[10],a[b+11]=d[11],a[b+12]=d[12],a[b+13]=d[13],a[b+14]=d[14],a[b+15]=d[15],a},bv:function(){var a=new c.g;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");
var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;return b[12]=a.x,b[13]=a.y,b[14]=a.z,this},gb:function(a,b){var d=this.elements;a=a.elements;var e=a[0],f=a[4],h=a[8],g=a[12],n=a[1],m=a[5],q=a[9],r=a[13],t=a[2],p=a[6],w=a[10],u=a[14],A=a[3],y=a[7],C=a[11],G=a[15];if(d[0]=q*u*y-r*w*y+r*p*C-m*u*C-q*p*G+m*w*G,d[4]=g*w*y-h*u*y-g*p*C+f*u*C+h*p*G-f*w*G,d[8]=h*r*y-g*q*y+g*m*C-f*r*C-h*m*G+f*q*G,d[12]=g*q*p-h*r*p-g*m*w+f*r*w+h*m*u-f*q*u,d[1]=r*w*A-q*u*A-r*
t*C+n*u*C+q*t*G-n*w*G,d[5]=h*u*A-g*w*A+g*t*C-e*u*C-h*t*G+e*w*G,d[9]=g*q*A-h*r*A-g*n*C+e*r*C+h*n*G-e*q*G,d[13]=h*r*t-g*q*t+g*n*w-e*r*w-h*n*u+e*q*u,d[2]=m*u*A-r*p*A+r*t*y-n*u*y-m*t*G+n*p*G,d[6]=g*p*A-f*u*A-g*t*y+e*u*y+f*t*G-e*p*G,d[10]=f*r*A-g*m*A+g*n*y-e*r*y-f*n*G+e*m*G,d[14]=g*m*t-f*r*t-g*n*p+e*r*p+f*n*u-e*m*u,d[3]=q*p*A-m*w*A-q*t*y+n*w*y+m*t*C-n*p*C,d[7]=f*w*A-h*p*A+h*t*y-e*w*y-f*t*C+e*p*C,d[11]=h*m*A-f*q*A-h*n*y+e*q*y+f*n*C-e*m*C,d[15]=f*q*t-h*m*t+h*n*p-e*q*p-f*n*w+e*m*w,0==(d=a[0]*d[0]+a[1]*d[4]+
a[2]*d[8]+a[3]*d[12])){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.fi(),this}return this.A(1/d),this},Zp:function(){var a=new c.da,b=new c.da;return function(d,e,f){var h=this.elements;return a.fi(),a.un(e),b.jr(f.x,f.y,f.z),this.Ea(a,b),h[12]=d.x,h[13]=d.y,h[14]=d.z,this}}(),Ph:function(){var a=new c.g,b=new c.g,d=new c.g,e=new c.da;return function(f,h,g){var n=this.elements;
return a.set(n[0],n[1],n[2]),b.set(n[4],n[5],n[6]),d.set(n[8],n[9],n[10]),f=f instanceof c.g?f:new c.g,h=h instanceof c.Lb?h:new c.Lb,(g=g instanceof c.g?g:new c.g).x=a.length(),g.y=b.length(),g.z=d.length(),f.x=n[12],f.y=n[13],f.z=n[14],e.i(this),e.elements[0]/=g.x,e.elements[1]/=g.x,e.elements[2]/=g.x,e.elements[4]/=g.y,e.elements[5]/=g.y,e.elements[6]/=g.y,e.elements[8]/=g.z,e.elements[9]/=g.z,e.elements[10]/=g.z,h.gs(e),[f,h,g]}}(),Nu:function(a){var b=this.elements;a=a.elements;return b[12]=
a[12],b[13]=a[13],b[14]=a[14],this},tq:function(){var a=new c.g;return function(b){var d=this.elements,e=(b=b.elements,1/a.set(b[0],b[1],b[2]).length()),f=1/a.set(b[4],b[5],b[6]).length(),h=1/a.set(b[8],b[9],b[10]).length();return d[0]=b[0]*e,d[1]=b[1]*e,d[2]=b[2]*e,d[4]=b[4]*f,d[5]=b[5]*f,d[6]=b[6]*f,d[8]=b[8]*h,d[9]=b[9]*h,d[10]=b[10]*h,this}}(),translate:function(a){var b=this.elements,d=a.x,e=a.y;a=a.z;return b[12]=b[0]*d+b[4]*e+b[8]*a+b[12],b[13]=b[1]*d+b[5]*e+b[9]*a+b[13],b[14]=b[2]*d+b[6]*
e+b[10]*a+b[14],b[15]=b[3]*d+b[7]*e+b[11]*a+b[15],this},ln:function(a){var b=this.elements,d=b[4],e=b[5],f=b[6],h=b[7],g=b[8],n=b[9],m=b[10],q=b[11],r=Math.cos(a);a=Math.sin(a);return b[4]=r*d+a*g,b[5]=r*e+a*n,b[6]=r*f+a*m,b[7]=r*h+a*q,b[8]=r*g-a*d,b[9]=r*n-a*e,b[10]=r*m-a*f,b[11]=r*q-a*h,this},Xr:function(a){var b=this.elements,d=b[0],e=b[1],f=b[2],h=b[3],g=b[8],n=b[9],m=b[10],q=b[11],r=Math.cos(a);a=Math.sin(a);return b[0]=r*d-a*g,b[1]=r*e-a*n,b[2]=r*f-a*m,b[3]=r*h-a*q,b[8]=r*g+a*d,b[9]=r*n+a*e,
b[10]=r*m+a*f,b[11]=r*q+a*h,this},Yr:function(a){var b=this.elements,d=b[0],e=b[1],f=b[2],h=b[3],g=b[4],n=b[5],m=b[6],q=b[7],r=Math.cos(a);a=Math.sin(a);return b[0]=r*d+a*g,b[1]=r*e+a*n,b[2]=r*f+a*m,b[3]=r*h+a*q,b[4]=r*g-a*d,b[5]=r*n-a*e,b[6]=r*m-a*f,b[7]=r*q-a*h,this},Cx:function(a,b){var d=this.elements;if(1===a.x&&0===a.y&&0===a.z)return this.ln(b);if(0===a.x&&1===a.y&&0===a.z)return this.Xr(b);if(0===a.x&&0===a.y&&1===a.z)return this.Yr(b);var e=a.x,f=a.y;a=a.z;var h=(f/=h=Math.sqrt(e*e+f*f+a*
a),a/=h,(e/=h)*e),g=f*f,n=a*a,m=e*f*(r=1-(p=Math.cos(b))),q=e*a*r,r=f*a*r;b=(e*=t=Math.sin(b),f*t);var t=a*t,p=(a=h+(1-h)*p,h=m+t,f=q-b,m-=t,g+=(1-g)*p,t=r+e,q+=b,r-=e,n+=(1-n)*p,d[0]),w=(e=d[1],b=d[2],d[3]),u=d[4],A=d[5],y=d[6],C=d[7],G=d[8],I=d[9],L=d[10],K=d[11];return d[0]=a*p+h*u+f*G,d[1]=a*e+h*A+f*I,d[2]=a*b+h*y+f*L,d[3]=a*w+h*C+f*K,d[4]=m*p+g*u+t*G,d[5]=m*e+g*A+t*I,d[6]=m*b+g*y+t*L,d[7]=m*w+g*C+t*K,d[8]=q*p+r*u+n*G,d[9]=q*e+r*A+n*I,d[10]=q*b+r*y+n*L,d[11]=q*w+r*C+n*K,this},scale:function(a){var b=
this.elements,d=a.x,e=a.y;a=a.z;return b[0]*=d,b[4]*=e,b[8]*=a,b[1]*=d,b[5]*=e,b[9]*=a,b[2]*=d,b[6]*=e,b[10]*=a,b[3]*=d,b[7]*=e,b[11]*=a,this},xm:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},kr:function(a,b,d){return this.set(1,0,0,a,0,1,0,b,0,0,1,d,0,0,0,1),this},Uv:function(a){var b=Math.cos(a);a=Math.sin(a);return this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1),this},Vv:function(a){var b=
Math.cos(a);a=Math.sin(a);return this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1),this},Wv:function(a){var b=Math.cos(a);a=Math.sin(a);return this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1),this},Nm:function(a,b){var d=Math.cos(b);b=Math.sin(b);var e=1-d,f=a.x,h=a.y;a=a.z;var g=e*f,n=e*h;return this.set(g*f+d,g*h-b*a,g*a+b*h,0,g*h+b*a,n*h+d,n*a-b*f,0,g*a-b*h,n*a+b*f,e*a*a+d,0,0,0,0,1),this},jr:function(a,b,d){return this.set(a,0,0,0,0,b,0,0,0,0,d,0,0,0,0,1),this},Mm:function(a,b,d,e,f,h){var g=this.elements;
return g[0]=2*f/(b-a),g[4]=0,g[8]=(b+a)/(b-a),g[12]=0,g[1]=0,g[5]=2*f/(e-d),g[9]=(e+d)/(e-d),g[13]=0,g[2]=0,g[6]=0,g[10]=-(h+f)/(h-f),g[14]=-2*h*f/(h-f),g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this},ir:function(a,b,d,e){var f=-(a=d*Math.tan(c.Math.hm(.5*a)));return this.Mm(f*b,a*b,f,a,d,e)},hr:function(a,b,d,e,f,h){var g=this.elements,n=b-a,m=d-e,q=h-f;return g[0]=2/n,g[4]=0,g[8]=0,g[12]=-(b+a)/n,g[1]=0,g[5]=2/m,g[9]=0,g[13]=-(d+e)/m,g[2]=0,g[6]=0,g[10]=-2/q,g[14]=-(h+f)/q,g[3]=0,g[7]=0,g[11]=0,g[15]=1,this},
clone:function(){var a=this.elements;return new c.da(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}});c.kj=function(a,b){this.origin=void 0!==a?a:new c.g;this.direction=void 0!==b?b:new c.g};
c.extend(c.kj.prototype,{set:function(a,b){return this.origin.i(a),this.direction.i(b),this},i:function(a){return this.origin.i(a.origin),this.direction.i(a.direction),this},at:function(a,b){return(b||new c.g).i(this.direction).A(a).add(this.origin)},xx:function(){var a=new c.g;return function(b){return this.origin.i(this.at(b,a)),this}}(),Up:function(a,b){b=b||new c.g;b.O(a,this.origin);a=b.ba(this.direction);return b.i(this.direction).A(a).add(this.origin)},Cb:function(){var a=new c.g;return function(b){var d=
a.O(b,this.origin).ba(this.direction);return a.i(this.direction).A(d).add(this.origin),a.Td(b)}}(),tv:function(a){return this.Cb(a.ha)<=a.P},sv:function(a){return 0!=a.u.ba(this.direction)||0==a.Cb(this.origin)},kq:function(a){var b=a.u.ba(this.direction);return 0!=b?-(this.origin.ba(a.u)+a.eb)/b:0==a.Cb(this.origin)?0:void 0},qv:function(a,b){a=this.kq(a);return void 0===a?void 0:this.at(a,b)},Z:function(a){return this.direction.add(this.origin).Z(a),this.origin.Z(a),this.direction.sub(this.origin),
this},ra:function(a){return a.origin.ra(this.origin)&&a.direction.ra(this.direction)},clone:function(){return(new c.kj).i(this)}});c.Kd=function(a,b){this.ha=void 0!==a?a:new c.g;this.P=void 0!==b?b:0};
c.extend(c.Kd.prototype,{set:function(a,b){return this.ha.i(a),this.P=b,this},cs:function(a,b){for(var d=0,e=0,f=b.length;e<f;e++)d=Math.max(d,a.ud(b[e]));return this.ha=a,this.P=Math.sqrt(d),this},i:function(a){return this.ha.i(a.ha),this.P=a.P,this},empty:function(){return 0>=this.P},zf:function(a){return a.ud(this.ha)<=this.P*this.P},Cb:function(a){return a.Td(this.ha)-this.P},Rq:function(a){var b=this.P+a.P;return a.ha.ud(this.ha)<=b*b},em:function(a,b){var d=this.ha.ud(a);b=b||new c.g;return b.i(a),
d>this.P*this.P&&(b.sub(this.ha).normalize(),b.A(this.P).add(this.ha)),b},bi:function(a){return(a=a||new c.ke).set(this.ha,this.ha),a.Cf(this.P),a},Z:function(a){return this.ha.Z(a),this.P*=a.xm(),this},translate:function(a){return this.ha.add(a),this},ra:function(a){return a.ha.ra(this.ha)&&a.P===this.P},clone:function(){return(new c.Kd).i(this)}});
c.gf=function(a,b,d,e,f,h){this.Re=[void 0!==a?a:new c.jd,void 0!==b?b:new c.jd,void 0!==d?d:new c.jd,void 0!==e?e:new c.jd,void 0!==f?f:new c.jd,void 0!==h?h:new c.jd]};
c.extend(c.gf.prototype,{set:function(a,b,d,e,f,h){var g=this.Re;return g[0].i(a),g[1].i(b),g[2].i(d),g[3].i(e),g[4].i(f),g[5].i(h),this},i:function(a){for(var b=this.Re,d=0;6>d;d++)b[d].i(a.Re[d]);return this},Ei:function(a){var b=this.Re,d=(a=(y=a.elements)[0],y[1]),e=y[2],f=y[3],h=y[4],g=y[5],n=y[6],m=y[7],q=y[8],r=y[9],t=y[10],p=y[11],w=y[12],u=y[13],A=y[14],y=y[15];return b[0].Pf(f-a,m-h,p-q,y-w).normalize(),b[1].Pf(f+a,m+h,p+q,y+w).normalize(),b[2].Pf(f+d,m+g,p+r,y+u).normalize(),b[3].Pf(f-
d,m-g,p-r,y-u).normalize(),b[4].Pf(f-e,m-n,p-t,y-A).normalize(),b[5].Pf(f+e,m+n,p+t,y+A).normalize(),this},gi:function(){var a=new c.g;return function(b){var d=b.K,e=this.Re;b=-b.D.yb.P*d.xm();a.hb(d);for(d=0;6>d;d++)if(e[d].Cb(a)<b)return!1;return!0}}(),Rq:function(a){for(var b=this.Re,d=a.ha,e=(a=-a.P,0);6>e;e++)if(b[e].Cb(d)<a)return!1;return!0},zf:function(a){for(var b=this.Re,d=0;6>d;d++)if(0>b[d].Cb(a))return!1;return!0},clone:function(){return(new c.gf).i(this)}});
c.jd=function(a,b){this.u=void 0!==a?a:new c.g(1,0,0);this.eb=void 0!==b?b:0};
c.extend(c.jd.prototype,{set:function(a,b){return this.u.i(a),this.eb=b,this},Pf:function(a,b,d,e){return this.u.set(a,b,d),this.eb=e,this},rn:function(a,b){return this.u.i(a),this.eb=-b.ba(this.u),this},es:function(){var a=new c.g,b=new c.g;return function(d,e,f){return e=a.O(f,e).Dc(b.O(d,e)).normalize(),this.rn(e,d),this}}(),i:function(a){return this.u.i(a.u),this.eb=a.eb,this},normalize:function(){var a=1/this.u.length();return this.u.A(a),this.eb*=a,this},Ke:function(){return this.eb*=-1,this.u.Ke(),
this},Cb:function(a){return this.u.ba(a)+this.eb},Ju:function(a){return this.Cb(a.ha)-a.P},ox:function(a,b){return this.Kr(a,b).sub(a).Ke()},Kr:function(a,b){a=this.Cb(a);return(b||new c.g).i(this.u).A(a)},rv:function(a){var b=this.Cb(a.start);a=this.Cb(a.end);return 0>b&&0<a||0>a&&0<b},pv:function(){var a=new c.g;return function(b,d){d=d||new c.g;var e=b.Vj(a),f=this.u.ba(e);return 0!=f?0>(f=-(b.start.ba(this.u)+this.eb)/f)||1<f?void 0:d.i(e).A(f).add(b.start):0==this.Cb(b.start)?d.i(b.start):void 0}}(),
bq:function(a){return(a||new c.g).i(this.u).A(-this.eb)},Z:function(){var a=new c.g,b=new c.g;return function(d,e){e=e||(new c.hd).gb(d).Bd();e=a.i(this.u).Bc(e);var f=this.bq(b);return f.Z(d),this.rn(e,f),this}}(),translate:function(a){return this.eb-=a.ba(this.u),this},ra:function(a){return a.u.ra(this.u)&&a.eb==this.eb},clone:function(){return(new c.jd).i(this)}});
c.Math={Ya:function(a,b,d){return a<b?b:a>d?d:a},Ut:function(a,b){return a<b?b:a},iw:function(a,b,d,e,f){return e+(a-b)*(f-e)/(d-b)},ts:function(a,b,d){return a<=b?0:a>=d?1:(a=(a-b)/(d-b))*a*(3-2*a)},Yx:function(a,b,d){return a<=b?0:a>=d?1:(a=(a-b)/(d-b))*a*a*(a*(6*a-15)+10)},Sr:function(){return(65280*Math.random()+255*Math.random())/65535},vx:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},tx:function(a,b){return a+Math.random()*(b-a)},ux:function(a){return a*(.5-Math.random())},sign:function(a){return 0>
a?-1:0<a?1:0},hm:function(){var a=Math.PI/180;return function(b){return b*a}}(),sx:function(){var a=180/Math.PI;return function(b){return b*a}}()};
c.nt=function(a){function b(w,u,A,y,C,G,I){return(2*(u-A)+(w=.5*(A-w))+(y=.5*(y-u)))*I+(-3*(u-A)-2*w-y)*G+w*C+u}this.points=a;var d,e,f,h,g,n,m,q,r,t=[],p={x:0,y:0,z:0};this.Ia=function(w){return d=(this.points.length-1)*w,e=Math.floor(d),f=d-e,t[0]=0===e?e:e-1,t[1]=e,t[2]=e>this.points.length-2?this.points.length-1:e+1,t[3]=e>this.points.length-3?this.points.length-1:e+2,n=this.points[t[0]],m=this.points[t[1]],q=this.points[t[2]],r=this.points[t[3]],g=f*(h=f*f),p.x=b(n.x,m.x,q.x,r.x,f,h,g),p.y=b(n.y,
m.y,q.y,r.y,f,h,g),p.z=b(n.z,m.z,q.z,r.z,f,h,g),p};this.zg=function(){var w,u=0,A=new c.g,y=new c.g,C=[],G=0;C[0]=0;w||=100;var I=this.points.length*w;A.i(this.points[0]);for(w=1;w<I;w++){var L=w/I;var K=this.Ia(L);y.i(K);G+=y.Td(A);A.i(K);L*=this.points.length-1;(L=Math.floor(L))!=u&&(C[L]=G,u=L)}return C[C.length]=G,{Tt:C,total:G}}};c.Qc=function(a,b,d){this.a=void 0!==a?a:new c.g;this.b=void 0!==b?b:new c.g;this.c=void 0!==d?d:new c.g};
c.Qc.u=function(){var a=new c.g;return function(b,d,e,f){return(f=f||new c.g).O(e,d),a.O(b,d),f.Dc(a),0<(b=f.Eg())?f.A(1/Math.sqrt(b)):f.set(0,0,0)}}();c.Qc.Gj=function(){var a=new c.g,b=new c.g,d=new c.g;return function(e,f,h,g,n){a.O(g,f);b.O(h,f);d.O(e,f);e=a.ba(a);f=a.ba(b);h=a.ba(d);var m=b.ba(b),q=(g=b.ba(d),e*m-f*f);n=n||new c.g;return 0==q?n.set(-2,-1,-1):(m=(m*h-f*g)*(q=1/q),e=(e*g-f*h)*q,n.set(1-m-e,e,m))}}();
c.Qc.zf=function(){var a=new c.g;return function(b,d,e,f){return 0<=(b=c.Qc.Gj(b,d,e,f,a)).x&&0<=b.y&&1>=b.x+b.y}}();
c.extend(c.Qc.prototype,{constructor:c.Qc,set:function(a,b,d){return this.a.i(a),this.b.i(b),this.c.i(d),this},Ox:function(a,b,d,e){return this.a.i(a[b]),this.b.i(a[d]),this.c.i(a[e]),this},i:function(a){return this.a.i(a.a),this.b.i(a.b),this.c.i(a.c),this},vf:function(){var a=new c.g,b=new c.g;return function(){return a.O(this.c,this.b),b.O(this.a,this.b),.5*a.Dc(b).length()}}(),Ew:function(a){return(a||new c.g).pc(this.a,this.b).add(this.c).A(1/3)},u:function(a){return c.Qc.u(this.a,this.b,this.c,
a)},jx:function(a){return(a||new c.jd).es(this.a,this.b,this.c)},Gj:function(a,b){return c.Qc.Gj(a,this.a,this.b,this.c,b)},zf:function(a){return c.Qc.zf(a,this.a,this.b,this.c)},ra:function(a){return a.a.ra(this.a)&&a.b.ra(this.b)&&a.c.ra(this.c)},clone:function(){return(new c.Qc).i(this)}});c.qt=function(a){return console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead."),a};
c.pt=function(a,b){return console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead."),new c.o(a,b)};c.oo=function(a){this.Fp=void 0===a||a;this.elapsedTime=this.Ak=this.startTime=0;this.Ai=!1};
c.extend(c.oo.prototype,{start:function(){this.Ak=this.startTime=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();this.Ai=!0},stop:function(){this.Aq();this.Ai=!1},Aq:function(){return this.zq(),this.elapsedTime},zq:function(){var a=0;if(this.Fp&&!this.Ai&&this.start(),this.Ai){var b=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();a=.001*(b-this.Ak);this.Ak=b;this.elapsedTime+=a}return a}});
c.Fd=function(){var a={};this.addEventListener=function(b,d){void 0===a[b]&&(a[b]=[]);-1===a[b].indexOf(d)&&a[b].push(d)};this.removeEventListener=function(b,d){d=a[b].indexOf(d);-1!==d&&a[b].splice(d,1)};this.dispatchEvent=function(b){var d=a[b.type];if(void 0!==d){b.target=this;for(var e=0,f=d.length;e<f;e++)d[e].call(this,b)}}};
(function(a){a.xl=function(b,d,e,f){this.Mg=new a.kj(b,d);0<this.Mg.direction.Eg()&&this.Mg.direction.normalize();this.Ka=e||0;this.Oa=f||1/0};new a.da;a.xl.prototype.precision=1E-4;a.xl.prototype.set=function(b,d){this.Mg.set(b,d);0<this.Mg.direction.length()&&this.Mg.direction.normalize()}})(c);
c.H=function(){this.id=c.Go++;this.name="";this.ea={};this.parent=void 0;this.children=[];this.dd=new c.g(0,1,0);this.position=new c.g;this.rotation=new c.g;this.Be=c.H.fq;this.scale=new c.g(1,1,1);this.ad=null;this.zi=!0;this.matrix=new c.da;this.K=new c.da;this.Qm=new c.da;this.$a=this.$b=!0;this.bc=new c.Lb;this.Mc=!1;this.visible=!0;this.Nf=this.qc=!1;this.De=!0};function Yb(a,b){b(a);for(var d=0,e=a.children.length;d<e;d++)Yb(a.children[d],b)}
c.H.prototype={constructor:c.H,uf:function(a){this.matrix.Ea(a,this.matrix);this.scale.Dq(this.matrix);a=(new c.da).tq(this.matrix);this.rotation.Ik(a,this.Be);this.position.hb(this.matrix)},translate:function(a,b){this.matrix.Wr(b);this.position.add(b.A(a))},jb:function(a){this.matrix.jb(a,this.position,this.dd);this.zi&&(!1===this.Mc?this.rotation.Ik(this.matrix,this.Be):this.bc.i(this.matrix.Ph()[1]))},add:function(a){if(a===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");
else if(a instanceof c.H){void 0!==a.parent&&a.parent.remove(a);a.parent=this;this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof c.cg&&lc(b,a)}},remove:function(a){var b=this.children.indexOf(a);if(-1!==b){a.parent=void 0;this.children.splice(b,1);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof c.cg&&tc(b,a)}},ed:function(){this.matrix.setPosition(this.position);!1===this.Mc?this.matrix.tn(this.rotation,this.Be):this.matrix.un(this.bc);1===
this.scale.x&&1===this.scale.y&&1===this.scale.z||this.matrix.scale(this.scale);this.$a=!0},Jb:function(a){!0===this.$b&&this.ed();!0!==this.$a&&!0!==a||(void 0===this.parent?this.K.i(this.matrix):this.K.Ea(this.parent.K,this.matrix),this.$a=!1,a=!0);for(var b=0,d=this.children.length;b<d;b++)this.children[b].Jb(a)},clone:function(a){void 0===a&&(a=new c.H);a.name=this.name;a.dd.i(this.dd);a.position.i(this.position);a.rotation instanceof c.g&&a.rotation.i(this.rotation);a.Be=this.Be;a.scale.i(this.scale);
a.ad=this.ad;a.zi=this.zi;a.matrix.i(this.matrix);a.K.i(this.K);a.Qm.i(this.Qm);a.$b=this.$b;a.$a=this.$a;a.bc.i(this.bc);a.Mc=this.Mc;a.visible=this.visible;a.qc=this.qc;a.Nf=this.Nf;a.De=this.De;for(var b=0;b<this.children.length;b++)a.add(this.children[b].clone());return a}};c.H.st=new c.da;c.H.fq="XYZ";c.Go=0;
c.ij=function(){function a(){if(h===C){var ha=new c.Oo;return y.push(ha),C++,h++,ha}return y[h++]}function b(){if(n===I){var ha=new c.Vb;return G.push(ha),I++,n++,ha}return G[n++]}function d(ha,wa){return wa.z-ha.z}function e(ha,wa){var Ua=0,k=1,W=ha.z+ha.w,qa=wa.z+wa.w,T=-ha.z+ha.w,La=-wa.z+wa.w;return 0<=W&&0<=qa&&0<=T&&0<=La||!(0>W&&0>qa||0>T&&0>La)&&(0>W?Ua=Math.max(Ua,W/(W-qa)):0>qa&&(k=Math.min(k,W/(W-qa))),0>T?Ua=Math.max(Ua,T/(T-La)):0>La&&(k=Math.min(k,T/(T-La))),!(k<Ua)&&(ha.Gg(wa,Ua),wa.Gg(ha,
1-k),!0))}var f,h,g,n,m,q,r,t,p,w,u,A,y=[],C=0,G=[],I=0,L=[],K=0,Q=[],O=0,fa=[],Z=0,Ga=[],R=0,V={lb:[],Pi:[],Eb:[],elements:[]},aa=new c.g,U=new c.oc,ba=new c.ke(new c.g(-1,-1,-1),new c.g(1,1,1)),da=new c.ke,Ba=Array(3),ta=Array(4),Ia=new c.da,S=new c.da,Fa=new c.da,Ca=new c.hd,Ra=new c.hd,Ja=new c.g,ca=new c.gf,za=new c.oc,Ka=new c.oc;this.Zn=function(ha,wa){wa.gn.gb(wa.ta);S.Ea(wa.K,wa.gn);ha.Sc(S)};this.Qr=function(ha,wa,Ua,k){function W(eb){for(var xb=0,Mb=eb.children.length;xb<Mb;xb++){var Ya=
eb.children[xb];!1!==Ya.visible&&(Ya instanceof c.ob?V.Eb.push(Ya):Ya instanceof c.Y||Ya instanceof c.Ga?!1!==Ya.De&&!0!==ca.gi(Ya)||((f=a()).object=Ya,null!==Ya.ad?f.z=Ya.ad:(aa.hb(Ya.K),aa.Sc(S),f.z=aa.z),V.lb.push(f)):Ya instanceof c.te||Ya instanceof c.lf?((f=a()).object=Ya,null!==Ya.ad?f.z=Ya.ad:(aa.hb(Ya.K),aa.Sc(S),f.z=aa.z),V.Pi.push(f)):((f=a()).object=Ya,null!==Ya.ad?f.z=Ya.ad:(aa.hb(Ya.K),aa.Sc(S),f.z=aa.z),V.lb.push(f)),W(Ya))}}var qa,T,La,ub,bb,Ma,ob,pb,Xb,Tb=!1;u=p=r=q=0;V.elements.length=
0;ha.Jb();void 0===wa.parent&&wa.Jb();Ia.i(wa.Ua.gb(wa.K));S.Ea(wa.ta,Ia);Ra.gb(Ia);Ra.Bd();ca.Ei(S);h=0;V.lb.length=0;V.Pi.length=0;V.Eb.length=0;W(ha);!0===Ua&&V.lb.sort(d);ha=0;for(Ua=V.lb.length;ha<Ua;ha++)if(Ma=V.lb[ha].object,A=Ma.K,n=0,Ma instanceof c.Y){var Nb=(ob=Ma.D).l;var kc=ob.s;ob=ob.R;Ca.gb(A);Ca.Bd();var Vc=!0===(Xb=Ma.F instanceof c.Sb)?Ma.F:null;var Sa=0;for(qa=Nb.length;Sa<qa;Sa++)(g=b()).Jc.i(Nb[Sa]).Z(A),g.j.i(g.Jc).Z(S),g.j.x/=g.j.w,g.j.y/=g.j.w,g.j.z/=g.j.w,g.visible=!(-1>g.j.x||
1<g.j.x||-1>g.j.y||1<g.j.y||-1>g.j.z||1<g.j.z);Nb=0;for(Sa=kc.length;Nb<Sa;Nb++){qa=kc[Nb];var qb=!0===Xb?Vc.oa[qa.xa]:Ma.F;if(void 0!==qb){if(ub=qb.Ad,qa instanceof c.aa){if(T=G[qa.a],La=G[qa.b],bb=G[qa.c],Ba[0]=T.j,Ba[1]=La.j,Ba[2]=bb.j,!0!==T.visible&&!0!==La.visible&&!0!==bb.visible&&!ba.Ie(da.ce(Ba)))continue;if(Tb=0>(bb.j.x-T.j.x)*(La.j.y-T.j.y)-(bb.j.y-T.j.y)*(La.j.x-T.j.x),ub!==c.Ed&&Tb!==(ub===c.ih))continue;q===K?(pb=new c.yl,L.push(pb),K++,q++,m=pb):m=L[q++];m.$.i(T);m.ca.i(La);m.sb.i(bb)}else if(qa instanceof
c.la){if(T=G[qa.a],La=G[qa.b],bb=G[qa.c],pb=G[qa.d],ta[0]=T.j,ta[1]=La.j,ta[2]=bb.j,ta[3]=pb.j,!0!==T.visible&&!0!==La.visible&&!0!==bb.visible&&!0!==pb.visible&&!ba.Ie(da.ce(ta)))continue;if(Tb=0>(pb.j.x-T.j.x)*(La.j.y-T.j.y)-(pb.j.y-T.j.y)*(La.j.x-T.j.x)||0>(La.j.x-bb.j.x)*(pb.j.y-bb.j.y)-(La.j.y-bb.j.y)*(pb.j.x-bb.j.x),ub!==c.Ed&&Tb!==(ub===c.ih))continue;if(r===O){var fb=new c.zl;Q.push(fb);O++;r++;m=fb}else m=Q[r++];m.$.i(T);m.ca.i(La);m.sb.i(bb);m.Wk.i(pb)}m.Me.i(qa.u);!1!==Tb||ub!==c.df&&ub!==
c.Ed||m.Me.Ke();m.Me.Bc(Ca).normalize();m.ri.i(m.Me).Bc(Ra);m.og.i(qa.qa).Z(A);T=0;for(La=(bb=qa.M).length;T<La;T++)(pb=m.Dd[T]).i(bb[T]),!1!==Tb||ub!==c.df&&ub!==c.Ed||pb.Ke(),pb.Bc(Ca).normalize(),m.wc[T].i(pb).Bc(Ra);m.Ri=bb.length;T=0;for(La=ob.length;T<La;T++)if(void 0!==(pb=ob[T][Nb]))for(ub=0,bb=pb.length;ub<bb;ub++)m.bf[T][ub]=pb[ub];m.color=qa.color;m.F=qb;Ja.i(m.og).Sc(S);m.z=Ja.z;V.elements.push(m)}}}else if(Ma instanceof c.Ga)for(Fa.Ea(S,A),Nb=Ma.D.l,(T=b()).j.i(Nb[0]).Z(Fa),kc=Ma.type===
c.jf?2:1,Sa=1,qa=Nb.length;Sa<qa;Sa++)(T=b()).j.i(Nb[Sa]).Z(Fa),0<(Sa+1)%kc||(La=G[n-2],za.i(T.j),Ka.i(La.j),!0===e(za,Ka)&&(za.A(1/za.w),Ka.A(1/Ka.w),p===Z?(ob=new c.Al,fa.push(ob),Z++,p++,t=ob):t=fa[p++],t.$.j.i(za),t.ca.j.i(Ka),t.z=Math.max(za.z,Ka.z),t.F=Ma.F,V.elements.push(t)));ha=0;for(Ua=V.Pi.length;ha<Ua;ha++)Ma=V.Pi[ha].object,A=Ma.K,Ma instanceof c.lf&&(U.set(A.elements[12],A.elements[13],A.elements[14],1),U.Z(S),U.z/=U.w,0<U.z&&1>U.z&&(u===R?(Tb=new c.Bl,Ga.push(Tb),R++,u++,w=Tb):w=Ga[u++],
w.object=Ma,w.x=U.x/U.w,w.y=U.y/U.w,w.z=U.z,w.rotation=Ma.rotation.z,w.scale.x=Ma.scale.x*Math.abs(w.x-(U.x+wa.ta.elements[0])/(U.w+wa.ta.elements[12])),w.scale.y=Ma.scale.y*Math.abs(w.y-(U.y+wa.ta.elements[5])/(U.w+wa.ta.elements[13])),w.F=Ma.F,V.elements.push(w)));return!0===k&&V.elements.sort(d),V}};
c.aa=function(a,b,d,e,f,h){this.a=a;this.b=b;this.c=d;this.u=e instanceof c.g?e:new c.g;this.M=e instanceof Array?e:[];this.color=f instanceof c.G?f:new c.G;this.C=f instanceof Array?f:[];this.fd=[];this.xa=void 0!==h?h:0;this.qa=new c.g};
c.aa.prototype={constructor:c.aa,clone:function(){var a,b=new c.aa(this.a,this.b,this.c);b.u.i(this.u);b.color.i(this.color);b.qa.i(this.qa);b.xa=this.xa;var d=0;for(a=this.M.length;d<a;d++)b.M[d]=this.M[d].clone();d=0;for(a=this.C.length;d<a;d++)b.C[d]=this.C[d].clone();d=0;for(a=this.fd.length;d<a;d++)b.fd[d]=this.fd[d].clone();return b}};
c.la=function(a,b,d,e,f,h,g){this.a=a;this.b=b;this.c=d;this.d=e;this.u=f instanceof c.g?f:new c.g;this.M=f instanceof Array?f:[];this.color=h instanceof c.G?h:new c.G;this.C=h instanceof Array?h:[];this.fd=[];this.xa=void 0!==g?g:0;this.qa=new c.g};
c.la.prototype={constructor:c.la,clone:function(){var a,b=new c.la(this.a,this.b,this.c,this.d);b.u.i(this.u);b.color.i(this.color);b.qa.i(this.qa);b.xa=this.xa;var d=0;for(a=this.M.length;d<a;d++)b.M[d]=this.M[d].clone();d=0;for(a=this.C.length;d<a;d++)b.C[d]=this.C[d].clone();d=0;for(a=this.fd.length;d<a;d++)b.fd[d]=this.fd[d].clone();return b}};
c.N=function(){c.Fd.call(this);this.id=c.el++;this.name="";this.l=[];this.Za=[];this.Ne=[];this.s=[];this.Ec=[[]];this.R=[[]];this.L=[];this.Yd=[];this.ja=[];this.he=[];this.ge=[];this.Im=[];this.yb=this.Tc=null;this.Hf=!1;this.wg=!0;this.dm=this.ji=this.za=this.ie=this.ac=this.cf=this.Ae=this.na=!1};
function Uc(a){var b,d;var e=0;for(b=a.s.length;e<b;e++)(d=a.s[e]).qa.set(0,0,0),d instanceof c.aa?(d.qa.add(a.l[d.a]),d.qa.add(a.l[d.b]),d.qa.add(a.l[d.c]),d.qa.Vc(3)):d instanceof c.la&&(d.qa.add(a.l[d.a]),d.qa.add(a.l[d.b]),d.qa.add(a.l[d.c]),d.qa.add(a.l[d.d]),d.qa.Vc(4))}function Fd(a){for(var b=new c.g,d=new c.g,e=0,f=a.s.length;e<f;e++){var h=a.s[e],g=a.l[h.a],n=a.l[h.b];b.O(a.l[h.c],n);d.O(g,n);b.Dc(d);b.normalize();h.u.i(b)}}
function Vd(a){for(var b=0,d=a.l,e=0,f=d.length;e<f;e++)0<e&&(b+=d[e].Td(d[e-1])),a.Im[e]=b}
function Wd(a){var b,d,e,f={},h=[],g=[],n=Math.pow(10,4);a.sj=void 0;var m=0;for(b=a.l.length;m<b;m++){var q=a.l[m];void 0===f[q=[Math.round(q.x*n),Math.round(q.y*n),Math.round(q.z*n)].join("_")]?(f[q]=m,h.push(a.l[m]),g[m]=h.length-1):g[m]=g[f[q]]}n=[];m=0;for(b=a.s.length;m<b;m++)if((f=a.s[m])instanceof c.aa){f.a=g[f.a];f.b=g[f.b];f.c=g[f.c];var r=[f.a,f.b,f.c];for(d=0;3>d;d++)if(r[d]==r[(d+1)%3]){n.push(m);break}}else if(f instanceof c.la){f.a=g[f.a];f.b=g[f.b];f.c=g[f.c];f.d=g[f.d];r=[f.a,f.b,
f.c,f.d];q=-1;for(d=0;4>d;d++)r[d]==r[(d+1)%4]&&(0<=q&&n.push(m),q=d);if(0<=q){r.splice(q,1);var t=new c.aa(r[0],r[1],r[2],f.u,f.color,f.xa);r=0;for(d=a.R.length;r<d;r++)(e=a.R[r][m])&&e.splice(q,1);f.M&&0<f.M.length&&(t.M=f.M,t.M.splice(q,1));f.C&&0<f.C.length&&(t.C=f.C,t.C.splice(q,1));a.s[m]=t}}for(m=n.length-1;0<=m;m--)for(a.s.splice(m,1),r=0,d=a.R.length;r<d;r++)a.R[r].splice(m,1);a.l=h}
c.N.prototype={constructor:c.N,uf:function(a){for(var b=(new c.hd).gb(a).Bd(),d=0,e=this.l.length;d<e;d++)this.l[d].Z(a);d=0;for(e=this.s.length;d<e;d++){var f=this.s[d];f.u.Bc(b).normalize();for(var h=0,g=f.M.length;h<g;h++)f.M[h].Bc(b).normalize();f.qa.Z(a)}},Sd:function(a){var b,d;if(void 0===this.sj){var e=this.sj=Array(this.l.length);var f=0;for(b=this.l.length;f<b;f++)e[f]=new c.g;f=0;for(b=this.s.length;f<b;f++)(d=this.s[f])instanceof c.aa?d.M=[new c.g,new c.g,new c.g]:d instanceof c.la&&(d.M=
[new c.g,new c.g,new c.g,new c.g])}else for(e=this.sj,f=0,b=this.l.length;f<b;f++)e[f].set(0,0,0);if(a){var h,g,n,m=new c.g,q=new c.g,r=new c.g,t=new c.g,p=new c.g;f=0;for(b=this.s.length;f<b;f++)(d=this.s[f])instanceof c.aa?(a=this.l[d.a],h=this.l[d.b],g=this.l[d.c],m.O(g,h),q.O(a,h),m.Dc(q),e[d.a].add(m),e[d.b].add(m),e[d.c].add(m)):d instanceof c.la&&(a=this.l[d.a],h=this.l[d.b],g=this.l[d.c],n=this.l[d.d],r.O(n,h),q.O(a,h),r.Dc(q),e[d.a].add(r),e[d.b].add(r),e[d.d].add(r),t.O(n,g),p.O(h,g),t.Dc(p),
e[d.b].add(t),e[d.c].add(t),e[d.d].add(t))}else for(f=0,b=this.s.length;f<b;f++)(d=this.s[f])instanceof c.aa?(e[d.a].add(d.u),e[d.b].add(d.u),e[d.c].add(d.u)):d instanceof c.la&&(e[d.a].add(d.u),e[d.b].add(d.u),e[d.c].add(d.u),e[d.d].add(d.u));f=0;for(b=this.l.length;f<b;f++)e[f].normalize();f=0;for(b=this.s.length;f<b;f++)(d=this.s[f])instanceof c.aa?(d.M[0].i(e[d.a]),d.M[1].i(e[d.b]),d.M[2].i(e[d.c])):d instanceof c.la&&(d.M[0].i(e[d.a]),d.M[1].i(e[d.b]),d.M[2].i(e[d.c]),d.M[3].i(e[d.d]))},Nh:function(){function a(Ba,
ta,Ia,S,Fa,Ca,Ra){e=Ba.l[ta];f=Ba.l[Ia];h=Ba.l[S];g=aa[Fa];n=aa[Ca];m=aa[Ra];q=f.x-e.x;r=h.x-e.x;t=f.y-e.y;p=h.y-e.y;w=f.z-e.z;u=h.z-e.z;A=n.x-g.x;y=m.x-g.x;C=n.y-g.y;G=m.y-g.y;I=1/(A*G-y*C);Q.set((G*q-C*r)*I,(G*t-C*p)*I,(G*w-C*u)*I);O.set((A*r-y*q)*I,(A*p-y*t)*I,(A*u-y*w)*I);L[ta].add(Q);L[Ia].add(Q);L[S].add(Q);K[ta].add(O);K[Ia].add(O);K[S].add(O)}var b,d,e,f,h,g,n,m,q,r,t,p,w,u,A,y,C,G,I,L=[],K=[],Q=new c.g,O=new c.g,fa=new c.g,Z=new c.g,Ga=new c.g;var R=0;for(b=this.l.length;R<b;R++)L[R]=new c.g,
K[R]=new c.g;R=0;for(b=this.s.length;R<b;R++){var V=this.s[R];var aa=this.R[0][R];V instanceof c.aa?a(this,V.a,V.b,V.c,0,1,2):V instanceof c.la&&(a(this,V.a,V.b,V.d,0,1,3),a(this,V.b,V.c,V.d,1,2,3))}var U=["a","b","c","d"];R=0;for(b=this.s.length;R<b;R++)for(V=this.s[R],d=0;d<V.M.length;d++){Ga.i(V.M[d]);var ba=V[U[d]];var da=L[ba];fa.i(da);fa.sub(Ga.A(Ga.ba(da))).normalize();Z.Ab(V.M[d],da);ba=0>(ba=Z.ba(K[ba]))?-1:1;V.fd[d]=new c.oc(fa.x,fa.y,fa.z,ba)}this.Hf=!0},Pj:function(){null===this.Tc&&(this.Tc=
new c.ke);this.Tc.ce(this.l)},Mh:function(){null===this.yb&&(this.yb=new c.Kd);this.yb.cs(this.yb.ha,this.l)},clone:function(){for(var a=new c.N,b=this.l,d=0,e=b.length;d<e;d++)a.l.push(b[d].clone());d=0;for(e=(b=this.s).length;d<e;d++)a.s.push(b[d].clone());d=0;for(e=(b=this.R[0]).length;d<e;d++){for(var f=b[d],h=[],g=0,n=f.length;g<n;g++)h.push(new c.o(f[g].x,f[g].y));a.R[0].push(h)}return a}};c.el=0;
c.hc=function(){c.Fd.call(this);this.id=c.el++;this.attributes={};this.wg=!1;this.zk=[];this.yb=this.Tc=null;this.Hf=!1;this.L=[]};function re(a){for(var b,d,e=a.attributes.u.h,f=0,h=e.length;f<h;f+=3)a=e[f],b=e[f+1],d=e[f+2],a=1/Math.sqrt(a*a+b*b+d*d),e[f]*=a,e[f+1]*=a,e[f+2]*=a}
c.hc.prototype={constructor:c.hc,uf:function(a){var b,d;this.attributes.position&&(b=this.attributes.position.h);this.attributes.u&&(d=this.attributes.u.h);void 0!==b&&(a.xk(b),this.na=!0);void 0!==d&&((b=new c.hd).gb(a).Bd(),b.xk(d),re(this),this.ac=!0)},Pj:function(){null===this.Tc&&(this.Tc=new c.ke);var a=this.attributes.position.h;if(a){var b=this.Tc;3<=a.length&&(b.min.x=b.max.x=a[0],b.min.y=b.max.y=a[1],b.min.z=b.max.z=a[2]);for(var d=3,e=a.length;d<e;d+=3){var f=a[d];var h=a[d+1];var g=a[d+
2];f<b.min.x?b.min.x=f:f>b.max.x&&(b.max.x=f);h<b.min.y?b.min.y=h:h>b.max.y&&(b.max.y=h);g<b.min.z?b.min.z=g:g>b.max.z&&(b.max.z=g)}}void 0!==a&&0!==a.length||(this.Tc.min.set(0,0,0),this.Tc.max.set(0,0,0))},Mh:function(){null===this.yb&&(this.yb=new c.Kd);var a=this.attributes.position.h;if(a){for(var b,d,e,f=0,h=0,g=a.length;h<g;h+=3)(b=(b=a[h])*b+(d=a[h+1])*d+(e=a[h+2])*e)>f&&(f=b);this.yb.P=Math.sqrt(f)}},Sd:function(){if(this.attributes.position){var a,b,d;if(a=this.attributes.position.h.length,
void 0===this.attributes.u)this.attributes.u={Db:3,h:new Float32Array(a),$d:a};else for(a=0,b=this.attributes.u.h.length;a<b;a++)this.attributes.u.h[a]=0;var e=this.attributes.position.h,f=this.attributes.u.h,h=new c.g,g=new c.g,n=new c.g,m=new c.g,q=new c.g;if(this.attributes.index){var r=this.attributes.index.h,t=this.zk;var p=0;for(d=t.length;p<d;++p){b=t[p].start;var w=t[p].count;var u=t[p].index;a=b;for(b+=w;a<b;a+=3){w=u+r[a];var A=u+r[a+1];var y=u+r[a+2];var C=e[3*w];var G=e[3*w+1];var I=e[3*
w+2];h.set(C,G,I);C=e[3*A];G=e[3*A+1];I=e[3*A+2];g.set(C,G,I);C=e[3*y];G=e[3*y+1];I=e[3*y+2];n.set(C,G,I);m.O(n,g);q.O(h,g);m.Dc(q);f[3*w]+=m.x;f[3*w+1]+=m.y;f[3*w+2]+=m.z;f[3*A]+=m.x;f[3*A+1]+=m.y;f[3*A+2]+=m.z;f[3*y]+=m.x;f[3*y+1]+=m.y;f[3*y+2]+=m.z}}}else for(a=0,b=e.length;a<b;a+=9)C=e[a],G=e[a+1],I=e[a+2],h.set(C,G,I),C=e[a+3],G=e[a+4],I=e[a+5],g.set(C,G,I),C=e[a+6],G=e[a+7],I=e[a+8],n.set(C,G,I),m.O(n,g),q.O(h,g),m.Dc(q),f[a]=m.x,f[a+1]=m.y,f[a+2]=m.z,f[a+3]=m.x,f[a+4]=m.y,f[a+5]=m.z,f[a+6]=
m.x,f[a+7]=m.y,f[a+8]=m.z;re(this);this.ac=!0}},Nh:function(){function a(Ja){Ca.x=e[3*Ja];Ca.y=e[3*Ja+1];Ca.z=e[3*Ja+2];Ra.i(Ca);ta=m[Ja];S.i(ta);S.sub(Ca.A(Ca.ba(ta))).normalize();Fa.Ab(Ra,ta);Ia=Fa.ba(q[Ja]);Ba=0>Ia?-1:1;n[4*Ja]=S.x;n[4*Ja+1]=S.y;n[4*Ja+2]=S.z;n[4*Ja+3]=Ba}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.u||void 0===this.attributes.va)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");
else{var b=this.attributes.index.h,d=this.attributes.position.h,e=this.attributes.u.h,f=this.attributes.va.h,h=d.length/3;if(void 0===this.attributes.Qb){var g=4*h;this.attributes.Qb={Db:4,h:new Float32Array(g),$d:g}}var n=this.attributes.Qb.h,m=[],q=[];for(g=0;g<h;g++)m[g]=new c.g,q[g]=new c.g;h=new c.g;g=new c.g;var r,t=this.zk;var p=0;for(r=t.length;p<r;++p){var w=t[p].start;var u=t[p].count;var A=t[p].index;var y=w;for(w+=u;y<w;y+=3){u=A+b[y];var C=A+b[y+1];var G=A+b[y+2];var I=d[3*u];var L=d[3*
u+1];var K=d[3*u+2];var Q=d[3*C];var O=d[3*C+1];var fa=d[3*C+2];var Z=d[3*G];var Ga=d[3*G+1];var R=d[3*G+2];var V=f[2*u];var aa=f[2*u+1];var U=f[2*C];var ba=f[2*C+1];var da=f[2*G];Q-=I;I=Z-I;O-=L;L=Ga-L;fa-=K;K=R-K;ba-=aa;Z=1/((U-=V)*(aa=(Z=f[2*G+1])-aa)-(V=da-V)*ba);h.set((aa*Q-ba*I)*Z,(aa*O-ba*L)*Z,(aa*fa-ba*K)*Z);g.set((U*I-V*Q)*Z,(U*L-V*O)*Z,(U*K-V*fa)*Z);m[u].add(h);m[C].add(h);m[G].add(h);q[u].add(g);q[C].add(g);q[G].add(g)}}var Ba,ta,Ia,S=new c.g,Fa=new c.g,Ca=new c.g,Ra=new c.g;p=0;for(r=
t.length;p<r;++p)for(w=t[p].start,u=t[p].count,A=t[p].index,y=w,w+=u;y<w;y+=3)u=A+b[y],C=A+b[y+1],G=A+b[y+2],a(u),a(C),a(G);this.ie=this.Hf=!0}}};c.Rb=function(){c.H.call(this);this.Ua=new c.da;this.ta=new c.da;this.gn=new c.da};c.Rb.prototype=Object.create(c.H.prototype);c.Rb.prototype.jb=function(a){this.matrix.jb(this.position,a,this.dd);!0===this.zi&&(!1===this.Mc?this.rotation.Ik(this.matrix,this.Be):this.bc.i(this.matrix.Ph()[1]))};
c.$f=function(a,b,d,e,f,h){c.Rb.call(this);this.left=a;this.right=b;this.top=d;this.bottom=e;this.Ka=void 0!==f?f:.1;this.Oa=void 0!==h?h:2E3;this.je()};c.$f.prototype=Object.create(c.Rb.prototype);c.$f.prototype.je=function(){this.ta.hr(this.left,this.right,this.top,this.bottom,this.Ka,this.Oa)};c.kc=function(a,b,d,e){c.Rb.call(this);this.Ce=void 0!==a?a:50;this.lg=void 0!==b?b:1;this.Ka=void 0!==d?d:.1;this.Oa=void 0!==e?e:2E3;this.je()};c.kc.prototype=Object.create(c.Rb.prototype);
c.kc.prototype.je=function(){if(this.dk){var a=this.dk/this.qm,b=Math.tan(c.Math.hm(.5*this.Ce))*this.Ka,d=a*(e=-b),e=(a=Math.abs(a*b-d),Math.abs(b-e));this.ta.Mm(d+this.x*a/this.dk,d+(this.x+this.width)*a/this.dk,b-(this.y+this.height)*e/this.qm,b-this.y*e/this.qm,this.Ka,this.Oa)}else this.ta.ir(this.Ce,this.lg,this.Ka,this.Oa)};c.ob=function(a){c.H.call(this);this.color=new c.G(a)};c.ob.prototype=Object.create(c.H.prototype);c.dh=function(a){c.ob.call(this,a)};c.dh.prototype=Object.create(c.ob.prototype);
c.io=function(a,b){c.ob.call(this,a);this.u=new c.g(0,-1,0);this.right=new c.g(1,0,0);this.ib=void 0!==b?b:1;this.height=this.width=1};c.io.prototype=Object.create(c.ob.prototype);
c.zc=function(a,b){c.ob.call(this,a);this.position=new c.g(0,1,0);this.target=new c.H;this.ib=void 0!==b?b:1;this.ui=this.qc=!1;this.Rg=50;this.Qg=5E3;this.Mk=-500;this.Ok=this.Nk=500;this.Lk=-500;this.de=!1;this.Qf=0;this.ee=.5;this.Sg=this.Vg=512;this.Pk=!1;this.os=new c.g(0,0,-1E3);this.ms=2;this.wn=[0,0,0];this.ps=[512,512,512];this.ns=[512,512,512];this.yn=[-1,.99,.998];this.xn=[.99,.998,1];this.Ii=[];this.Ye=this.zd=this.Tg=this.We=null};c.zc.prototype=Object.create(c.ob.prototype);
c.Yi=function(a,b,d){c.ob.call(this,a);this.Yc=new c.G(b);this.position=new c.g(0,100,0);this.ib=void 0!==d?d:1};c.Yi.prototype=Object.create(c.ob.prototype);c.mf=function(a,b,d){c.ob.call(this,a);this.position=new c.g(0,0,0);this.ib=void 0!==b?b:1;this.Bb=void 0!==d?d:0};c.mf.prototype=Object.create(c.ob.prototype);
c.nf=function(a,b,d,e,f){c.ob.call(this,a);this.position=new c.g(0,1,0);this.target=new c.H;this.ib=void 0!==b?b:1;this.Bb=void 0!==d?d:0;this.angle=void 0!==e?e:Math.PI/2;this.exponent=void 0!==f?f:10;this.ui=this.qc=!1;this.Rg=50;this.Qg=5E3;this.ls=50;this.de=!1;this.Qf=0;this.ee=.5;this.Sg=this.Vg=512;this.Ye=this.zd=this.Tg=this.We=null};c.nf.prototype=Object.create(c.ob.prototype);
c.Yf=function(a){a&&(a=document.createElement("div"),a.style.position="absolute",a.style.right="0px",a.style.top="0px",a.style.fontSize="0.8em",a.style.textAlign="left",a.style.background="rgba(0,0,0,0.25)",a.style.color="#fff",a.style.width="120px",a.style.padding="0.5em 0.5em 0.5em 0.5em",a.style.zIndex=1E3,a.innerHTML="Loading ...")};function se(a){return(a=a.split("/")).pop(),(1>a.length?".":a.join("/"))+"/"}
function te(a,b){function d(r){return r=Math.log(r)/Math.LN2,Math.floor(r)==r}function e(r){return r=Math.log(r)/Math.LN2,Math.pow(2,Math.round(r))}function f(r,t,p,w,u,A,y){var C=/\.dds$/i.test(p),G=b+"/"+p;if(C){var I=c.Gd.Jm(G);r[t]=I}else I=document.createElement("canvas"),r[t]=new c.wb(I);if(r[t].sourceFile=p,w&&(r[t].repeat.set(w[0],w[1]),1!==w[0]&&(r[t].ec=c.kd),1!==w[1]&&(r[t].fc=c.kd)),u&&r[t].offset.set(u[0],u[1]),A&&(void 0!==(p={repeat:c.kd,wr:c.hj})[A[0]]&&(r[t].ec=p[A[0]]),void 0!==
p[A[1]]&&(r[t].fc=p[A[1]])),y&&(r[t].Mb=y),!C){var L=r[t];(r=new Image).onload=function(){if(d(this.width)&&d(this.height))L.image=this;else{var K=e(this.width),Q=e(this.height);L.image.width=K;L.image.height=Q;L.image.getContext("2d").drawImage(this,0,0,K,Q)}L.ia=!0};r.crossOrigin=g.crossOrigin;r.src=G}}function h(r){return(255*r[0]<<16)+(255*r[1]<<8)+255*r[2]}var g=c.Yf.prototype,n="MeshLambertMaterial",m={color:15658734,opacity:1,map:null,Ja:null,ab:null,zb:null,U:!1};if(a.ua){var q=a.ua.toLowerCase();
"phong"===q?n="MeshPhongMaterial":"basic"===q&&(n="MeshBasicMaterial")}return void 0!==a.qb&&void 0!==c[a.qb]&&(m.qb=c[a.qb]),(void 0!==a.Ba||1>a.opacity)&&(m.Ba=a.Ba),void 0!==a.rc&&(m.rc=a.rc),void 0!==a.td&&(m.td=a.td),void 0!==a.visible&&(m.visible=a.visible),void 0!==a.ck&&(m.Ad=c.df),void 0!==a.Yj&&(m.Ad=c.Ed),void 0!==a.U&&(m.U=a.U),void 0!==a.C&&("face"===a.C?m.C=c.ne:a.C&&(m.C=c.eg)),a.Xp?m.color=h(a.Xp):a.to&&(m.color=a.to),a.Yp&&(m.bd=h(a.Yp)),a.Wp&&(m.ya=h(a.Wp)),a.Ls&&(m.opacity=a.Ls),
a.vs&&(m.fe=a.vs),a.nr&&b&&f(m,"map",a.nr,a.cw,a.bw,a.dw,a.aw),a.pr&&b&&f(m,"lightMap",a.pr,a.gw,a.fw,a.hw,a.ew),a.lr&&b&&f(m,"bumpMap",a.lr,a.Zv,a.Yv,a.$v,a.Xv),a.Om&&b&&f(m,"normalMap",a.Om,a.lw,a.kw,a.mw,a.jw),a.qr&&b&&f(m,"specularMap",a.qr,a.pw,a.ow,a.qw,a.nw),a.mr&&(m.yf=a.mr),a.Om?(n=c.dg.si,(q=c.nc.clone(n.V)).In.value=m.ab,a.Pm&&q.Tn.value.set(a.Pm,a.Pm),m.map&&(q.Hn.value=m.map,q.mm.value=!0),m.Fa&&(q.Jn.value=m.Fa,q.nm.value=!0),m.Ja&&(q.Fn.value=m.Ja,q.lm.value=!0),q.Sn.value.uc(m.color),
q.Wn.value.uc(m.bd),q.Rn.value.uc(m.ya),q.Vn.value=m.fe,void 0!==m.opacity&&(q.Un.value=m.opacity),n=new c.Ra({S:n.S,T:n.T,V:q,Eb:!0,J:!0}),m.Ba&&(n.Ba=!0)):n=new c[n](m),void 0!==a.uo&&(n.name=a.uo),n}c.Yf.prototype={constructor:c.Yf,crossOrigin:"anonymous"};c.$i=function(){c.Fd.call(this);this.crossOrigin=null};
c.$i.prototype={constructor:c.$i,load:function(a,b){var d=this;void 0===b&&(b=new Image);b.addEventListener("load",function(){d.dispatchEvent({type:"load",content:b})},!1);b.addEventListener("error",function(){d.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},!1);d.crossOrigin&&(b.crossOrigin=d.crossOrigin);b.src=a}};c.dj=function(a){c.Yf.call(this,a);this.withCredentials=!1};c.dj.prototype=Object.create(c.Yf.prototype);
c.dj.prototype.load=function(a,b,d){d=d&&"string"==typeof d?d:se(a);ue(this,a,b,d)};
function ue(a,b,d,e){var f=new XMLHttpRequest;f.onreadystatechange=function(){if(f.readyState===f.DONE)if(200===f.status||0===f.status)if(f.responseText){var h=JSON.parse(f.responseText);ve(h,d,e)}else console.warn("THREE.JSONLoader: ["+b+"] seems to be unreachable or file there is empty");else console.error("THREE.JSONLoader: Couldn't load ["+b+"] ["+f.status+"]");else f.readyState===f.LOADING||f.readyState===f.HEADERS_RECEIVED&&f.getResponseHeader("Content-Length")};f.open("GET",b,!0);f.withCredentials=
a.withCredentials;f.send(null)}
function ve(a,b,d){var e,f,h,g,n,m,q,r,t,p,w,u=new c.N,A=void 0!==a.scale?1/a.scale:1,y=a.s;var C=a.l;var G=a.Ne,I=a.Za,L=0;for(e=0;e<a.bf.length;e++)a.bf[e].length&&L++;for(e=0;e<L;e++)u.Ec[e]=[],u.R[e]=[];var K=0;for(g=C.length;K<g;)(n=new c.g).x=C[K++]*A,n.y=C[K++]*A,n.z=C[K++]*A,u.l.push(n);K=0;for(g=y.length;K<g;){if(n=1&(C=y[K++]),h=2&C,e=4&C,f=8&C,q=16&C,m=32&C,t=64&C,C&=128,n?((p=new c.la).a=y[K++],p.b=y[K++],p.c=y[K++],p.d=y[K++],n=4):((p=new c.aa).a=y[K++],p.b=y[K++],p.c=y[K++],n=3),h&&
(h=y[K++],p.xa=h),h=u.s.length,e)for(e=0;e<L;e++){var Q=(w=a.bf[e])[2*(r=y[K++])];r=w[2*r+1];u.Ec[e][h]=new c.o(Q,r)}if(f)for(e=0;e<L;e++){w=a.bf[e];var O=[];for(f=0;f<n;f++)Q=w[2*(r=y[K++])],r=w[2*r+1],O[f]=new c.o(Q,r);u.R[e][h]=O}if(q&&(q=3*y[K++],(f=new c.g).x=G[q++],f.y=G[q++],f.z=G[q],p.u=f),m)for(e=0;e<n;e++)q=3*y[K++],(f=new c.g).x=G[q++],f.y=G[q++],f.z=G[q],p.M.push(f);if(t&&(m=y[K++],m=new c.G(I[m]),p.color=m),C)for(e=0;e<n;e++)m=y[K++],m=new c.G(I[m]),p.C.push(m);u.s.push(p)}if(a.he)for(K=
0,g=a.he.length;K<g;K+=2)y=a.he[K],G=a.he[K+1],u.he.push(new c.oc(y,G,0,0));if(a.ge)for(K=0,g=a.ge.length;K<g;K+=2)y=a.ge[K],G=a.ge[K+1],u.ge.push(new c.oc(y,G,0,0));if(u.Na=a.Na,u.animation=a.animation,void 0!==a.L)for(K=0,g=a.L.length;K<g;K++)for(u.L[K]={},u.L[K].name=a.L[K].name,u.L[K].l=[],I=u.L[K].l,y=0,G=(L=a.L[K].l).length;y<G;y+=3)(C=new c.g).x=L[y]*A,C.y=L[y+1]*A,C.z=L[y+2]*A,I.push(C);if(void 0!==a.Yd)for(K=0,g=a.Yd.length;K<g;K++)for(u.Yd[K]={},u.Yd[K].name=a.Yd[K].name,u.Yd[K].Za=[],G=
u.Yd[K].Za,A=0,y=(I=a.Yd[K].Za).length;A<y;A+=3)(L=new c.G(16755200)).rb(I[A],I[A+1],I[A+2]),G.push(L);Uc(u);Fd(u);a=a.oa;e=[];for(f=0;f<a.length;++f)e[f]=te(a[f],d);a=e;a:{d=0;for(e=a.length;d<e;d++)if(a[d]instanceof c.Ra){d=!0;break a}d=!1}d&&u.Nh();b(u,a)}c.ht=function(){function a(){d++;b.dispatchEvent({type:"progress",loaded:d,total:e});d===e&&b.dispatchEvent({type:"load"})}c.Fd.call(this);var b=this,d=0,e=0;this.add=function(f){e++;f.addEventListener("load",a,!1)}};
c.qh=function(){this.Ee={};this.If={};this.Ee.ascii={Lm:c.dj}};c.qh.prototype.constructor=c.qh;c.qh.prototype.load=function(a,b){var d=this,e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status||0===e.status){var f=JSON.parse(e.responseText);d.parse(f,b,a)}else console.error("THREE.SceneLoader: Couldn't load ["+a+"] ["+e.status+"]")};e.open("GET",a,!0);e.send(null)};
c.qh.prototype.parse=function(a,b,d){function e(da,Ba){return"relativeToHTML"==Ba?da:O+"/"+da}function f(){h(I.yd,Z.lb)}function h(da,Ba){var ta,Ia,S,Fa,Ca,Ra,Ja;for(Ja in Ba)if(void 0===I.lb[Ja]){var ca=Ba[Ja],za=null;if(ca.type&&ca.type in Q.If){if(void 0===ca.er){for(var Ka in Ia={type:1,url:1,F:1,position:1,rotation:1,scale:1,visible:1,children:1,ea:1,An:1,yr:1,Xd:1,duration:1},S={},ca)Ka in Ia||(S[Ka]=ca[Ka]);r=I.oa[ca.F];ca.er=!0;(Ia=Q.If[ca.type].pk).options?Ia.load(e(ca.url,Z.Qi),n(Ja,da,
r,ca)):Ia.load(e(ca.url,Z.Qi),n(Ja,da,r,ca),S)}}else if(void 0!==ca.D){if(aa=I.Ta[ca.D]){if(za=!1,za=(r=I.oa[ca.F])instanceof c.Ra,S=ca.position,Fa=ca.rotation,Ca=ca.scale,ta=ca.matrix,Ra=ca.bc,ca.F||(r=new c.Sb(I.Uh[ca.D])),r instanceof c.Sb&&0===r.oa.length&&(r=new c.Sb(I.Uh[ca.D])),r instanceof c.Sb)for(Ia=0;Ia<r.oa.length;Ia++)za=za||r.oa[Ia]instanceof c.Ra;za&&aa.Nh();if(ca.An)za=new c.lc(aa,r);else if(ca.yr){if(za=new c.lh(aa,r),void 0!==ca.duration&&(za.duration=ca.duration),void 0!==ca.time&&
(za.time=ca.time),void 0!==ca.Xd&&(za.Xd=ca.Xd),r.ja){var ha=void 0,wa,Ua,k=aa;var W=0;for(wa=k.s.length;W<wa;W++){(ha=k.s[W]).qj?ha.qj.i(ha.u):ha.qj=ha.u.clone();ha.gg||(ha.gg=[]);var qa=0;for(Ua=ha.M.length;qa<Ua;qa++)ha.gg[qa]?ha.gg[qa].i(ha.M[qa]):ha.gg[qa]=ha.M[qa].clone()}var T=new c.N;T.s=k.s;qa=0;for(Ua=k.L.length;qa<Ua;qa++){if(!k.ja[qa]){k.ja[qa]={};k.ja[qa].Th=[];k.ja[qa].M=[];var La=k.ja[qa].Th,ub=k.ja[qa].M;W=0;for(wa=k.s.length;W<wa;W++){ha=k.s[W];var bb=new c.g;var Ma=ha instanceof
c.aa?{a:new c.g,b:new c.g,c:new c.g}:{a:new c.g,b:new c.g,c:new c.g,d:new c.g};La.push(bb);ub.push(Ma)}}La=k.ja[qa];T.l=k.L[qa].l;Fd(T);T.Sd();W=0;for(wa=k.s.length;W<wa;W++)ha=k.s[W],bb=La.Th[W],Ma=La.M[W],bb.i(ha.u),ha instanceof c.aa?(Ma.a.i(ha.M[0]),Ma.b.i(ha.M[1]),Ma.c.i(ha.M[2])):(Ma.a.i(ha.M[0]),Ma.b.i(ha.M[1]),Ma.c.i(ha.M[2]),Ma.d.i(ha.M[3]))}W=0;for(wa=k.s.length;W<wa;W++)(ha=k.s[W]).u=ha.qj,ha.M=ha.gg}}else za=new c.Y(aa,r);za.name=Ja;ta?(za.$b=!1,za.matrix.set(ta[0],ta[1],ta[2],ta[3],ta[4],
ta[5],ta[6],ta[7],ta[8],ta[9],ta[10],ta[11],ta[12],ta[13],ta[14],ta[15])):(za.position.set(S[0],S[1],S[2]),Ra?(za.bc.set(Ra[0],Ra[1],Ra[2],Ra[3]),za.Mc=!0):za.rotation.set(Fa[0],Fa[1],Fa[2]),za.scale.set(Ca[0],Ca[1],Ca[2]));za.visible=ca.visible;za.qc=ca.qc;za.Nf=ca.Nf;da.add(za);I.lb[Ja]=za}}else"DirectionalLight"===ca.type||"PointLight"===ca.type||"AmbientLight"===ca.type?(A=void 0!==ca.color?ca.color:16777215,y=void 0!==ca.ib?ca.ib:1,"DirectionalLight"===ca.type?(S=ca.direction,(u=new c.zc(A,y)).position.set(S[0],
S[1],S[2]),ca.target&&(fa.push({object:u,Hs:ca.target}),u.target=null)):"PointLight"===ca.type?(S=ca.position,Ia=ca.Bb,(u=new c.mf(A,y,Ia)).position.set(S[0],S[1],S[2])):"AmbientLight"===ca.type&&(u=new c.dh(A)),da.add(u),u.name=Ja,I.Eb[Ja]=u,I.lb[Ja]=u):"PerspectiveCamera"===ca.type||"OrthographicCamera"===ca.type?("PerspectiveCamera"===ca.type?t=new c.kc(ca.Ce,ca.lg,ca.Ka,ca.Oa):"OrthographicCamera"===ca.type&&(t=new c.$f(ca.left,ca.right,ca.top,ca.bottom,ca.Ka,ca.Oa)),S=ca.position,t.position.set(S[0],
S[1],S[2]),da.add(t),t.name=Ja,I.Oj[Ja]=t,I.lb[Ja]=t):(S=ca.position,Fa=ca.rotation,Ca=ca.scale,Ra=ca.bc,(za=new c.H).name=Ja,za.position.set(S[0],S[1],S[2]),Ra?(za.bc.set(Ra[0],Ra[1],Ra[2],Ra[3]),za.Mc=!0):za.rotation.set(Fa[0],Fa[1],Fa[2]),za.scale.set(Ca[0],Ca[1],Ca[2]),za.visible=void 0!==ca.visible&&ca.visible,da.add(za),I.lb[Ja]=za,I.mq[Ja]=za);if(za){if(void 0!==ca.ea)for(var ob in ca.ea)za.ea[ob]=ca.ea[ob];if(void 0!==ca.groups)for(Ia=0;Ia<ca.groups.length;Ia++)S=ca.groups[Ia],void 0===I.groups[S]&&
(I.groups[S]=[]),I.groups[S].push(Ja);void 0!==ca.children&&h(za,ca.children)}}}function g(da){return function(Ba,ta){I.Ta[da]=Ba;I.Uh[da]=ta;f();--C;q()}}function n(da,Ba,ta,Ia){return function(S){S=S.content?S.content:S.hu?S.yd:S;var Fa=Ia.position,Ca=Ia.rotation,Ra=Ia.bc,Ja=Ia.scale;S.position.set(Fa[0],Fa[1],Fa[2]);Ra?(S.bc.set(Ra[0],Ra[1],Ra[2],Ra[3]),S.Mc=!0):S.rotation.set(Ca[0],Ca[1],Ca[2]);S.scale.set(Ja[0],Ja[1],Ja[2]);ta&&Yb(S,function(za){za.F=ta});var ca=void 0===Ia.visible||Ia.visible;
Yb(S,function(za){za.visible=ca});Ba.add(S);S.name=da;I.lb[da]=S;f();--C;q()}}function m(da){return function(Ba,ta){I.Ta[da]=Ba;I.Uh[da]=ta}}function q(){if(0===C&&0===G){for(var da=0;da<fa.length;da++){var Ba=fa[da],ta=I.lb[Ba.Hs];ta?Ba.object.target=ta:(Ba.object.target=new c.H,I.yd.add(Ba.object.target));Ba.object.target.ea.Nn=Ba.object}b(I)}}var r,t,p,w,u,A,y,C,G,I,L,K,Q=this,O=se(d),fa=[],Z=a;for(L in this.Ee)a=this.Ee[L].Lm,this.Ee[L].pk=new a;for(L in this.If)a=this.If[L].Lm,this.If[L].pk=
new a;for(var Ga in G=C=0,I={yd:new c.cg,Ta:{},Uh:{},oa:{},Ib:{},lb:{},Oj:{},Eb:{},xg:{},mq:{},groups:{}},Z.transform&&(L=Z.transform.position,a=Z.transform.rotation,d=Z.transform.scale,L&&I.yd.position.set(L[0],L[1],L[2]),a&&I.yd.rotation.set(a[0],a[1],a[2]),d&&I.yd.scale.set(d[0],d[1],d[2]),L||a||d)&&(I.yd.ed(),I.yd.Jb()),L=function(da){return function(){G-=da;q()}},Z.xg)"linear"===(a=Z.xg[Ga]).type?p=new c.Xf(0,a.Ka,a.Oa):"exp2"===a.type&&(p=new c.ff(0,a.Rh)),a=a.color,p.color.rb(a[0],a[1],a[2]),
I.xg[Ga]=p;for(var R in Z.Ta)(p=Z.Ta[R]).type in this.Ee&&(C+=1);for(var V in Z.lb)(p=Z.lb[V]).type&&p.type in this.If&&(C+=1);for(R in Z.Ta)if("cube"===(p=Z.Ta[R]).type){var aa=new c.$k(p.width,p.height,p.depth,p.gd,p.Zc,p.Wj);I.Ta[R]=aa}else if("plane"===p.type)aa=new c.ql(p.width,p.height,p.gd,p.Zc),I.Ta[R]=aa;else if("sphere"===p.type)aa=new c.ld(p.P,p.gd,p.Zc),I.Ta[R]=aa;else if("cylinder"===p.type)aa=new c.hh(p.my,p.It,p.height,p.qx,p.kv),I.Ta[R]=aa;else if("torus"===p.type)aa=new c.Hl(p.P,
p.af,p.Kx,p.Lx),I.Ta[R]=aa;else if("icosahedron"===p.type)aa=new c.Zi(p.P,p.by),I.Ta[R]=aa;else if(p.type in this.Ee){for(w in V={},p)"type"!==w&&"url"!==w&&(V[w]=p[w]);this.Ee[p.type].pk.load(e(p.url,Z.Qi),g(R),V)}else"embedded"===p.type&&((V=Z.embeds[p.id]).vr=Z.vr,V&&ve(V,m(R),""));for(var U in Z.Ib)if((R=Z.Ib[U]).url instanceof Array)for(G+=R.url.length,w=0;w<R.url.length;w++);else G+=1;for(U in Z.Ib){if(void 0!==(R=Z.Ib[U]).mapping&&void 0!==c[R.mapping]&&(R.mapping=new c[R.mapping]),R.url instanceof
Array){V=R.url.length;p=[];for(w=0;w<V;w++)p[w]=e(R.url[w],Z.Qi);w=(w=/\.dds$/i.test(p[0]))?c.Gd.br(p,R.mapping,L(V)):c.Gd.dr(p,R.mapping,L(V))}else w=/\.dds$/i.test(R.url),V=e(R.url,Z.Qi),p=L(1),w=w?c.Gd.Jm(V,R.mapping,p):c.Gd.cr(V,R.mapping,p),void 0!==c[R.kb]&&(w.kb=c[R.kb]),void 0!==c[R.Fb]&&(w.Fb=c[R.Fb]),R.Mb&&(w.Mb=R.Mb),R.repeat&&(w.repeat.set(R.repeat[0],R.repeat[1]),1!==R.repeat[0]&&(w.ec=c.kd),1!==R.repeat[1]&&(w.fc=c.kd)),R.offset&&w.offset.set(R.offset[0],R.offset[1]),R.Ti&&(void 0!==
(V={repeat:c.kd,wr:c.hj})[R.Ti[0]]&&(w.ec=V[R.Ti[0]]),void 0!==V[R.Ti[1]]&&(w.fc=V[R.Ti[1]]));I.Ib[U]=w}for(K in Z.oa){for(ba in(U=Z.oa[K]).parameters)"envMap"===ba||"map"===ba||"lightMap"===ba||"bumpMap"===ba?U.parameters[ba]=I.Ib[U.parameters[ba]]:"shading"===ba?U.parameters[ba]="flat"===U.parameters[ba]?c.ef:c.mc:"side"===ba?U.parameters[ba]="double"==U.parameters[ba]?c.Ed:"back"==U.parameters[ba]?c.df:c.ih:"blending"===ba?U.parameters[ba]=U.parameters[ba]in c?c[U.parameters[ba]]:c.nh:"combine"===
ba?U.parameters[ba]=U.parameters[ba]in c?c[U.parameters[ba]]:c.mh:"vertexColors"===ba?"face"==U.parameters[ba]?U.parameters[ba]=c.ne:U.parameters[ba]&&(U.parameters[ba]=c.eg):"wrapRGB"===ba&&(L=U.parameters[ba],U.parameters[ba]=new c.g(L[0],L[1],L[2]));void 0!==U.parameters.opacity&&1>U.parameters.opacity&&(U.parameters.Ba=!0);U.parameters.ab?(L=c.dg.si,R=c.nc.clone(L.V),w=U.parameters.color,V=U.parameters.bd,p=U.parameters.ya,Ga=U.parameters.fe,R.In.value=I.Ib[U.parameters.ab],U.parameters.Zd&&R.Tn.value.set(U.parameters.Zd[0],
U.parameters.Zd[1]),U.parameters.map&&(R.Hn.value=U.parameters.map,R.mm.value=!0),U.parameters.ma&&(R.Gn.value=U.parameters.ma,R.oq.value=!0,R.Ps.value=U.parameters.tc),U.parameters.Ja&&(R.Fn.value=U.parameters.Ja,R.lm.value=!0),U.parameters.Fa&&(R.Jn.value=I.Ib[U.parameters.Fa],R.nm.value=!0),U.parameters.jq&&(R.Gs.value=I.Ib[U.parameters.jq],R.nq.value=!0,R.Ns.value=U.parameters.Gu,R.Os.value=U.parameters.Hu),R.Sn.value.uc(w),R.Wn.value.uc(V),R.Rn.value.uc(p),R.Vn.value=Ga,U.parameters.opacity&&
(R.Un.value=U.parameters.opacity),r=new c.Ra({S:L.S,T:L.T,V:R,Eb:!0,J:!0})):r=new c[U.type](U.parameters);I.oa[K]=r}for(K in Z.oa)if((U=Z.oa[K]).parameters.oa){var ba=[];for(w=0;w<U.parameters.oa.length;w++)ba.push(I.oa[U.parameters.oa[w]]);I.oa[K].oa=ba}f();I.Oj&&Z.Tj.Nj&&(I.fu=I.Oj[Z.Tj.Nj]);I.xg&&Z.Tj.J&&(I.yd.J=I.xg[Z.Tj.J]);q()};c.Gl=function(){c.Fd.call(this);this.crossOrigin=null};
c.Gl.prototype={constructor:c.Gl,load:function(a){var b=this,d=new Image;d.addEventListener("load",function(){var e=new c.wb(d);e.ia=!0;b.dispatchEvent({type:"load",content:e})},!1);d.addEventListener("error",function(){b.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},!1);b.crossOrigin&&(d.crossOrigin=b.crossOrigin);d.src=a}};
c.X=function(){c.Fd.call(this);this.id=c.Eo++;this.name="";this.Ad=c.ih;this.opacity=1;this.Ba=!1;this.qb=c.nh;this.ze=c.El;this.ye=c.nl;this.blendEquation=c.Xk;this.td=this.rc=!0;this.polygonOffset=!1;this.pd=this.Lg=this.Kg=0;this.wi=!1;this.ia=this.visible=!0};
function we(a,b){if(void 0!==b)for(var d in b){var e=b[d];if(void 0===e)console.warn("THREE.Material: '"+d+"' parameter is undefined.");else if(d in a){var f=a[d];f instanceof c.G&&e instanceof c.G?f.i(e):f instanceof c.G?f.set(e):f instanceof c.g&&e instanceof c.g?f.i(e):a[d]=e}}}
c.X.prototype.clone=function(a){return void 0===a&&(a=new c.X),a.name=this.name,a.Ad=this.Ad,a.opacity=this.opacity,a.Ba=this.Ba,a.qb=this.qb,a.ze=this.ze,a.ye=this.ye,a.blendEquation=this.blendEquation,a.rc=this.rc,a.td=this.td,a.polygonOffset=this.polygonOffset,a.Kg=this.Kg,a.Lg=this.Lg,a.pd=this.pd,a.wi=this.wi,a.visible=this.visible,a};c.Eo=0;c.Kb=function(a){c.X.call(this);this.color=new c.G(16777215);this.Hc=1;this.mi=this.li="round";this.C=!1;this.J=!0;we(this,a)};c.Kb.prototype=Object.create(c.X.prototype);
c.Kb.prototype.clone=function(){var a=new c.Kb;return c.X.prototype.clone.call(this,a),a.color.i(this.color),a.Hc=this.Hc,a.li=this.li,a.mi=this.mi,a.C=this.C,a.J=this.J,a};c.Id=function(a){c.X.call(this);this.color=new c.G(16777215);this.scale=this.Hc=1;this.sd=3;this.Ff=1;this.C=!1;this.J=!0;we(this,a)};c.Id.prototype=Object.create(c.X.prototype);
c.Id.prototype.clone=function(){var a=new c.Id;return c.X.prototype.clone.call(this,a),a.color.i(this.color),a.Hc=this.Hc,a.scale=this.scale,a.sd=this.sd,a.Ff=this.Ff,a.C=this.C,a.J=this.J,a};c.Qa=function(a){c.X.call(this);this.color=new c.G(16777215);this.ma=this.Fa=this.Ja=this.map=null;this.Cc=c.mh;this.tc=1;this.Lc=.98;this.J=!0;this.ua=c.mc;this.U=!1;this.pa=1;this.ub=this.tb="round";this.C=c.Zf;this.L=this.Aa=!1;we(this,a)};c.Qa.prototype=Object.create(c.X.prototype);
c.Qa.prototype.clone=function(){var a=new c.Qa;return c.X.prototype.clone.call(this,a),a.color.i(this.color),a.map=this.map,a.Ja=this.Ja,a.Fa=this.Fa,a.ma=this.ma,a.Cc=this.Cc,a.tc=this.tc,a.Lc=this.Lc,a.J=this.J,a.ua=this.ua,a.U=this.U,a.pa=this.pa,a.tb=this.tb,a.ub=this.ub,a.C=this.C,a.Aa=this.Aa,a.L=this.L,a};
c.Ac=function(){c.X.call(this);this.color=new c.G(16777215);this.ya=new c.G(16777215);this.fb=new c.G(0);this.Oc=!1;this.xc=new c.g(1,1,1);this.ma=this.Fa=this.Ja=this.map=null;this.Cc=c.mh;this.tc=1;this.Lc=.98;this.J=!0;this.ua=c.mc;this.U=!1;this.pa=1;this.ub=this.tb="round";this.C=c.Zf;this.ja=this.L=this.Aa=!1;we(this)};c.Ac.prototype=Object.create(c.X.prototype);
c.Ac.prototype.clone=function(){var a=new c.Ac;return c.X.prototype.clone.call(this,a),a.color.i(this.color),a.ya.i(this.ya),a.fb.i(this.fb),a.Oc=this.Oc,a.xc.i(this.xc),a.map=this.map,a.Ja=this.Ja,a.Fa=this.Fa,a.ma=this.ma,a.Cc=this.Cc,a.tc=this.tc,a.Lc=this.Lc,a.J=this.J,a.ua=this.ua,a.U=this.U,a.pa=this.pa,a.tb=this.tb,a.ub=this.ub,a.C=this.C,a.Aa=this.Aa,a.L=this.L,a.ja=this.ja,a};
c.jc=function(){c.X.call(this);this.color=new c.G(16777215);this.ya=new c.G(16777215);this.fb=new c.G(0);this.bd=new c.G(1118481);this.fe=30;this.Ig=!1;this.Lf=!0;this.Oc=!1;this.xc=new c.g(1,1,1);this.zb=this.Ja=this.map=null;this.yf=1;this.ab=null;this.Zd=new c.o(1,1);this.ma=this.Fa=null;this.Cc=c.mh;this.tc=1;this.Lc=.98;this.J=!0;this.ua=c.mc;this.U=!1;this.pa=1;this.ub=this.tb="round";this.C=c.Zf;this.ja=this.L=this.Aa=!1;we(this)};c.jc.prototype=Object.create(c.X.prototype);
c.jc.prototype.clone=function(){var a=new c.jc;return c.X.prototype.clone.call(this,a),a.color.i(this.color),a.ya.i(this.ya),a.fb.i(this.fb),a.bd.i(this.bd),a.fe=this.fe,a.Ig=this.Ig,a.Lf=this.Lf,a.Oc=this.Oc,a.xc.i(this.xc),a.map=this.map,a.Ja=this.Ja,a.zb=this.zb,a.yf=this.yf,a.ab=this.ab,a.Zd.i(this.Zd),a.Fa=this.Fa,a.ma=this.ma,a.Cc=this.Cc,a.tc=this.tc,a.Lc=this.Lc,a.J=this.J,a.ua=this.ua,a.U=this.U,a.pa=this.pa,a.tb=this.tb,a.ub=this.ub,a.C=this.C,a.Aa=this.Aa,a.L=this.L,a.ja=this.ja,a};
c.pe=function(a){c.X.call(this);this.U=!1;this.pa=1;we(this,a)};c.pe.prototype=Object.create(c.X.prototype);c.pe.prototype.clone=function(){var a=new c.Kb;return c.X.prototype.clone.call(this,a),a.U=this.U,a.pa=this.pa,a};c.qe=function(){c.X.call(this,void 0);this.ua=c.ef;this.U=!1;this.pa=1;we(this)};c.qe.prototype=Object.create(c.X.prototype);c.qe.prototype.clone=function(){var a=new c.qe;return c.X.prototype.clone.call(this,a),a.ua=this.ua,a.U=this.U,a.pa=this.pa,a};
c.Sb=function(a){this.oa=a instanceof Array?a:[]};c.Sb.prototype.clone=function(){return new c.Sb(this.oa.slice(0))};c.re=function(a){c.X.call(this);this.color=new c.G(16777215);this.map=null;this.size=1;this.Hb=!0;this.C=!1;this.J=!0;we(this,a)};c.re.prototype=Object.create(c.X.prototype);c.re.prototype.clone=function(){var a=new c.re;return c.X.prototype.clone.call(this,a),a.color.i(this.color),a.map=this.map,a.size=this.size,a.Hb=this.Hb,a.C=this.C,a.J=this.J,a};
c.ag=function(a){c.X.call(this);this.color=new c.G(16777215);this.mb=function(){};we(this,a)};c.ag.prototype=Object.create(c.X.prototype);c.ag.prototype.clone=function(){var a=new c.ag;return c.X.prototype.clone.call(this,a),a.color.i(this.color),a.mb=this.mb,a};c.Ra=function(a){c.X.call(this);this.T=this.S="void main() {}";this.V={};this.Uj={};this.attributes=null;this.ua=c.mc;this.U=!1;this.pa=1;this.Eb=this.J=!1;this.C=c.Zf;this.ja=this.L=this.Aa=!1;we(this,a)};c.Ra.prototype=Object.create(c.X.prototype);
c.Ra.prototype.clone=function(){var a=new c.Ra;return c.X.prototype.clone.call(this,a),a.S=this.S,a.T=this.T,a.V=c.nc.clone(this.V),a.attributes=this.attributes,a.Uj=this.Uj,a.ua=this.ua,a.U=this.U,a.pa=this.pa,a.J=this.J,a.Eb=this.Eb,a.C=this.C,a.Aa=this.Aa,a.L=this.L,a.ja=this.ja,a};
c.rh=function(){var a;c.X.call(this);this.color=new c.G(16777215);this.map=new c.wb;this.Nc=!0;this.rc=!this.Nc;this.Hb=!this.Nc;this.Ng=!this.Hb;this.tf=c.Pc.ha.clone();this.J=!1;this.Rf=new c.o(0,0);this.Sf=new c.o(1,1);we(this,a);void 0===(a=a||{}).rc&&(this.rc=!this.Nc);void 0===a.Hb&&(this.Hb=!this.Nc);void 0===a.Ng&&(this.Ng=!this.Hb)};c.rh.prototype=Object.create(c.X.prototype);
c.rh.prototype.clone=function(){var a=new c.rh;return c.X.prototype.clone.call(this,a),a.color.i(this.color),a.map=this.map,a.Nc=this.Nc,a.Hb=this.Hb,a.Ng=this.Ng,a.tf.i(this.tf),a.Rf.i(this.Rf),a.Sf.i(this.Sf),a.J=this.J,a};c.Pc={};c.Pc.ly=new c.o(1,-1);c.Pc.ky=new c.o(0,-1);c.Pc.ny=new c.o(-1,-1);c.Pc.Pt=new c.o(1,0);c.Pc.ha=new c.o(0,0);c.Pc.Qt=new c.o(-1,0);c.Pc.Kt=new c.o(1,1);c.Pc.Jt=new c.o(0,1);c.Pc.Lt=new c.o(-1,1);
c.wb=function(a,b,d,e,f,h,g,n,m){c.Fd.call(this);this.id=c.Zo++;this.name="";this.image=a;this.Gb=[];this.mapping=void 0!==b?b:new c.Il;this.ec=void 0!==d?d:c.Vf;this.fc=void 0!==e?e:c.Vf;this.Fb=void 0!==f?f:c.oe;this.kb=void 0!==h?h:c.fj;this.Mb=void 0!==m?m:1;this.format=void 0!==g?g:c.bg;this.type=void 0!==n?n:c.pj;this.offset=new c.o(0,0);this.repeat=new c.o(1,1);this.Ob=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.Uk=4;this.ia=!1;this.ti=null};
c.wb.prototype={constructor:c.wb,clone:function(a){return void 0===a&&(a=new c.wb),a.image=this.image,a.Gb=this.Gb.slice(0),a.mapping=this.mapping,a.ec=this.ec,a.fc=this.fc,a.Fb=this.Fb,a.kb=this.kb,a.Mb=this.Mb,a.format=this.format,a.type=this.type,a.offset.i(this.offset),a.repeat.i(this.repeat),a.Ob=this.Ob,a.premultiplyAlpha=this.premultiplyAlpha,a.flipY=this.flipY,a.Uk=this.Uk,a}};c.Zo=0;
c.le=function(){c.wb.call(this,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0);this.image={width:void 0,height:void 0};this.Gb=void 0;this.Ob=!1};c.le.prototype=Object.create(c.wb.prototype);c.le.prototype.clone=function(){var a=new c.le;return c.wb.prototype.clone.call(this,a),a};c.me=function(a,b,d,e,f){c.wb.call(this,null,void 0,void 0,void 0,void 0,void 0,e,f,void 0);this.image={data:a,width:b,height:d}};c.me.prototype=Object.create(c.wb.prototype);
c.me.prototype.clone=function(){var a=new c.me;return c.wb.prototype.clone.call(this,a),a};c.lf=function(a){c.H.call(this);this.F=a};c.lf.prototype=Object.create(c.H.prototype);c.lf.prototype.clone=function(a){return void 0===a&&(a=new c.lf(this.F)),c.H.prototype.clone.call(this,a),a};c.Tb=function(a,b){c.H.call(this);this.D=a;this.F=void 0!==b?b:new c.re({color:16777215*Math.random()});this.Ze=!1;this.D&&null===this.D.yb&&this.D.Mh();this.De=!1};c.Tb.prototype=Object.create(c.H.prototype);
c.Tb.prototype.clone=function(a){return void 0===a&&(a=new c.Tb(this.D,this.F)),a.Ze=this.Ze,c.H.prototype.clone.call(this,a),a};c.Ga=function(a,b,d){c.H.call(this);this.D=a;this.F=void 0!==b?b:new c.Kb({color:16777215*Math.random()});this.type=void 0!==d?d:c.il;this.D&&(this.D.yb||this.D.Mh())};c.il=0;c.jf=1;c.Ga.prototype=Object.create(c.H.prototype);c.Ga.prototype.clone=function(a){return void 0===a&&(a=new c.Ga(this.D,this.F,this.type)),c.H.prototype.clone.call(this,a),a};
c.Y=function(a,b){c.H.call(this);this.D=a;this.F=void 0!==b?b:new c.Qa({color:16777215*Math.random(),U:!0});if(void 0!==this.D&&(null===this.D.yb&&this.D.Mh(),0<this.D.L.length))for(this.uk=-1,this.Xm=[],this.Ic=[],this.zr={},a=0,b=this.D.L.length;a<b;a++)this.Ic.push(0),this.zr[this.D.L[a].name]=a};c.Y.prototype=Object.create(c.H.prototype);c.Y.prototype.clone=function(a){return void 0===a&&(a=new c.Y(this.D,this.F)),c.H.prototype.clone.call(this,a),a};
c.yc=function(a){c.H.call(this);this.An=a;this.vc=new c.da};c.yc.prototype=Object.create(c.H.prototype);c.yc.prototype.update=function(a,b){this.$b&&(b|=this.ed());(b||this.$a)&&(a?this.vc.Ea(a,this.matrix):this.vc.i(this.matrix),this.$a=!1,b=!0);var d=this.children.length;for(a=0;a<d;a++)this.children[a].update(this.vc,b)};
c.lc=function(a,b,d){if(c.Y.call(this,a,b),this.Cd=void 0===d||d,this.Nq=new c.da,this.Na=[],this.mg=[],this.D&&void 0!==this.D.Na){for(a=0;a<this.D.Na.length;a++){var e=(d=this.D.Na[a]).Mf;var f=d.Dx;var h=d.Ci;var g=void 0;(b=(void 0===g&&(g=new c.yc(this)),this.Na.push(g),g)).name=d.name;b.position.set(e[0],e[1],e[2]);b.bc.set(f[0],f[1],f[2],f[3]);b.Mc=!0;void 0!==h?b.scale.set(h[0],h[1],h[2]):b.scale.set(1,1,1)}for(a=0;a<this.Na.length;a++)d=this.D.Na[a],b=this.Na[a],-1===d.parent?this.add(b):
this.Na[d.parent].add(b);a=this.Na.length;this.Cd?(this.wf=this.xf=256<a?64:64<a?32:16<a?16:8,this.mg=new Float32Array(4*this.xf*this.wf),this.Qd=new c.me(this.mg,this.xf,this.wf,c.bg,c.Xi),this.Qd.kb=c.kf,this.Qd.Fb=c.kf,this.Qd.Ob=!1,this.Qd.flipY=!1):this.mg=new Float32Array(16*a);this.Jb(!0);for(a=0;a<this.D.ge.length;a++)b=this.D.he[a],d=1/b.Fm(),1/0!==d?b.A(d):b.set(1)}};c.lc.prototype=Object.create(c.Y.prototype);
c.lc.prototype.Jb=function(a){this.$b&&this.ed();(this.$a||a)&&(this.parent?this.K.Ea(this.parent.K,this.matrix):this.K.i(this.matrix),this.$a=!1);a=0;for(var b=this.children.length;a<b;a++){var d=this.children[a];d instanceof c.yc?d.update(this.Nq,!1):d.Jb(!0)}if(null==this.Kj)for(this.Kj=[],a=0,b=this.Na.length;a<b;a++)(d=new c.da).gb(this.Na[a].vc),this.Kj.push(d);a=0;for(b=this.Na.length;a<b;a++)c.lc.an.Ea(this.Na[a].vc,this.Kj[a]),c.lc.an.pm(this.mg,16*a);this.Cd&&(this.Qd.ia=!0)};
c.lc.prototype.clone=function(a){return void 0===a&&(a=new c.lc(this.D,this.F,this.Cd)),c.Y.prototype.clone.call(this,a),a};c.lc.an=new c.da;c.lh=function(a,b){c.Y.call(this,a,b);this.duration=1E3;this.Xd=!1;this.fm=this.Em=this.time=0;this.direction=1;this.Bf=!1;a=this.D.L.length-1;this.Es=0;this.pq=a;this.length=this.pq-this.Es+1};c.lh.prototype=Object.create(c.Y.prototype);
c.lh.prototype.clone=function(a){return void 0===a&&(a=new c.lh(this.D,this.F)),a.duration=this.duration,a.Xd=this.Xd,a.time=this.time,a.Em=this.Em,a.fm=this.fm,a.direction=this.direction,a.Bf=this.Bf,c.Y.prototype.clone.call(this,a),a};c.Jd=function(a,b){c.H.call(this);this.D=a;this.F=b};c.Jd.prototype=Object.create(c.H.prototype);c.Jd.prototype.clone=function(a){return void 0===a&&(a=new c.Jd(this.D,this.F)),c.H.prototype.clone.call(this,a),a};c.ej=function(){c.H.call(this);this.Hd=[]};
c.ej.prototype=Object.create(c.H.prototype);c.ej.prototype.update=function(a){if(1<this.Hd.length){a.Ua.gb(a.K);a=-((a=a.Ua).elements[2]*this.K.elements[12]+a.elements[6]*this.K.elements[13]+a.elements[10]*this.K.elements[14]+a.elements[14]);this.Hd[0].yk.visible=!0;for(var b=1;b<this.Hd.length&&a>=this.Hd[b].zy;b++)this.Hd[b-1].yk.visible=!1,this.Hd[b].yk.visible=!0;for(;b<this.Hd.length;b++)this.Hd[b].yk.visible=!1}};c.ej.prototype.clone=function(){};
c.te=function(a){c.H.call(this);this.F=void 0!==a?a:new c.rh;this.mn=this.rotation;this.rotation=0};c.te.prototype=Object.create(c.H.prototype);c.te.prototype.ed=function(){this.matrix.setPosition(this.position);this.mn.set(0,0,this.rotation);this.matrix.tn(this.mn);1===this.scale.x&&1===this.scale.y||this.matrix.scale(this.scale);this.$a=!0};c.te.prototype.clone=function(a){return void 0===a&&(a=new c.te(this.F)),c.H.prototype.clone.call(this,a),a};
c.cg=function(){c.H.call(this);this.bn=this.J=null;this.$b=!1;this.uh=[];this.Wb=[];this.pf=[];this.qf=[]};c.cg.prototype=Object.create(c.H.prototype);function lc(a,b){if(b instanceof c.ob)-1===a.Wb.indexOf(b)&&a.Wb.push(b),b.target&&void 0===b.target.parent&&a.add(b.target);else if(!(b instanceof c.Rb||b instanceof c.yc)&&-1===a.uh.indexOf(b)){a.uh.push(b);a.pf.push(b);var d=a.qf.indexOf(b);-1!==d&&a.qf.splice(d,1)}for(d=0;d<b.children.length;d++)lc(a,b.children[d])}
function tc(a,b){if(b instanceof c.ob){var d=a.Wb.indexOf(b);-1!==d&&a.Wb.splice(d,1)}else b instanceof c.Rb||-1!==(d=a.uh.indexOf(b))&&(a.uh.splice(d,1),a.qf.push(b),-1!==(d=a.pf.indexOf(b))&&a.pf.splice(d,1));for(d=0;d<b.children.length;d++)tc(a,b.children[d])}c.Xf=function(a,b,d){this.name="";this.color=new c.G(a);this.Ka=void 0!==b?b:1;this.Oa=void 0!==d?d:1E3};c.Xf.prototype.clone=function(){return new c.Xf(this.color.Xc(),this.Ka,this.Oa)};
c.ff=function(a,b){this.name="";this.color=new c.G(a);this.Rh=void 0!==b?b:2.5E-4};c.ff.prototype.clone=function(){return new c.ff(this.color.Xc(),this.Rh)};
c.mo=function(){var a;function b(Pa){La!==Pa&&(La=T.globalAlpha=Pa)}function d(Pa){ub!==Pa&&(Pa===c.nh?T.globalCompositeOperation="source-over":Pa===c.Yk?T.globalCompositeOperation="lighter":Pa===c.Fl&&(T.globalCompositeOperation="darker"),ub=Pa)}function e(Pa){ob!==Pa&&(ob=T.lineWidth=Pa)}function f(Pa){pb!==Pa&&(pb=T.lineCap=Pa)}function h(Pa){Xb!==Pa&&(Xb=T.lineJoin=Pa)}function g(Pa){bb!==Pa&&(bb=T.strokeStyle=Pa)}function n(Pa){Ma!==Pa&&(Ma=T.fillStyle=Pa)}function m(Pa,Ob){Tb===Pa&&Nb===Ob||
(T.setLineDash([Pa,Ob]),Tb=Pa,Nb=Ob)}console.log("THREE.CanvasRenderer",c.tl);var q,r,t,p,w,u,A,y,C,G,I,L,K,Q,O,fa,Z,Ga,R,V,aa,U,ba,da,Ba,ta,Ia,S,Fa,Ca,Ra,Ja,ca,za,Ka,ha,wa,Ua=c.Math.ts,k=(a=a||{},this),W=new c.ij,qa=void 0!==a.canvas?a.canvas:document.createElement("canvas"),T=qa.getContext("2d");new c.G(0);var La=1,ub=0,bb=null,Ma=null,ob=null,pb=null,Xb=null,Tb=null,Nb=0,kc=new c.Vb,Vc=new c.Vb,Sa=new c.G,qb=new c.G,fb=new c.G,eb=new c.G,xb=new c.G,Mb=new c.G,Ya=new c.G,sd=new c.G,ed={},fd={},
yc=new c.Tf,Zb=new c.Tf,Fb=new c.Tf,td=!1,Ub=new c.G,ud=new c.G,gd=new c.G,$b=new c.g,gb=16;(za=document.createElement("canvas")).width=za.height=2;(Ka=za.getContext("2d")).fillStyle="rgba(0,0,0,1)";Ka.fillRect(0,0,2,2);var sb=Ka.getImageData(0,0,2,2);var Qb=sb.data;(ha=document.createElement("canvas")).width=ha.height=gb;(wa=ha.getContext("2d")).translate(-gb/2,-gb/2);wa.scale(gb,gb);gb--;void 0===T.setLineDash&&(T.setLineDash=void 0!==T.Br?function(Pa){T.Br=null!==Pa[0]?Pa:null}:function(){});this.km=
qa;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.us=this.Oi=this.Ej=!0;this.info={I:{l:0,s:0}};this.Gi=function(Pa,Ob){p=Pa*this.devicePixelRatio;w=Ob*this.devicePixelRatio;u=Math.floor(p/2);A=Math.floor(w/2);qa.width=p;qa.height=w;qa.style.width=Pa+"px";qa.style.height=Ob+"px";yc.set(new c.o(-u,-A),new c.o(u,A));Zb.set(new c.o(-u,-A),new c.o(u,A));La=1;ub=0;Xb=pb=ob=Ma=bb=null};this.clear=function(){T.setTransform(1,
0,0,-1,u,A);!1===Zb.empty()&&(Zb.Cm(yc),Zb.Cf(2),T.clearRect(0|Zb.min.x,0|Zb.min.y,Zb.max.x-Zb.min.x|0,Zb.max.y-Zb.min.y|0),Zb.Jf())};this.I=function(Pa,Ob){function ac(na,X,ra){for(var ja=0,ua=t.length;ja<ua;ja++){var va=t[ja];if(sd.i(va.color),va instanceof c.zc){var Ha=$b.hb(va.K).normalize(),sa=X.ba(Ha);0>=sa||(sa*=va.ib,ra.add(sd.A(sa)))}else va instanceof c.mf&&(Ha=$b.hb(va.K),0>=(sa=X.ba($b.O(Ha,na).normalize()))||0!=(sa*=0==va.Bb?1:1-Math.min(na.Td(Ha)/va.Bb,1))&&(sa*=va.ib,ra.add(sd.A(sa))))}}
function vd(na,X,ra,ja,ua,va,Ha,sa){k.info.I.l+=3;k.info.I.s++;b(sa.opacity);d(sa.qb);L=na.j.x;K=na.j.y;Q=X.j.x;O=X.j.y;fa=ra.j.x;Z=ra.j.y;Wc(L,K,Q,O,fa,Z);(sa instanceof c.Ac||sa instanceof c.jc)&&null===sa.map?(Mb.i(sa.color),Ya.i(sa.fb),sa.C===c.ne&&Mb.multiply(Ha.color),!0===td?!1===sa.U&&sa.ua==c.mc&&3==Ha.Ri?(qb.i(Ub),fb.i(Ub),eb.i(Ub),ac(Ha.$.Jc,Ha.Dd[0],qb),ac(Ha.ca.Jc,Ha.Dd[1],fb),ac(Ha.sb.Jc,Ha.Dd[2],eb),qb.multiply(Mb).add(Ya),fb.multiply(Mb).add(Ya),eb.multiply(Mb).add(Ya),xb.Fh(fb,eb).A(.5),
ta=v(qb,fb,eb,xb),z(L,K,Q,O,fa,Z,0,0,1,0,0,1,ta)):(Sa.i(Ub),ac(Ha.og,Ha.Me,Sa),Sa.multiply(Mb).add(Ya),!0===sa.U?uc(Sa,sa.pa,sa.tb,sa.ub):mc(Sa)):!0===sa.U?uc(sa.color,sa.pa,sa.tb,sa.ub):mc(sa.color)):sa instanceof c.Qa||sa instanceof c.Ac||sa instanceof c.jc?null!==sa.map?sa.map.mapping instanceof c.Il&&(Ia=Ha.bf[0],l(L,K,Q,O,fa,Z,Ia[ja].x,Ia[ja].y,Ia[ua].x,Ia[ua].y,Ia[va].x,Ia[va].y,sa.map)):null!==sa.ma?sa.ma.mapping instanceof c.So&&($b.i(Ha.wc[ja]),S=.5*$b.x+.5,Fa=.5*$b.y+.5,$b.i(Ha.wc[ua]),
Ca=.5*$b.x+.5,Ra=.5*$b.y+.5,$b.i(Ha.wc[va]),Ja=.5*$b.x+.5,ca=.5*$b.y+.5,l(L,K,Q,O,fa,Z,S,Fa,Ca,Ra,Ja,ca,sa.ma)):(Sa.i(sa.color),sa.C===c.ne&&Sa.multiply(Ha.color),!0===sa.U?uc(Sa,sa.pa,sa.tb,sa.ub):mc(Sa)):sa instanceof c.pe?(da=Ob.Ka,Ba=Ob.Oa,qb.r=qb.v=qb.b=1-Ua(na.j.z*na.j.w,da,Ba),fb.r=fb.v=fb.b=1-Ua(X.j.z*X.j.w,da,Ba),eb.r=eb.v=eb.b=1-Ua(ra.j.z*ra.j.w,da,Ba),xb.Fh(fb,eb).A(.5),ta=v(qb,fb,eb,xb),z(L,K,Q,O,fa,Z,0,0,1,0,0,1,ta)):sa instanceof c.qe&&(sa.ua==c.ef?(na=Ha.ri,Sa.rb(na.x,na.y,na.z).A(.5).pb(.5),
!0===sa.U?uc(Sa,sa.pa,sa.tb,sa.ub):mc(Sa)):sa.ua==c.mc&&(na=Ha.wc[ja],qb.rb(na.x,na.y,na.z).A(.5).pb(.5),na=Ha.wc[ua],fb.rb(na.x,na.y,na.z).A(.5).pb(.5),na=Ha.wc[va],eb.rb(na.x,na.y,na.z).A(.5).pb(.5),xb.Fh(fb,eb).A(.5),ta=v(qb,fb,eb,xb),z(L,K,Q,O,fa,Z,0,0,1,0,0,1,ta)))}function Wc(na,X,ra,ja,ua,va){T.beginPath();T.moveTo(na,X);T.lineTo(ra,ja);T.lineTo(ua,va);T.closePath()}function wd(na,X,ra,ja,ua,va,Ha,sa){T.beginPath();T.moveTo(na,X);T.lineTo(ra,ja);T.lineTo(ua,va);T.lineTo(Ha,sa);T.closePath()}
function uc(na,X,ra,ja){e(X);f(ra);h(ja);g(na.Fe());T.stroke();Fb.Cf(2*X)}function mc(na){n(na.Fe());T.fill()}function l(na,X,ra,ja,ua,va,Ha,sa,Kb,Vb,Rb,hc,Ta){if(!(Ta instanceof c.me||void 0===Ta.image||0==Ta.image.width)){if(!0===Ta.ia){var rb=Ta.ec==c.kd,yb=Ta.fc==c.kd;ed[Ta.id]=T.createPattern(Ta.image,!0===rb&&!0===yb?"repeat":!0===rb&&!1===yb?"repeat-x":!1===rb&&!0===yb?"repeat-y":"no-repeat");Ta.ia=!1}void 0===ed[Ta.id]?n("rgba(0,0,0,1)"):n(ed[Ta.id]);rb=Ta.offset.x/Ta.repeat.x;yb=Ta.offset.y/
Ta.repeat.y;var zc=Ta.image.width*Ta.repeat.x,ic=Ta.image.height*Ta.repeat.y;ra-=na;ja-=X;ua-=na;va-=X;0===(rb=(Kb=(Kb+rb)*zc-(Ha=(Ha+rb)*zc))*(hc=(1-hc+yb)*ic-(sa=(1-sa+yb)*ic))-(Rb=(Rb+rb)*zc-Ha)*(Vb=(1-Vb+yb)*ic-sa))?(void 0===fd[Ta.id]&&((X=document.createElement("canvas")).width=Ta.image.width,X.height=Ta.image.height,(X=X.getContext("2d")).drawImage(Ta.image,0,0),fd[Ta.id]=X.getImageData(0,0,Ta.image.width,Ta.image.height).data),X=fd[Ta.id],Ha=4*(Math.floor(Ha)+Math.floor(sa)*Ta.image.width),
Sa.rb(X[Ha]/255,X[Ha+1]/255,X[Ha+2]/255),mc(Sa)):(na=na-(Ta=(hc*ra-Vb*ua)*(rb=1/rb))*Ha-(ra=(Kb*ua-Rb*ra)*rb)*sa,Ha=X-(Vb=(hc*ja-Vb*va)*rb)*Ha-(ja=(Kb*va-Rb*ja)*rb)*sa,T.save(),T.transform(Ta,Vb,ra,ja,na,Ha),T.fill(),T.restore())}}function z(na,X,ra,ja,ua,va,Ha,sa,Kb,Vb,Rb,hc,Ta){var rb;var yb=Ta.width-1;na=na-(yb=((hc=hc*(rb=Ta.height-1)-(sa*=rb))*(ra-=na)-(Vb=Vb*rb-sa)*(ua-=na))*(rb=1/((Kb=Kb*yb-(Ha*=yb))*hc-(Rb=Rb*yb-Ha)*Vb)))*Ha-(ra=(Kb*ua-Rb*ra)*rb)*sa;X=X-(Vb=(hc*(ja-=X)-Vb*(va-=X))*rb)*Ha-
(ja=(Kb*va-Rb*ja)*rb)*sa;T.save();T.transform(yb,Vb,ra,ja,na,X);T.clip();T.drawImage(Ta,0,0);T.restore()}function v(na,X,ra,ja){return Qb[0]=255*na.r|0,Qb[1]=255*na.v|0,Qb[2]=255*na.b|0,Qb[4]=255*X.r|0,Qb[5]=255*X.v|0,Qb[6]=255*X.b|0,Qb[8]=255*ra.r|0,Qb[9]=255*ra.v|0,Qb[10]=255*ra.b|0,Qb[12]=255*ja.r|0,Qb[13]=255*ja.v|0,Qb[14]=255*ja.b|0,Ka.putImageData(sb,0,0),wa.drawImage(za,0,0),ha}function x(na,X){var ra=X.x-na.x,ja=X.y-na.y,ua=ra*ra+ja*ja;0!==ua&&(ra*=ua=1/Math.sqrt(ua),ja*=ua,X.x+=ra,X.y+=ja,
na.x-=ra,na.y-=ja)}if(0==Ob instanceof c.Rb)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{if(!0===this.Ej&&this.clear(),T.setTransform(1,0,0,-1,u,A),k.info.I.l=0,k.info.I.s=0,q=W.Qr(Pa,Ob,this.Oi,this.us),r=q.elements,t=q.Eb,!0===(td=0<t.length)){Ub.rb(0,0,0);ud.rb(0,0,0);gd.rb(0,0,0);Pa=0;for(var F=t.length;Pa<F;Pa++){var H=(M=t[Pa]).color;M instanceof c.dh?Ub.add(H):M instanceof c.zc?ud.add(H):M instanceof c.mf&&gd.add(H)}}Pa=0;for(F=r.length;Pa<F;Pa++){var M,
P=r[Pa];if(void 0!==(M=P.F)&&!1!==M.visible){if(Fb.Jf(),P instanceof c.Bl){(y=P).x*=u;y.y*=A;H=y;var D=P;b(M.opacity);d(M.qb);var J=void 0,Y=void 0,xa=void 0,Aa=void 0,Za=P=void 0,ea=void 0;M instanceof c.re?null===M.map?(xa=D.object.scale.x,Aa=D.object.scale.y,xa*=D.scale.x*u,Aa*=D.scale.y*A,Fb.min.set(H.x-xa,H.y-Aa),Fb.max.set(H.x+xa,H.y+Aa),!1!==yc.Ie(Fb)&&(n(M.color.Fe()),T.save(),T.translate(H.x,H.y),T.rotate(-D.rotation),T.scale(xa,Aa),T.fillRect(-1,-1,2,2),T.restore())):(Za=(P=M.map.image).width>>
1,ea=P.height>>1,J=(xa=D.scale.x*u)*Za,Y=(Aa=D.scale.y*A)*ea,Fb.min.set(H.x-J,H.y-Y),Fb.max.set(H.x+J,H.y+Y),!1!==yc.Ie(Fb)&&(T.save(),T.translate(H.x,H.y),T.rotate(-D.rotation),T.scale(xa,-Aa),T.translate(-Za,-ea),T.drawImage(P,0,0),T.restore())):M instanceof c.ag&&(J=D.scale.x*u,Y=D.scale.y*A,Fb.min.set(H.x-J,H.y-Y),Fb.max.set(H.x+J,H.y+Y),!1!==yc.Ie(Fb)&&(g(M.color.Fe()),n(M.color.Fe()),T.save(),T.translate(H.x,H.y),T.rotate(-D.rotation),T.scale(J,Y),M.mb(T),T.restore()))}else if(P instanceof c.Al)y=
P.$,C=P.ca,y.j.x*=u,y.j.y*=A,C.j.x*=u,C.j.y*=A,Fb.ce([y.j,C.j]),!0===yc.Ie(Fb)&&(H=y,D=C,b(M.opacity),d(M.qb),T.beginPath(),T.moveTo(H.j.x,H.j.y),T.lineTo(D.j.x,D.j.y),M instanceof c.Kb?(e(M.Hc),f(M.li),h(M.mi),g(M.color.Fe()),m(null,null),T.stroke(),Fb.Cf(2*M.Hc)):M instanceof c.Id&&(e(M.Hc),f(M.li),h(M.mi),g(M.color.Fe()),m(M.sd,M.Ff),T.stroke(),Fb.Cf(2*M.Hc)));else if(P instanceof c.yl){if(y=P.$,C=P.ca,G=P.sb,-1>y.j.z||1<y.j.z)continue;if(-1>C.j.z||1<C.j.z)continue;if(-1>G.j.z||1<G.j.z)continue;
y.j.x*=u;y.j.y*=A;C.j.x*=u;C.j.y*=A;G.j.x*=u;G.j.y*=A;!0===M.wi&&(x(y.j,C.j),x(C.j,G.j),x(G.j,y.j));Fb.ce([y.j,C.j,G.j]);vd(y,C,G,0,1,2,P,M)}else if(P instanceof c.zl){if(y=P.$,C=P.ca,G=P.sb,I=P.Wk,-1>y.j.z||1<y.j.z)continue;if(-1>C.j.z||1<C.j.z)continue;if(-1>G.j.z||1<G.j.z)continue;if(-1>I.j.z||1<I.j.z)continue;y.j.x*=u;y.j.y*=A;C.j.x*=u;C.j.y*=A;G.j.x*=u;G.j.y*=A;I.j.x*=u;I.j.y*=A;kc.j.i(C.j);Vc.j.i(I.j);!0===M.wi&&(x(y.j,C.j),x(C.j,I.j),x(I.j,y.j),x(G.j,kc.j),x(G.j,Vc.j));Fb.ce([y.j,C.j,G.j,I.j]);
H=y;D=C;J=G;Y=I;xa=kc;Aa=Vc;k.info.I.l+=4;k.info.I.s++;b(M.opacity);d(M.qb);void 0!==M.map&&null!==M.map||void 0!==M.ma&&null!==M.ma?(vd(H,D,Y,0,1,3,P,M),vd(xa,J,Aa,1,2,3,P,M)):(L=H.j.x,K=H.j.y,Q=D.j.x,O=D.j.y,fa=J.j.x,Z=J.j.y,Ga=Y.j.x,R=Y.j.y,V=xa.j.x,aa=xa.j.y,U=Aa.j.x,ba=Aa.j.y,M instanceof c.Ac||M instanceof c.jc?(Mb.i(M.color),Ya.i(M.fb),M.C===c.ne&&Mb.multiply(P.color),!0===td?!1===M.U&&M.ua==c.mc&&4==P.Ri?(qb.i(Ub),fb.i(Ub),eb.i(Ub),xb.i(Ub),ac(P.$.Jc,P.Dd[0],qb),ac(P.ca.Jc,P.Dd[1],fb),ac(P.Wk.Jc,
P.Dd[3],eb),ac(P.sb.Jc,P.Dd[2],xb),qb.multiply(Mb).add(Ya),fb.multiply(Mb).add(Ya),eb.multiply(Mb).add(Ya),xb.multiply(Mb).add(Ya),ta=v(qb,fb,eb,xb),Wc(L,K,Q,O,Ga,R),z(L,K,Q,O,Ga,R,0,0,1,0,0,1,ta),Wc(V,aa,fa,Z,U,ba),z(V,aa,fa,Z,U,ba,1,0,1,1,0,1,ta)):(Sa.i(Ub),ac(P.og,P.Me,Sa),Sa.multiply(Mb).add(Ya),wd(L,K,Q,O,fa,Z,Ga,R),!0===M.U?uc(Sa,M.pa,M.tb,M.ub):mc(Sa)):(Sa.Fh(Mb,Ya),wd(L,K,Q,O,fa,Z,Ga,R),!0===M.U?uc(Sa,M.pa,M.tb,M.ub):mc(Sa))):M instanceof c.Qa?(Sa.i(M.color),M.C===c.ne&&Sa.multiply(P.color),
wd(L,K,Q,O,fa,Z,Ga,R),!0===M.U?uc(Sa,M.pa,M.tb,M.ub):mc(Sa)):M instanceof c.qe?(H=void 0,M.ua==c.ef?(H=P.ri,Sa.rb(H.x,H.y,H.z).A(.5).pb(.5),wd(L,K,Q,O,fa,Z,Ga,R),!0===M.U?uc(Sa,M.pa,M.tb,M.ub):mc(Sa)):M.ua==c.mc&&(H=P.wc[0],qb.rb(H.x,H.y,H.z).A(.5).pb(.5),H=P.wc[1],fb.rb(H.x,H.y,H.z).A(.5).pb(.5),H=P.wc[3],eb.rb(H.x,H.y,H.z).A(.5).pb(.5),H=P.wc[2],xb.rb(H.x,H.y,H.z).A(.5).pb(.5),ta=v(qb,fb,eb,xb),Wc(L,K,Q,O,Ga,R),z(L,K,Q,O,Ga,R,0,0,1,0,0,1,ta),Wc(V,aa,fa,Z,U,ba),z(V,aa,fa,Z,U,ba,1,0,1,1,0,1,ta))):
M instanceof c.pe&&(da=Ob.Ka,Ba=Ob.Oa,qb.r=qb.v=qb.b=1-Ua(H.j.z*H.j.w,da,Ba),fb.r=fb.v=fb.b=1-Ua(D.j.z*D.j.w,da,Ba),eb.r=eb.v=eb.b=1-Ua(Y.j.z*Y.j.w,da,Ba),xb.r=xb.v=xb.b=1-Ua(J.j.z*J.j.w,da,Ba),ta=v(qb,fb,eb,xb),Wc(L,K,Q,O,Ga,R),z(L,K,Q,O,Ga,R,0,0,1,0,0,1,ta),Wc(V,aa,fa,Z,U,ba),z(V,aa,fa,Z,U,ba,1,0,1,1,0,1,ta)))}Zb.Yn(Fb)}}T.setTransform(1,0,0,1,0,0)}}};
c.m={Ef:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",Df:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",
$j:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif",Zj:"#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n} else {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n}\n#endif",
ak:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",Si:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n#ifdef USE_SKINNING\nvec4 worldPosition = modelMatrix * skinned;\n#endif\n#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n#endif\n#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif\n#endif",
bk:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, worldNormal );\n}\n#endif",sr:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",
rr:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n#endif",sk:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",rk:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",tk:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",
qk:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",lk:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",mk:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",kk:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",nk:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",Rp:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUv );\nvec2 dSTdy = dFdy( vUv );\nfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",
Fr:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUv.st );\nvec2 st1 = dFdy( vUv.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",
Sk:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",Rk:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",Wq:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",
Xq:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\nvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n#ifdef DOUBLE_SIDED\nvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n#endif\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",
$q:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif",ar:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",
Zq:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",
Yq:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -viewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",
qg:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",pg:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",rg:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",sg:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",bh:"#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nmat4 getBoneMatrix( const in float i ) {\nfloat j = i * 4.0;\nfloat x = mod( j, N_BONE_PIXEL_X );\nfloat y = floor( j / N_BONE_PIXEL_X );\nconst float dx = 1.0 / N_BONE_PIXEL_X;\nconst float dy = 1.0 / N_BONE_PIXEL_Y;\ny = dy * ( y + 0.5 );\nvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\nvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\nvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\nvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\nmat4 bone = mat4( v1, v2, v3, v4 );\nreturn bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\nmat4 bone = boneGlobalMatrices[ int(i) ];\nreturn bone;\n}\n#endif\n#endif",
ah:"#ifdef USE_SKINNING\nmat4 boneMatX = getBoneMatrix( skinIndex.x );\nmat4 boneMatY = getBoneMatrix( skinIndex.y );\n#endif",Mi:"#ifdef USE_SKINNING\n#ifdef USE_MORPHTARGETS\nvec4 skinVertex = vec4( morphed, 1.0 );\n#else\nvec4 skinVertex = vec4( position, 1.0 );\n#endif\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\n#endif",oi:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",
pi:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\n#endif",
Qh:"vec4 mvPosition;\n#ifdef USE_SKINNING\nmvPosition = modelViewMatrix * skinned;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;",wk:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\n#endif",
Ni:"#ifdef USE_SKINNING\nmat4 skinMatrix = skinWeight.x * boneMatX;\nskinMatrix \t+= skinWeight.y * boneMatY;\n#ifdef USE_MORPHNORMALS\nvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n#else\nvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n#endif\n#endif",Sj:"vec3 objectNormal;\n#ifdef USE_SKINNING\nobjectNormal = skinnedNormal.xyz;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\nobjectNormal = morphedNormal;\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\nobjectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",
Yg:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",Xg:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( depthKernel[0][0] < shadowCoord.z ) shadowKernel[0][0] = 0.25;\nelse shadowKernel[0][0] = 0.0;\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( depthKernel[0][1] < shadowCoord.z ) shadowKernel[0][1] = 0.25;\nelse shadowKernel[0][1] = 0.0;\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( depthKernel[0][2] < shadowCoord.z ) shadowKernel[0][2] = 0.25;\nelse shadowKernel[0][2] = 0.0;\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( depthKernel[1][0] < shadowCoord.z ) shadowKernel[1][0] = 0.25;\nelse shadowKernel[1][0] = 0.0;\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( depthKernel[1][1] < shadowCoord.z ) shadowKernel[1][1] = 0.25;\nelse shadowKernel[1][1] = 0.0;\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( depthKernel[1][2] < shadowCoord.z ) shadowKernel[1][2] = 0.25;\nelse shadowKernel[1][2] = 0.0;\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( depthKernel[2][0] < shadowCoord.z ) shadowKernel[2][0] = 0.25;\nelse shadowKernel[2][0] = 0.0;\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( depthKernel[2][1] < shadowCoord.z ) shadowKernel[2][1] = 0.25;\nelse shadowKernel[2][1] = 0.0;\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( depthKernel[2][2] < shadowCoord.z ) shadowKernel[2][2] = 0.25;\nelse shadowKernel[2][2] = 0.0;\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",
Zg:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",Li:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",Hh:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",ki:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"};
c.nc={Wd:function(a){var b,d,e,f={};for(b=0;b<a.length;b++)for(d in e=this.clone(a[b]))f[d]=e[d];return f},clone:function(a){var b,d,e={};for(b in a)for(d in e[b]={},a[b]){var f=a[b][d];e[b][d]=f instanceof c.G||f instanceof c.o||f instanceof c.g||f instanceof c.oc||f instanceof c.da||f instanceof c.wb?f.clone():f instanceof Array?f.slice():f}return e}};
c.Ma={Lh:{Sh:{type:"c",value:new c.G(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},Ir:{type:"v4",value:new c.oc(0,0,1,1)},Ja:{type:"t",value:null},Fa:{type:"t",value:null},ma:{type:"t",value:null},vq:{type:"f",value:-1},ao:{type:"i",value:0},tc:{type:"f",value:1},Lc:{type:"f",value:.98},Cc:{type:"i",value:0},Ic:{type:"f",value:0}},Qp:{zb:{type:"t",value:null},yf:{type:"f",value:1}},si:{ab:{type:"t",value:null},Zd:{type:"v2",value:new c.o(1,1)}},J:{Yh:{type:"f",value:2.5E-4},$h:{type:"f",
value:1},Zh:{type:"f",value:2E3},Xh:{type:"c",value:new c.G(16777215)}},Eb:{Ap:{type:"fv",value:[]},iq:{type:"fv",value:[]},hq:{type:"fv",value:[]},Kq:{type:"fv",value:[]},Mq:{type:"fv",value:[]},Lq:{type:"fv",value:[]},Nr:{type:"fv",value:[]},Pr:{type:"fv",value:[]},Or:{type:"fv1",value:[]},xs:{type:"fv",value:[]},Bs:{type:"fv",value:[]},ys:{type:"fv",value:[]},zs:{type:"fv1",value:[]},ws:{type:"fv1",value:[]},As:{type:"fv1",value:[]}},Lr:{Rr:{type:"c",value:new c.G(15658734)},opacity:{type:"f",
value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},Yh:{type:"f",value:2.5E-4},$h:{type:"f",value:1},Zh:{type:"f",value:2E3},Xh:{type:"c",value:new c.G(16777215)}},Wg:{We:{type:"tv",value:[]},Tg:{type:"v2v",value:[]},Qf:{type:"fv1",value:[]},ee:{type:"fv1",value:[]},Ye:{type:"m4v",value:[]}}};
c.dg={Ct:{V:c.nc.Wd([c.Ma.Lh,c.Ma.J,c.Ma.Wg]),T:[c.m.sk,c.m.mk,c.m.ak,c.m.rg,c.m.oi,c.m.bh,c.m.Zg,"void main() {",c.m.tk,c.m.nk,c.m.sg,c.m.ah,"#ifdef USE_ENVMAP",c.m.wk,c.m.Ni,c.m.Sj,"#endif",c.m.pi,c.m.Mi,c.m.Qh,c.m.Si,c.m.bk,c.m.Li,"}"].join("\n"),S:["uniform vec3 diffuse;\nuniform float opacity;",c.m.qg,c.m.rk,c.m.lk,c.m.$j,c.m.Ef,c.m.Yg,c.m.Sk,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",c.m.qk,c.m.Hh,c.m.Rk,c.m.kk,c.m.pg,c.m.Zj,c.m.Xg,c.m.ki,c.m.Df,"}"].join("\n")},wv:{V:c.nc.Wd([c.Ma.Lh,
c.Ma.J,c.Ma.Eb,c.Ma.Wg,{ya:{type:"c",value:new c.G(16777215)},fb:{type:"c",value:new c.G(0)},xc:{type:"v3",value:new c.g(1,1,1)}}]),T:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",c.m.sk,c.m.mk,c.m.ak,c.m.Wq,c.m.rg,c.m.oi,c.m.bh,c.m.Zg,"void main() {",c.m.tk,c.m.nk,c.m.sg,c.m.wk,c.m.ah,c.m.Ni,c.m.Sj,c.m.pi,c.m.Mi,c.m.Qh,c.m.Si,c.m.bk,c.m.Xq,c.m.Li,"}"].join("\n"),S:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",
c.m.qg,c.m.rk,c.m.lk,c.m.$j,c.m.Ef,c.m.Yg,c.m.Sk,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",c.m.qk,c.m.Hh,c.m.Rk,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",c.m.kk,c.m.pg,c.m.Zj,c.m.Xg,c.m.ki,c.m.Df,"}"].join("\n")},hx:{V:c.nc.Wd([c.Ma.Lh,c.Ma.Qp,c.Ma.si,c.Ma.J,c.Ma.Eb,c.Ma.Wg,{ya:{type:"c",value:new c.G(16777215)},fb:{type:"c",value:new c.G(0)},bd:{type:"c",
value:new c.G(1118481)},fe:{type:"f",value:30},xc:{type:"v3",value:new c.g(1,1,1)}}]),T:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",c.m.sk,c.m.mk,c.m.ak,c.m.$q,c.m.rg,c.m.oi,c.m.bh,c.m.Zg,"void main() {",c.m.tk,c.m.nk,c.m.sg,c.m.wk,c.m.ah,c.m.Ni,c.m.Sj,"vNormal = normalize( transformedNormal );",c.m.pi,c.m.Mi,c.m.Qh,"vViewPosition = -mvPosition.xyz;",c.m.Si,c.m.bk,c.m.ar,c.m.Li,"}"].join("\n"),S:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",
c.m.qg,c.m.rk,c.m.lk,c.m.$j,c.m.Ef,c.m.Zq,c.m.Yg,c.m.Rp,c.m.Fr,c.m.Sk,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",c.m.qk,c.m.Hh,c.m.Rk,c.m.Yq,c.m.kk,c.m.pg,c.m.Zj,c.m.Xg,c.m.ki,c.m.Df,"}"].join("\n")},bx:{V:c.nc.Wd([c.Ma.Lr,c.Ma.Wg]),T:["uniform float size;\nuniform float scale;",c.m.rg,c.m.Zg,"void main() {",c.m.sg,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",
c.m.Si,c.m.Li,"}"].join("\n"),S:["uniform vec3 psColor;\nuniform float opacity;",c.m.qg,c.m.sr,c.m.Ef,c.m.Yg,"void main() {\ngl_FragColor = vec4( psColor, opacity );",c.m.rr,c.m.Hh,c.m.pg,c.m.Xg,c.m.Df,"}"].join("\n")},Bu:{V:c.nc.Wd([c.Ma.Lh,c.Ma.J,{scale:{type:"f",value:1},sd:{type:"f",value:1},Js:{type:"f",value:2}}]),T:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",c.m.rg,"void main() {",c.m.sg,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),
S:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",c.m.qg,c.m.Ef,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",c.m.pg,c.m.Df,"}"].join("\n")},depth:{V:{gr:{type:"f",value:1},fr:{type:"f",value:2E3},opacity:{type:"f",value:1}},T:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",S:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},
u:{V:{opacity:{type:"f",value:1}},T:"varying vec3 vNormal;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvNormal = normalize( normalMatrix * normal );\ngl_Position = projectionMatrix * mvPosition;\n}",S:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},si:{V:c.nc.Wd([c.Ma.J,c.Ma.Eb,c.Ma.Wg,{lm:{type:"i",value:0},mm:{type:"i",value:0},nm:{type:"i",value:0},oq:{type:"i",value:0},nq:{type:"i",
value:0},Gs:{type:"t",value:null},Hn:{type:"t",value:null},Gn:{type:"t",value:null},In:{type:"t",value:null},Jn:{type:"t",value:null},Fn:{type:"t",value:null},Tn:{type:"v2",value:new c.o(1,1)},Ns:{type:"f",value:0},Os:{type:"f",value:1},Sn:{type:"c",value:new c.G(16777215)},Wn:{type:"c",value:new c.G(1118481)},Rn:{type:"c",value:new c.G(16777215)},Vn:{type:"f",value:30},Un:{type:"f",value:1},ao:{type:"i",value:0},uy:{type:"f",value:.98},Ps:{type:"f",value:.5},ty:{type:"v2",value:new c.o(0,0)},vy:{type:"v2",
value:new c.o(1,1)},xc:{type:"v3",value:new c.g(1,1,1)}}]),S:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float uRefractionRatio;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
c.m.Yg,c.m.Ef,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\n#ifdef FLIP_SIDED\nfinalNormal = -finalNormal;\n#endif\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\nfloat pointDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\npointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\npointVector = normalize( pointVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\nfloat spotDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\nspotVector = normalize( spotVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n#endif\nspotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;\nvec3 spotHalfVector = normalize( spotVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += uDiffuseColor * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;\n#endif\nif ( enableReflection ) {\nvec3 vReflect;\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, normal, uRefractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, normal );\n}\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",
c.m.Xg,c.m.ki,c.m.Df,"}"].join("\n"),T:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",c.m.bh,c.m.Zg,"void main() {",c.m.ah,c.m.Ni,"#ifdef USE_SKINNING\nvNormal = normalize( normalMatrix * skinnedNormal.xyz );\nvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\nvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n#else\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\n#endif\nvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\nvUv = uv * uRepeat + uOffset;\nvec3 displacedPosition;\n#ifdef VERTEX_TEXTURES\nif ( enableDisplacement ) {\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\ndisplacedPosition = position + normalize( normal ) * df;\n} else {\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n}\n#else\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvWorldPosition = worldPosition.xyz;\nvViewPosition = -mvPosition.xyz;\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif\n}"].join("\n")},
eu:{V:{Gn:{type:"t",value:null},ey:{type:"f",value:-1}},T:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",S:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},im:{V:{},T:[c.m.oi,c.m.bh,"void main() {",
c.m.ah,c.m.pi,c.m.Mi,c.m.Qh,"}"].join("\n"),S:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};
c.rt=function(a){function b(l){var z=l.mb;if(void 0!==z){l.mb=void 0;var v,x,F=!1;l=0;for(v=qa.length;l<v;l++)if((x=qa[l]).mb===z){x.Vk--;0===x.Vk&&(F=!0);break}if(!0===F){F=[];l=0;for(v=qa.length;l<v;l++)(x=qa[l]).mb!==z&&F.push(x);qa=F;k.deleteProgram(z);W.info.memory.en--}}}function d(l){(l=l.target).removeEventListener("dispose",d);b(l)}function e(l){if((l=l.target).removeEventListener("dispose",e),l&&l.Zb)if(k.deleteTexture(l.Zb),l instanceof c.ve)for(var z=0;6>z;z++)k.deleteFramebuffer(l.md[z]),
k.deleteRenderbuffer(l.od[z]);else k.deleteFramebuffer(l.md),k.deleteRenderbuffer(l.od);W.info.memory.Ib--}function f(l){(l=l.target).removeEventListener("dispose",f);l.image&&l.image.kg?k.deleteTexture(l.image.kg):l.Nd&&(l.Nd=!1,k.deleteTexture(l.Zb));W.info.memory.Ib--}function h(l){if((l=l.target).removeEventListener("dispose",h),l.Nd=void 0,void 0!==l.Wa&&k.deleteBuffer(l.Wa),void 0!==l.nd&&k.deleteBuffer(l.nd),void 0!==l.Ah&&k.deleteBuffer(l.Ah),void 0!==l.Xb&&k.deleteBuffer(l.Xb),void 0!==l.Ch&&
k.deleteBuffer(l.Ch),void 0!==l.Bh&&k.deleteBuffer(l.Bh),void 0!==l.yh&&k.deleteBuffer(l.yh),void 0!==l.zh&&k.deleteBuffer(l.zh),void 0!==l.vh&&k.deleteBuffer(l.vh),void 0!==l.wh&&k.deleteBuffer(l.wh),void 0!==l.xh&&k.deleteBuffer(l.xh),void 0!==l.Pa)for(var z in l.Pa){var v=l.Pa[z];if(void 0!==v.Pe)for(var x=0,F=v.Pe;x<F;x++)k.deleteBuffer(v.sf[x]);if(void 0!==v.Oe)for(x=0,F=v.Oe;x<F;x++)k.deleteBuffer(v.ig[x]);g(v)}g(l);W.info.memory.Ta--}function g(l){if(l.xb)for(var z in l.xb)k.deleteBuffer(l.xb[z].buffer)}
function n(l,z){var v=l.l.length;z=z.F;if(z.attributes)for(var x in void 0===l.xb&&(l.xb=[]),z.attributes){var F=z.attributes[x];if(!F.wj||F.cq){F.wj=!0;var H=1;"v2"===F.type?H=2:"v3"===F.type?H=3:"v4"===F.type?H=4:"c"===F.type&&(H=3);F.size=H;F.h=new Float32Array(v*H);F.buffer=k.createBuffer();F.buffer.Ih=x;F.ia=!0}l.xb.push(F)}}function m(l,z){var v=z.D,x=l.Vh,F=l.Wh,H=3*x.length+4*F.length,M=1*x.length+2*F.length,P=(F=3*x.length+4*F.length,t(x=q(z,l))),D=r(x),J=!!x.C&&x.C;if(l.Md=new Float32Array(3*
H),D&&(l.th=new Float32Array(3*H)),v.Hf&&(l.Sl=new Float32Array(4*H)),J&&(l.Ld=new Float32Array(3*H)),P&&((0<v.Ec.length||0<v.R.length)&&(l.Ul=new Float32Array(2*H)),(1<v.Ec.length||1<v.R.length)&&(l.Tl=new Float32Array(2*H))),z.D.he.length&&z.D.ge.length&&(l.Ql=new Float32Array(4*H),l.Rl=new Float32Array(4*H)),l.Ll=new Uint16Array(3*M),l.Nl=new Uint16Array(2*F),l.Pe)for(l.Pl=[],v=0,P=l.Pe;v<P;v++)l.Pl.push(new Float32Array(3*H));if(l.Oe)for(l.Ol=[],v=0,P=l.Oe;v<P;v++)l.Ol.push(new Float32Array(3*
H));if(l.uj=3*M,l.xj=2*F,x.attributes)for(var Y in void 0===l.xb&&(l.xb=[]),x.attributes){var xa;M=x.attributes[Y];v={};for(xa in M)v[xa]=M[xa];v.wj&&!v.cq||(v.wj=!0,F=1,"v2"===v.type?F=2:"v3"===v.type?F=3:"v4"===v.type?F=4:"c"===v.type&&(F=3),v.size=F,v.h=new Float32Array(H*F),v.buffer=k.createBuffer(),v.buffer.Ih=Y,M.ia=!0,v.kp=M);l.xb.push(v)}l.Ml=!0}function q(l,z){return l.F instanceof c.Sb?l.F.oa[z.xa]:l.F}function r(l){return!(l instanceof c.Qa&&!l.ma||l instanceof c.pe)&&(l&&void 0!==l.ua&&
l.ua===c.mc?c.mc:c.ef)}function t(l){return!!(l.map||l.Ja||l.zb||l.ab||l.Fa||l instanceof c.Ra)}function p(l){var z,v;for(z in l.attributes){var x="index"===z?k.ELEMENT_ARRAY_BUFFER:k.ARRAY_BUFFER;(v=l.attributes[z]).buffer=k.createBuffer();k.bindBuffer(x,v.buffer);k.bufferData(x,v.h,k.STATIC_DRAW)}}function w(l,z,v){var x=(D=l.attributes).index,F=D.position,H=D.u,M=D.va,P=D.color,D=D.Qb;if(l.Ae&&void 0!==x&&(k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,x.buffer),k.bufferData(k.ELEMENT_ARRAY_BUFFER,x.h,z)),
l.na&&void 0!==F&&(k.bindBuffer(k.ARRAY_BUFFER,F.buffer),k.bufferData(k.ARRAY_BUFFER,F.h,z)),l.ac&&void 0!==H&&(k.bindBuffer(k.ARRAY_BUFFER,H.buffer),k.bufferData(k.ARRAY_BUFFER,H.h,z)),l.cf&&void 0!==M&&(k.bindBuffer(k.ARRAY_BUFFER,M.buffer),k.bufferData(k.ARRAY_BUFFER,M.h,z)),l.za&&void 0!==P&&(k.bindBuffer(k.ARRAY_BUFFER,P.buffer),k.bufferData(k.ARRAY_BUFFER,P.h,z)),l.ie&&void 0!==D&&(k.bindBuffer(k.ARRAY_BUFFER,D.buffer),k.bufferData(k.ARRAY_BUFFER,D.h,z)),v)for(var J in l.attributes)delete l.attributes[J].h}
function u(l){Ub[l]||(k.enableVertexAttribArray(l),Ub[l]=!0)}function A(){for(var l in Ub)Ub[l]&&(k.disableVertexAttribArray(l),Ub[l]=!1)}function y(l,z){return l.z!==z.z?z.z-l.z:z.id-l.id}function C(l,z){return z[0]-l[0]}function G(l,z,v){if(l.length)for(var x=0,F=l.length;x<F;x++)ob=La=null,bb=Ma=Nb=Tb=eb=fb=kc=-1,Qb=!0,l[x].I(z,v,Fb,td),ob=La=null,bb=Ma=Nb=Tb=eb=fb=kc=-1,Qb=!0}function I(l,z,v,x,F,H,M,P){var D,J,Y,xa;z?(J=l.length-1,xa=z=-1):(J=0,z=l.length,xa=1);for(var Aa=J;Aa!==z;Aa+=xa)if((D=
l[Aa]).I){if(J=D.object,Y=D.buffer,P)D=P;else{if(!(D=D[v]))continue;M&&W.Of(D.qb,D.blendEquation,D.ze,D.ye);W.Ve(D.rc);W.Og(D.td);da(D.polygonOffset,D.Kg,D.Lg)}W.Jk(D);Y instanceof c.hc?W.Fk(x,F,H,D,Y,J):W.Ek(x,F,H,D,Y,J)}}function L(l,z,v,x,F,H,M){for(var P,D,J=0,Y=l.length;J<Y;J++)if((D=(P=l[J]).object).visible){if(M)P=M;else{if(!(P=P[z]))continue;H&&W.Of(P.qb,P.blendEquation,P.ze,P.ye);W.Ve(P.rc);W.Og(P.td);da(P.polygonOffset,P.Kg,P.Lg)}W.Gk(v,x,F,P,D)}}function K(l,z,v){l.push({buffer:z,object:v,
Qe:null,Ba:null})}function Q(l){for(var z in l.attributes)if(l.attributes[z].ia)return!0;return!1}function O(l){for(var z in l.attributes)l.attributes[z].ia=!1}function fa(l,z){for(var v=l.length-1;0<=v;v--)l[v].object===z&&l.splice(v,1)}function Z(l,z){for(var v=l.length-1;0<=v;v--)l[v]===z&&l.splice(v,1)}function Ga(l,z,v,x,F){Xb=0;x.ia&&(x.mb&&b(x),W.Oq(x,z,v,F),x.ia=!1);x.L&&!F.jg&&(F.jg=new Float32Array(W.Hg));var H=!1,M=x.mb,P=M.V,D=x.V;if(M!==La&&(k.useProgram(M),La=M,H=!0),x.id!==bb&&(bb=
x.id,H=!0),(H||l!==ob)&&(k.uniformMatrix4fv(P.ta,!1,l.ta.elements),l!==ob&&(ob=l)),x.Aa)if(mc&&F.Cd){if(null!==P.Qd){var J=R();k.uniform1i(P.Qd,J);W.Pg(F.Qd,J)}}else null!==P.Pp&&k.uniformMatrix4fv(P.Pp,!1,F.mg);if(H){if(v&&x.J&&(D.Xh.value=v.color,v instanceof c.Xf?(D.$h.value=v.Ka,D.Zh.value=v.Oa):v instanceof c.ff&&(D.Yh.value=v.Rh)),x instanceof c.jc||x instanceof c.Ac||x.Eb){if(Qb){var Y,xa,Aa,Za,ea=J=0,na=0,X=Pa,ra=X.ug.Za,ja=X.ug.Kc,ua=X.Se.Za,va=X.Se.Kc,Ha=X.Se.vg,sa=X.cc.Za,Kb=X.cc.Kc,Vb=
X.cc.vg,Rb=X.cc.jm,hc=X.cc.bm,Ta=X.cc.om,rb=X.Ge.Dn,yb=X.Ge.zm,zc=X.Ge.Kc,ic=0,hd=0,vc=0,Pb=0,id=0,xd=0,Xd=0,Wb=0,ia;v=Za=ia=Y=0;for(H=z.length;v<H;v++)(Y=z[v]).ui||(xa=Y.color,Aa=Y.ib,Za=Y.Bb,Y instanceof c.dh?Y.visible&&(W.Wc?(J+=xa.r*xa.r,ea+=xa.v*xa.v,na+=xa.b*xa.b):(J+=xa.r,ea+=xa.v,na+=xa.b)):Y instanceof c.zc?(id+=1,Y.visible&&(sb.hb(Y.K),gb.hb(Y.target.K),sb.sub(gb),sb.normalize(),0===sb.x&&0===sb.y&&0===sb.z||(ja[Y=3*ic]=sb.x,ja[Y+1]=sb.y,ja[Y+2]=sb.z,W.Wc?aa(ra,Y,xa,Aa*Aa):U(ra,Y,xa,Aa),
ic+=1))):Y instanceof c.mf?(xd+=1,Y.visible&&(ia=3*hd,W.Wc?aa(ua,ia,xa,Aa*Aa):U(ua,ia,xa,Aa),gb.hb(Y.K),va[ia]=gb.x,va[ia+1]=gb.y,va[ia+2]=gb.z,Ha[hd]=Za,hd+=1)):Y instanceof c.nf?(Xd+=1,Y.visible&&(ia=3*vc,W.Wc?aa(sa,ia,xa,Aa*Aa):U(sa,ia,xa,Aa),gb.hb(Y.K),Kb[ia]=gb.x,Kb[ia+1]=gb.y,Kb[ia+2]=gb.z,Vb[vc]=Za,sb.i(gb),gb.hb(Y.target.K),sb.sub(gb),sb.normalize(),Rb[ia]=sb.x,Rb[ia+1]=sb.y,Rb[ia+2]=sb.z,hc[vc]=Math.cos(Y.angle),Ta[vc]=Y.exponent,vc+=1)):Y instanceof c.Yi&&(Wb+=1,Y.visible&&(sb.hb(Y.K),sb.normalize(),
0===sb.x&&0===sb.y&&0===sb.z||(zc[Za=3*Pb]=sb.x,zc[Za+1]=sb.y,zc[Za+2]=sb.z,xa=Y.color,Y=Y.Yc,W.Wc?(aa(rb,Za,xa,Aa*=Aa),aa(yb,Za,Y,Aa)):(U(rb,Za,xa,Aa),U(yb,Za,Y,Aa)),Pb+=1))));v=3*ic;for(H=Math.max(ra.length,3*id);v<H;v++)ra[v]=0;v=3*hd;for(H=Math.max(ua.length,3*xd);v<H;v++)ua[v]=0;v=3*vc;for(H=Math.max(sa.length,3*Xd);v<H;v++)sa[v]=0;v=3*Pb;for(H=Math.max(rb.length,3*Wb);v<H;v++)rb[v]=0;v=3*Pb;for(H=Math.max(yb.length,3*Wb);v<H;v++)yb[v]=0;X.ug.length=ic;X.Se.length=hd;X.cc.length=vc;X.Ge.length=
Pb;X.ya[0]=J;X.ya[1]=ea;X.ya[2]=na;Qb=!1}v=Pa;D.Ap.value=v.ya;D.hq.value=v.ug.Za;D.iq.value=v.ug.Kc;D.Nr.value=v.Se.Za;D.Pr.value=v.Se.Kc;D.Or.value=v.Se.vg;D.xs.value=v.cc.Za;D.Bs.value=v.cc.Kc;D.zs.value=v.cc.vg;D.ys.value=v.cc.jm;D.ws.value=v.cc.bm;D.As.value=v.cc.om;D.Mq.value=v.Ge.Dn;D.Lq.value=v.Ge.zm;D.Kq.value=v.Ge.Kc}var zb;if(x instanceof c.Qa||x instanceof c.Ac||x instanceof c.jc)D.opacity.value=x.opacity,W.Wc?D.Sh.value.Af(x.color):D.Sh.value=x.color,D.map.value=x.map,D.Ja.value=x.Ja,
D.Fa.value=x.Fa,x.zb&&(D.zb.value=x.zb,D.yf.value=x.yf),x.ab&&(D.ab.value=x.ab,D.Zd.value.i(x.Zd)),x.map?zb=x.map:x.Fa?zb=x.Fa:x.ab?zb=x.ab:x.zb&&(zb=x.zb),void 0!==zb&&(v=zb.offset,zb=zb.repeat,D.Ir.value.set(v.x,v.y,zb.x,zb.y)),D.ma.value=x.ma,D.vq.value=x.ma instanceof c.ve?1:-1,D.tc.value=x.tc,D.Lc.value=x.Lc,D.Cc.value=x.Cc,D.ao.value=x.ma&&x.ma.mapping instanceof c.so;if(x instanceof c.Kb?(D.Sh.value=x.color,D.opacity.value=x.opacity):x instanceof c.Id?(D.Sh.value=x.color,D.opacity.value=x.opacity,
D.sd.value=x.sd,D.Js.value=x.sd+x.Ff,D.scale.value=x.scale):x instanceof c.re?(D.Rr.value=x.color,D.opacity.value=x.opacity,D.size.value=x.size,D.scale.value=Ca.height/2,D.map.value=x.map):x instanceof c.jc?(D.fe.value=x.fe,W.Wc?(D.ya.value.Af(x.ya),D.fb.value.Af(x.fb),D.bd.value.Af(x.bd)):(D.ya.value=x.ya,D.fb.value=x.fb,D.bd.value=x.bd),x.Oc&&D.xc.value.i(x.xc)):x instanceof c.Ac?(W.Wc?(D.ya.value.Af(x.ya),D.fb.value.Af(x.fb)):(D.ya.value=x.ya,D.fb.value=x.fb),x.Oc&&D.xc.value.i(x.xc)):x instanceof
c.pe?(D.gr.value=l.Ka,D.fr.value=l.Oa,D.opacity.value=x.opacity):x instanceof c.qe&&(D.opacity.value=x.opacity),F.Nf&&!x.Pd&&D.Ye)for(v=zb=0,H=z.length;v<H;v++)(J=z[v]).qc&&(J instanceof c.nf||J instanceof c.zc&&!J.Pk)&&(D.We.value[zb]=J.We,D.Tg.value[zb]=J.Tg,D.Ye.value[zb]=J.Ye,D.ee.value[zb]=J.ee,D.Qf.value[zb]=J.Qf,zb++);D=0;for(zb=(z=x.Xn).length;D<zb;D++)if(H=M.V[z[D][1]])if(ea=(v=z[D][0]).type,J=v.value,"i"===ea)k.uniform1i(H,J);else if("f"===ea)k.uniform1f(H,J);else if("v2"===ea)k.uniform2f(H,
J.x,J.y);else if("v3"===ea)k.uniform3f(H,J.x,J.y,J.z);else if("v4"===ea)k.uniform4f(H,J.x,J.y,J.z,J.w);else if("c"===ea)k.uniform3f(H,J.r,J.v,J.b);else if("iv1"===ea)k.uniform1iv(H,J);else if("iv"===ea)k.uniform3iv(H,J);else if("fv1"===ea)k.uniform1fv(H,J);else if("fv"===ea)k.uniform3fv(H,J);else if("v2v"===ea){void 0===v.ga&&(v.ga=new Float32Array(2*J.length));ea=0;for(na=J.length;ea<na;ea++)X=2*ea,v.ga[X]=J[ea].x,v.ga[X+1]=J[ea].y;k.uniform2fv(H,v.ga)}else if("v3v"===ea){void 0===v.ga&&(v.ga=new Float32Array(3*
J.length));ea=0;for(na=J.length;ea<na;ea++)X=3*ea,v.ga[X]=J[ea].x,v.ga[X+1]=J[ea].y,v.ga[X+2]=J[ea].z;k.uniform3fv(H,v.ga)}else if("v4v"===ea){void 0===v.ga&&(v.ga=new Float32Array(4*J.length));ea=0;for(na=J.length;ea<na;ea++)X=4*ea,v.ga[X]=J[ea].x,v.ga[X+1]=J[ea].y,v.ga[X+2]=J[ea].z,v.ga[X+3]=J[ea].w;k.uniform4fv(H,v.ga)}else if("m4"===ea)void 0===v.ga&&(v.ga=new Float32Array(16)),J.uq(v.ga),k.uniformMatrix4fv(H,!1,v.ga);else if("m4v"===ea){void 0===v.ga&&(v.ga=new Float32Array(16*J.length));ea=
0;for(na=J.length;ea<na;ea++)J[ea].pm(v.ga,16*ea);k.uniformMatrix4fv(H,!1,v.ga)}else if("t"===ea){if(X=J,J=R(),k.uniform1i(H,J),X)if(X.image instanceof Array&&6===X.image.length){if(H=J,6===(v=X).image.length)if(v.ia){v.image.kg||(v.image.kg=k.createTexture(),W.info.memory.Ib++);k.activeTexture(k.TEXTURE0+H);k.bindTexture(k.TEXTURE_CUBE_MAP,v.image.kg);k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,v.flipY);H=v instanceof c.le;J=[];for(ea=0;6>ea;ea++)W.Ep&&!H?(na=J,X=ea,ra=v.image[ea],ua=Wc,ra.width<=ua&&ra.height<=
ua||(va=Math.max(ra.width,ra.height),ja=Math.floor(ra.width*ua/va),ua=Math.floor(ra.height*ua/va),(va=document.createElement("canvas")).width=ja,va.height=ua,va.getContext("2d").drawImage(ra,0,0,ra.width,ra.height,0,0,ja,ua),ra=va),na[X]=ra):J[ea]=v.image[ea];na=0==((ea=J[0]).width&ea.width-1)&&0==(ea.height&ea.height-1);X=Fa(v.format);ra=Fa(v.type);ta(k.TEXTURE_CUBE_MAP,v,na);for(ea=0;6>ea;ea++)if(H)for(va=0,Ha=(ua=J[ea].Gb).length;va<Ha;va++)ja=ua[va],k.compressedTexImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+
ea,va,X,ja.width,ja.height,0,ja.data);else k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+ea,0,X,X,ra,J[ea]);v.Ob&&na&&k.generateMipmap(k.TEXTURE_CUBE_MAP);v.ia=!1;v.ti&&v.ti()}else k.activeTexture(k.TEXTURE0+H),k.bindTexture(k.TEXTURE_CUBE_MAP,v.image.kg)}else X instanceof c.ve?(v=X,k.activeTexture(k.TEXTURE0+J),k.bindTexture(k.TEXTURE_CUBE_MAP,v.Zb)):W.Pg(X,J)}else if("tv"===ea){void 0===v.ga&&(v.ga=[]);ea=0;for(na=v.value.length;ea<na;ea++)v.ga[ea]=R();k.uniform1iv(H,v.ga);ea=0;for(na=v.value.length;ea<
na;ea++)X=v.value[ea],J=v.ga[ea],X&&W.Pg(X,J)}(x instanceof c.Ra||x instanceof c.jc||x.ma)&&null!==P.Sp&&(gb.hb(l.K),k.uniform3f(P.Sp,gb.x,gb.y,gb.z));(x instanceof c.jc||x instanceof c.Ac||x instanceof c.Ra||x.Aa)&&null!==P.Rs&&k.uniformMatrix4fv(P.Rs,!1,l.Ua.elements)}return k.uniformMatrix4fv(P.Wm,!1,F.Rc.elements),P.Er&&k.uniformMatrix3fv(P.Er,!1,F.zj.elements),null!==P.xr&&k.uniformMatrix4fv(P.xr,!1,F.K.elements),M}function R(){var l=Xb;return l>=vd&&console.warn("WebGLRenderer: trying to use "+
l+" texture units while this GPU supports only "+vd),Xb+=1,l}function V(l,z){l.Rc.Ea(z.Ua,l.K);l.zj.gb(l.Rc);l.zj.Bd()}function aa(l,z,v,x){l[z]=v.r*v.r*x;l[z+1]=v.v*v.v*x;l[z+2]=v.b*v.b*x}function U(l,z,v,x){l[z]=v.r*x;l[z+1]=v.v*x;l[z+2]=v.b*x}function ba(l){l!==sd&&(k.lineWidth(l),sd=l)}function da(l,z,v){xb!==l&&(l?k.enable(k.POLYGON_OFFSET_FILL):k.disable(k.POLYGON_OFFSET_FILL),xb=l);!l||Mb===z&&Ya===v||(k.polygonOffset(z,v),Mb=z,Ya=v)}function Ba(l,z){var v;"fragment"===l?v=k.createShader(k.FRAGMENT_SHADER):
"vertex"===l&&(v=k.createShader(k.VERTEX_SHADER));k.shaderSource(v,z);k.compileShader(v);if(k.getShaderParameter(v,k.COMPILE_STATUS))l=v;else{console.error(k.getShaderInfoLog(v));l=console;v=l.error;for(var x=0,F=(z=z.split("\n")).length;x<F;x++)z[x]=x+1+": "+z[x];l=(v.call(l,z.join("\n")),null)}return l}function ta(l,z,v){v?(k.texParameteri(l,k.TEXTURE_WRAP_S,Fa(z.ec)),k.texParameteri(l,k.TEXTURE_WRAP_T,Fa(z.fc)),k.texParameteri(l,k.TEXTURE_MAG_FILTER,Fa(z.Fb)),k.texParameteri(l,k.TEXTURE_MIN_FILTER,
Fa(z.kb))):(k.texParameteri(l,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(l,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE),k.texParameteri(l,k.TEXTURE_MAG_FILTER,S(z.Fb)),k.texParameteri(l,k.TEXTURE_MIN_FILTER,S(z.kb)));Ob&&z.type!==c.Xi&&(1<z.Mb||z.jp)&&(k.texParameterf(l,Ob.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(z.Mb,wd)),z.jp=z.Mb)}function Ia(l,z){k.bindRenderbuffer(k.RENDERBUFFER,l);z.Uc&&!z.cd?(k.renderbufferStorage(k.RENDERBUFFER,k.DEPTH_COMPONENT16,z.width,z.height),k.framebufferRenderbuffer(k.FRAMEBUFFER,
k.DEPTH_ATTACHMENT,k.RENDERBUFFER,l)):z.Uc&&z.cd?(k.renderbufferStorage(k.RENDERBUFFER,k.DEPTH_STENCIL,z.width,z.height),k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_STENCIL_ATTACHMENT,k.RENDERBUFFER,l)):k.renderbufferStorage(k.RENDERBUFFER,k.RGBA4,z.width,z.height)}function S(l){return l===c.kf||l===c.ll||l===c.kl?k.NEAREST:k.LINEAR}function Fa(l){if(l===c.kd)return k.REPEAT;if(l===c.Vf)return k.CLAMP_TO_EDGE;if(l===c.hj)return k.MIRRORED_REPEAT;if(l===c.kf)return k.NEAREST;if(l===c.ll)return k.NEAREST_MIPMAP_NEAREST;
if(l===c.kl)return k.NEAREST_MIPMAP_LINEAR;if(l===c.oe)return k.LINEAR;if(l===c.Bo)return k.LINEAR_MIPMAP_NEAREST;if(l===c.fj)return k.LINEAR_MIPMAP_LINEAR;if(l===c.pj)return k.UNSIGNED_BYTE;if(l===c.bp)return k.UNSIGNED_SHORT_4_4_4_4;if(l===c.cp)return k.UNSIGNED_SHORT_5_5_5_1;if(l===c.ep)return k.UNSIGNED_SHORT_5_6_5;if(l===c.ko)return k.BYTE;if(l===c.Ro)return k.SHORT;if(l===c.fp)return k.UNSIGNED_SHORT;if(l===c.xo)return k.INT;if(l===c.ap)return k.UNSIGNED_INT;if(l===c.Xi)return k.FLOAT;if(l===
c.fo)return k.ALPHA;if(l===c.jj)return k.RGB;if(l===c.bg)return k.RGBA;if(l===c.Do)return k.LUMINANCE;if(l===c.Co)return k.LUMINANCE_ALPHA;if(l===c.Xk)return k.FUNC_ADD;if(l===c.Wo)return k.FUNC_SUBTRACT;if(l===c.Po)return k.FUNC_REVERSE_SUBTRACT;if(l===c.gp)return k.ZERO;if(l===c.Io)return k.ONE;if(l===c.Vo)return k.SRC_COLOR;if(l===c.Lo)return k.ONE_MINUS_SRC_COLOR;if(l===c.El)return k.SRC_ALPHA;if(l===c.nl)return k.ONE_MINUS_SRC_ALPHA;if(l===c.vo)return k.DST_ALPHA;if(l===c.Jo)return k.ONE_MINUS_DST_ALPHA;
if(l===c.wo)return k.DST_COLOR;if(l===c.Ko)return k.ONE_MINUS_DST_COLOR;if(l===c.Uo)return k.SRC_ALPHA_SATURATE;if(void 0!==ac){if(l===c.wl)return ac.COMPRESSED_RGB_S3TC_DXT1_EXT;if(l===c.No)return ac.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(l===c.ul)return ac.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(l===c.vl)return ac.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}console.log("THREE.WebGLRenderer",c.tl);var Ca=void 0!==(a=a||{}).canvas?a.canvas:document.createElement("canvas"),Ra=void 0!==a.precision?a.precision:"highp",
Ja=void 0===a.alpha||a.alpha,ca=void 0===a.premultipliedAlpha||a.premultipliedAlpha,za=void 0!==a.antialias&&a.antialias,Ka=void 0===a.stencil||a.stencil,ha=void 0!==a.preserveDrawingBuffer&&a.preserveDrawingBuffer,wa=void 0!==a.clearColor?new c.G(a.clearColor):new c.G(0),Ua=void 0!==a.Tp?a.Tp:0;this.km=Ca;this.context=null;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.Fj=this.Gp=this.Oi=this.Dp=this.Cp=this.Bp=
this.Ej=!0;this.Xe=this.cn=this.rm=this.Wc=!1;this.qs=!0;this.Ug=c.ol;this.zn=c.Wi;this.Ji=this.Ki=!1;this.Hg=8;this.ni=4;this.Ep=!0;this.jn=[];this.hn=[];this.info={memory:{en:0,Ta:0,Ib:0},I:{qd:0,l:0,s:0,points:0}};var k,W=this,qa=[],T=0,La=null,ub=null,bb=-1,Ma=null,ob=null,pb=0,Xb=0,Tb=-1,Nb=-1,kc=-1,Vc=-1,Sa=-1,qb=-1,fb=-1,eb=-1,xb=null,Mb=null,Ya=null,sd=null,ed=0,fd=0,yc=0,Zb=0,Fb=0,td=0,Ub={},ud=new c.gf,gd=new c.da,$b=new c.da,gb=new c.g,sb=new c.g,Qb=!0,Pa={ya:[0,0,0],ug:{length:0,Za:[],
Kc:[]},Se:{length:0,Za:[],Kc:[],vg:[]},cc:{length:0,Za:[],Kc:[],vg:[],jm:[],bm:[],om:[]},Ge:{length:0,Dn:[],zm:[],Kc:[]}};try{if(!(k=Ca.getContext("experimental-webgl",{alpha:Ja,premultipliedAlpha:ca,antialias:za,stencil:Ka,preserveDrawingBuffer:ha})))throw"Error creating WebGL context.";}catch(l){console.error(l)}a=k.getExtension("OES_texture_float");Ja=k.getExtension("OES_standard_derivatives");var Ob=k.getExtension("EXT_texture_filter_anisotropic")||k.getExtension("MOZ_EXT_texture_filter_anisotropic")||
k.getExtension("WEBKIT_EXT_texture_filter_anisotropic");var ac=k.getExtension("WEBGL_compressed_texture_s3tc")||k.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||k.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");a||console.log("THREE.WebGLRenderer: Float textures not supported.");Ja||console.log("THREE.WebGLRenderer: Standard derivatives not supported.");Ob||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");ac||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");
void 0===k.getShaderPrecisionFormat&&(k.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});k.clearColor(0,0,0,1);k.clearDepth(1);k.clearStencil(0);k.enable(k.DEPTH_TEST);k.depthFunc(k.LEQUAL);k.frontFace(k.CCW);k.cullFace(k.BACK);k.enable(k.CULL_FACE);k.enable(k.BLEND);k.blendEquation(k.FUNC_ADD);k.blendFunc(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA);k.clearColor(wa.r,wa.v,wa.b,Ua);this.context=k;var vd=k.getParameter(k.MAX_TEXTURE_IMAGE_UNITS),Wc=k.getParameter(k.MAX_CUBE_MAP_TEXTURE_SIZE),
wd=Ob?k.getParameter(Ob.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,uc=0<k.getParameter(k.MAX_VERTEX_TEXTURE_IMAGE_UNITS),mc=uc&&a;Ja=k.getShaderPrecisionFormat(k.FRAGMENT_SHADER,k.HIGH_FLOAT);a=k.getShaderPrecisionFormat(k.FRAGMENT_SHADER,k.MEDIUM_FLOAT);Ja=0<k.getShaderPrecisionFormat(k.VERTEX_SHADER,k.HIGH_FLOAT).precision&&0<Ja.precision;a=0<k.getShaderPrecisionFormat(k.VERTEX_SHADER,k.MEDIUM_FLOAT).precision&&0<a.precision;"highp"===Ra&&!Ja&&(a?(Ra="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):
(Ra="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));"mediump"===Ra&&!a&&(Ra="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return k};this.ym=function(){return Ra};this.Gi=function(l,z){Ca.width=l*this.devicePixelRatio;Ca.height=z*this.devicePixelRatio;Ca.style.width=l+"px";Ca.style.height=z+"px";this.js(Ca.width,Ca.height)};this.js=function(l,z){fd=ed=0;yc=void 0!==l?l:Ca.width;Zb=void 0!==z?z:Ca.height;k.viewport(ed,
fd,yc,Zb)};this.vm=function(){return wa};this.um=function(){return Ua};this.clear=function(l,z,v){var x=0;(void 0===l||l)&&(x|=k.COLOR_BUFFER_BIT);(void 0===z||z)&&(x|=k.DEPTH_BUFFER_BIT);(void 0===v||v)&&(x|=k.STENCIL_BUFFER_BIT);k.clear(x)};this.am=function(l){l.Dg(this);this.hn.push(l)};this.yp=function(l){l.Dg(this);this.jn.push(l)};this.Vr=function(l,z,v){if(l.Hq&&!l.Wa&&(l.Wa=k.createBuffer()),l.Gq&&!l.nd&&(l.nd=k.createBuffer()),l.Jq&&!l.Xl&&(l.Xl=k.createBuffer()),l.Fq&&!l.Xb&&(l.Xb=k.createBuffer()),
l.Hq&&(k.bindBuffer(k.ARRAY_BUFFER,l.Wa),k.bufferData(k.ARRAY_BUFFER,l.lx,k.DYNAMIC_DRAW),k.enableVertexAttribArray(z.attributes.position),k.vertexAttribPointer(z.attributes.position,3,k.FLOAT,!1,0,0)),l.Gq){if(k.bindBuffer(k.ARRAY_BUFFER,l.nd),v.ua===c.ef){var x,F,H=3*l.count;for(F=0;F<H;F+=9){var M=(x=l.Dr)[F];var P=x[F+1];var D=x[F+2];var J=x[F+3];var Y=x[F+4];var xa=x[F+5];M=(M+J+x[F+6])/3;P=(P+Y+x[F+7])/3;D=(D+xa+x[F+8])/3;x[F]=M;x[F+1]=P;x[F+2]=D;x[F+3]=M;x[F+4]=P;x[F+5]=D;x[F+6]=M;x[F+7]=P;
x[F+8]=D}}k.bufferData(k.ARRAY_BUFFER,l.Dr,k.DYNAMIC_DRAW);k.enableVertexAttribArray(z.attributes.u);k.vertexAttribPointer(z.attributes.u,3,k.FLOAT,!1,0,0)}l.Jq&&v.map&&(k.bindBuffer(k.ARRAY_BUFFER,l.Xl),k.bufferData(k.ARRAY_BUFFER,l.xy,k.DYNAMIC_DRAW),k.enableVertexAttribArray(z.attributes.va),k.vertexAttribPointer(z.attributes.va,2,k.FLOAT,!1,0,0));l.Fq&&v.C!==c.Zf&&(k.bindBuffer(k.ARRAY_BUFFER,l.Xb),k.bufferData(k.ARRAY_BUFFER,l.Vt,k.DYNAMIC_DRAW),k.enableVertexAttribArray(z.attributes.color),
k.vertexAttribPointer(z.attributes.color,3,k.FLOAT,!1,0,0));k.drawArrays(k.TRIANGLES,0,l.count);l.count=0};this.Fk=function(l,z,v,x,F,H){if(!1!==x.visible)if(l=(v=Ga(l,z,v,x,H)).attributes,z=!1,(v=16777215*F.id+2*v.id+(x.U?1:0))!==Ma&&(Ma=v,z=!0),z&&A(),H instanceof c.Y)if(x=F.attributes.index){1<(H=F.zk).length&&(z=!0);v=0;for(var M=H.length;v<M;v++){var P=H[v].index;if(z){var D=F.attributes.position,J=D.Db;if(k.bindBuffer(k.ARRAY_BUFFER,D.buffer),u(l.position),k.vertexAttribPointer(l.position,J,
k.FLOAT,!1,0,4*P*J),J=F.attributes.u,0<=l.u&&J){var Y=J.Db;k.bindBuffer(k.ARRAY_BUFFER,J.buffer);u(l.u);k.vertexAttribPointer(l.u,Y,k.FLOAT,!1,0,4*P*Y)}J=F.attributes.va;0<=l.va&&J&&(Y=J.Db,k.bindBuffer(k.ARRAY_BUFFER,J.buffer),u(l.va),k.vertexAttribPointer(l.va,Y,k.FLOAT,!1,0,4*P*Y));J=F.attributes.color;0<=l.color&&J&&(Y=J.Db,k.bindBuffer(k.ARRAY_BUFFER,J.buffer),u(l.color),k.vertexAttribPointer(l.color,Y,k.FLOAT,!1,0,4*P*Y));J=F.attributes.Qb;0<=l.Qb&&J&&(Y=J.Db,k.bindBuffer(k.ARRAY_BUFFER,J.buffer),
u(l.Qb),k.vertexAttribPointer(l.Qb,Y,k.FLOAT,!1,0,4*P*Y));k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,x.buffer)}k.drawElements(k.TRIANGLES,H[v].count,k.UNSIGNED_SHORT,2*H[v].start);W.info.I.qd++;W.info.I.l+=H[v].count;W.info.I.s+=H[v].count/3}}else z&&(J=(D=F.attributes.position).Db,k.bindBuffer(k.ARRAY_BUFFER,D.buffer),u(l.position),k.vertexAttribPointer(l.position,J,k.FLOAT,!1,0,0),J=F.attributes.u,0<=l.u&&J&&(Y=J.Db,k.bindBuffer(k.ARRAY_BUFFER,J.buffer),u(l.u),k.vertexAttribPointer(l.u,Y,k.FLOAT,!1,0,
0)),J=F.attributes.va,0<=l.va&&J&&(Y=J.Db,k.bindBuffer(k.ARRAY_BUFFER,J.buffer),u(l.va),k.vertexAttribPointer(l.va,Y,k.FLOAT,!1,0,0)),J=F.attributes.color,0<=l.color&&J&&(Y=J.Db,k.bindBuffer(k.ARRAY_BUFFER,J.buffer),u(l.color),k.vertexAttribPointer(l.color,Y,k.FLOAT,!1,0,0)),J=F.attributes.Qb,0<=l.Qb&&J&&(Y=J.Db,k.bindBuffer(k.ARRAY_BUFFER,J.buffer),u(l.Qb),k.vertexAttribPointer(l.Qb,Y,k.FLOAT,!1,0,0))),k.drawArrays(k.TRIANGLES,0,D.$d/3),W.info.I.qd++,W.info.I.l+=D.$d/3,W.info.I.s+=D.$d/3/3;else H instanceof
c.Tb?z&&(J=(D=F.attributes.position).Db,k.bindBuffer(k.ARRAY_BUFFER,D.buffer),u(l.position),k.vertexAttribPointer(l.position,J,k.FLOAT,!1,0,0),J=F.attributes.color,0<=l.color&&J&&(Y=J.Db,k.bindBuffer(k.ARRAY_BUFFER,J.buffer),u(l.color),k.vertexAttribPointer(l.color,Y,k.FLOAT,!1,0,0)),k.drawArrays(k.POINTS,0,D.$d/3),W.info.I.qd++,W.info.I.points+=D.$d/3):H instanceof c.Ga&&z&&(J=(D=F.attributes.position).Db,k.bindBuffer(k.ARRAY_BUFFER,D.buffer),u(l.position),k.vertexAttribPointer(l.position,J,k.FLOAT,
!1,0,0),J=F.attributes.color,0<=l.color&&J&&(Y=J.Db,k.bindBuffer(k.ARRAY_BUFFER,J.buffer),u(l.color),k.vertexAttribPointer(l.color,Y,k.FLOAT,!1,0,0)),ba(x.Hc),k.drawArrays(k.LINE_STRIP,0,D.$d/3),W.info.I.qd++,W.info.I.points+=D.$d)};this.Ek=function(l,z,v,x,F,H){if(!1!==x.visible){var M;l=(v=Ga(l,z,v,x,H)).attributes;z=!1;if((v=16777215*F.id+2*v.id+(x.U?1:0))!==Ma&&(Ma=v,z=!0),z&&A(),!x.L&&0<=l.position)z&&(k.bindBuffer(k.ARRAY_BUFFER,F.Wa),u(l.position),k.vertexAttribPointer(l.position,3,k.FLOAT,
!1,0,0));else if(H.uk){if(v=x.mb.attributes,-1!==H.uk&&0<=v.position?(k.bindBuffer(k.ARRAY_BUFFER,F.sf[H.uk]),u(v.position),k.vertexAttribPointer(v.position,3,k.FLOAT,!1,0,0)):0<=v.position&&(k.bindBuffer(k.ARRAY_BUFFER,F.Wa),u(v.position),k.vertexAttribPointer(v.position,3,k.FLOAT,!1,0,0)),H.Xm.length){var P=0;var D=H.Xm;for(M=H.Ic;P<x.Jg&&P<D.length;)0<=v["morphTarget"+P]&&(k.bindBuffer(k.ARRAY_BUFFER,F.sf[D[P]]),u(v["morphTarget"+P]),k.vertexAttribPointer(v["morphTarget"+P],3,k.FLOAT,!1,0,0)),
0<=v["morphNormal"+P]&&x.ja&&(k.bindBuffer(k.ARRAY_BUFFER,F.ig[D[P]]),u(v["morphNormal"+P]),k.vertexAttribPointer(v["morphNormal"+P],3,k.FLOAT,!1,0,0)),H.jg[P]=M[D[P]],P++}else{D=[];var J,Y=(M=H.Ic).length;for(J=0;J<Y;J++)0<(P=M[J])&&D.push([P,J]);D.length>x.Jg?(D.sort(C),D.length=x.Jg):D.length>x.$m?D.sort(C):0===D.length&&D.push([0,0]);for(P=0;P<x.Jg;)D[P]?(J=D[P][1],0<=v["morphTarget"+P]&&(k.bindBuffer(k.ARRAY_BUFFER,F.sf[J]),u(v["morphTarget"+P]),k.vertexAttribPointer(v["morphTarget"+P],3,k.FLOAT,
!1,0,0)),0<=v["morphNormal"+P]&&x.ja&&(k.bindBuffer(k.ARRAY_BUFFER,F.ig[J]),u(v["morphNormal"+P]),k.vertexAttribPointer(v["morphNormal"+P],3,k.FLOAT,!1,0,0)),H.jg[P]=M[J]):H.jg[P]=0,P++}null!==x.mb.V.Ic&&k.uniform1fv(x.mb.V.Ic,H.jg)}if(z){if(F.xb)for(M=0,D=F.xb.length;M<D;M++)0<=l[(v=F.xb[M]).buffer.Ih]&&(k.bindBuffer(k.ARRAY_BUFFER,v.buffer),u(l[v.buffer.Ih]),k.vertexAttribPointer(l[v.buffer.Ih],v.size,k.FLOAT,!1,0,0));0<=l.color&&(k.bindBuffer(k.ARRAY_BUFFER,F.Xb),u(l.color),k.vertexAttribPointer(l.color,
3,k.FLOAT,!1,0,0));0<=l.u&&(k.bindBuffer(k.ARRAY_BUFFER,F.nd),u(l.u),k.vertexAttribPointer(l.u,3,k.FLOAT,!1,0,0));0<=l.Qb&&(k.bindBuffer(k.ARRAY_BUFFER,F.Ah),u(l.Qb),k.vertexAttribPointer(l.Qb,4,k.FLOAT,!1,0,0));0<=l.va&&(k.bindBuffer(k.ARRAY_BUFFER,F.Ch),u(l.va),k.vertexAttribPointer(l.va,2,k.FLOAT,!1,0,0));0<=l.bo&&(k.bindBuffer(k.ARRAY_BUFFER,F.Bh),u(l.bo),k.vertexAttribPointer(l.bo,2,k.FLOAT,!1,0,0));x.Aa&&0<=l.Bn&&0<=l.Cn&&(k.bindBuffer(k.ARRAY_BUFFER,F.yh),u(l.Bn),k.vertexAttribPointer(l.Bn,
4,k.FLOAT,!1,0,0),k.bindBuffer(k.ARRAY_BUFFER,F.zh),u(l.Cn),k.vertexAttribPointer(l.Cn,4,k.FLOAT,!1,0,0));0<=l.Hm&&(k.bindBuffer(k.ARRAY_BUFFER,F.xh),u(l.Hm),k.vertexAttribPointer(l.Hm,1,k.FLOAT,!1,0,0))}H instanceof c.Y?(x.U?(ba(x.pa),z&&k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,F.wh),k.drawElements(k.LINES,F.xj,k.UNSIGNED_SHORT,0)):(z&&k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,F.vh),k.drawElements(k.TRIANGLES,F.uj,k.UNSIGNED_SHORT,0)),W.info.I.qd++,W.info.I.l+=F.uj,W.info.I.s+=F.uj/3):H instanceof c.Ga?(H=
H.type===c.il?k.LINE_STRIP:k.LINES,ba(x.Hc),k.drawArrays(H,0,F.xj),W.info.I.qd++):H instanceof c.Tb?(k.drawArrays(k.POINTS,0,F.Wl),W.info.I.qd++,W.info.I.points+=F.Wl):H instanceof c.Jd&&(k.drawArrays(k.TRIANGLE_STRIP,0,F.rp),W.info.I.qd++)}};this.I=function(l,z,v,x){if(0==z instanceof c.Rb)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var F,H,M,P,D=l.Wb,J=l.J;bb=-1;Qb=!0;this.Fj&&l.Jb();void 0===z.parent&&z.Jb();z.Ua.gb(z.K);gd.Ea(z.ta,z.Ua);ud.Ei(gd);
this.Gp&&this.Pq(l);G(this.jn,l,z);W.info.I.qd=0;W.info.I.l=0;W.info.I.s=0;W.info.I.points=0;this.Kk(v);(this.Ej||x)&&this.clear(this.Bp,this.Cp,this.Dp);x=0;for(F=(P=l.Yb).length;x<F;x++)if(M=(H=P[x]).object,H.I=!1,M.visible&&(!(M instanceof c.Y||M instanceof c.Tb)||!M.De||ud.gi(M))){V(M,z);var Y=H,xa=Y.buffer,Aa,Za=Aa=void 0;(Za=Y.object.F)instanceof c.Sb?(Aa=xa.xa,(Aa=Za.oa[Aa]).Ba?(Y.Ba=Aa,Y.Qe=null):(Y.Qe=Aa,Y.Ba=null)):(Aa=Za)&&(Aa.Ba?(Y.Ba=Aa,Y.Qe=null):(Y.Qe=Aa,Y.Ba=null));H.I=!0;!0===this.Oi&&
(null!==M.ad?H.z=M.ad:(gb.hb(M.K),gb.Sc(gd),H.z=gb.z),H.id=M.id)}this.Oi&&P.sort(y);x=0;for(F=(P=l.Od).length;x<F;x++)(M=(H=P[x]).object).visible&&(V(M,z),(M=H.object.F).Ba?(H.Ba=M,H.Qe=null):(H.Qe=M,H.Ba=null));l.bn?(x=l.bn,this.Of(x.qb,x.blendEquation,x.ze,x.ye),this.Ve(x.rc),this.Og(x.td),da(x.polygonOffset,x.Kg,x.Lg),I(l.Yb,!1,"",z,D,J,!0,x),L(l.Od,"",z,D,J,!1,x)):(x=null,this.Of(c.ml),I(l.Yb,!0,"opaque",z,D,J,!1,x),L(l.Od,"opaque",z,D,J,!1,x),I(l.Yb,!1,"transparent",z,D,J,!0,x),L(l.Od,"transparent",
z,D,J,!0,x));G(this.hn,l,z);v&&v.Ob&&v.kb!==c.kf&&v.kb!==c.oe&&(v instanceof c.ve?(k.bindTexture(k.TEXTURE_CUBE_MAP,v.Zb),k.generateMipmap(k.TEXTURE_CUBE_MAP),k.bindTexture(k.TEXTURE_CUBE_MAP,null)):(k.bindTexture(k.TEXTURE_2D,v.Zb),k.generateMipmap(k.TEXTURE_2D),k.bindTexture(k.TEXTURE_2D,null)));this.Ve(!0);this.Og(!0)}};this.Gk=function(l,z,v,x,F){var H=Ga(l,z,v,x,F);Ma=-1;W.Jk(x);F.hk?F.hk(H,k,ud):F.I(function(M){W.Vr(M,H,x)})};this.Pq=function(l){for(l.Yb||(l.Yb=[],l.Od=[],l.yj=[],l.vj=[]);l.pf.length;){var z=
l.pf[0],v=l,x=void 0,F=void 0,H=void 0,M=void 0;if(!z.Nd)if(z.Nd=!0,z.Rc=new c.da,z.zj=new c.hd,void 0!==z.D&&void 0===z.D.Nd&&(z.D.Nd=!0,z.D.addEventListener("dispose",h)),z instanceof c.Y)if(F=z.D,H=z.F,F instanceof c.N){if(void 0===F.Pa){var P,D=F,J=void 0,Y=void 0,xa=void 0,Aa=void 0,Za=void 0,ea={},na=D.L.length,X=D.ja.length,ra=H instanceof c.Sb;D.Pa={};J=0;for(P=D.s.length;J<P;J++)Y=D.s[J],void 0===ea[xa=ra?Y.xa:0]&&(ea[xa]={hash:xa,counter:0}),Za=ea[xa].hash+"_"+ea[xa].counter,void 0===D.Pa[Za]&&
(D.Pa[Za]={Vh:[],Wh:[],xa,l:0,Pe:na,Oe:X}),Aa=Y instanceof c.aa?3:4,65535<D.Pa[Za].l+Aa&&(ea[xa].counter+=1,Za=ea[xa].hash+"_"+ea[xa].counter,void 0===D.Pa[Za]&&(D.Pa[Za]={Vh:[],Wh:[],xa,l:0,Pe:na,Oe:X})),Y instanceof c.aa?D.Pa[Za].Vh.push(J):D.Pa[Za].Wh.push(J),D.Pa[Za].l+=Aa;D.ek=[];var ja=void 0;for(ja in D.Pa)D.Pa[ja].id=pb++,D.ek.push(D.Pa[ja])}for(x in F.Pa)if(!(M=F.Pa[x]).Wa){var ua=M;ua.Wa=k.createBuffer();ua.nd=k.createBuffer();ua.Ah=k.createBuffer();ua.Xb=k.createBuffer();ua.Ch=k.createBuffer();
ua.Bh=k.createBuffer();ua.yh=k.createBuffer();ua.zh=k.createBuffer();ua.vh=k.createBuffer();ua.wh=k.createBuffer();var va=void 0,Ha=void 0;if(ua.Pe)for(ua.sf=[],va=0,Ha=ua.Pe;va<Ha;va++)ua.sf.push(k.createBuffer());if(ua.Oe)for(ua.ig=[],va=0,Ha=ua.Oe;va<Ha;va++)ua.ig.push(k.createBuffer());W.info.memory.Ta++;m(M,z);F.na=!0;F.vk=!0;F.Ae=!0;F.cf=!0;F.ac=!0;F.ie=!0;F.za=!0}}else F instanceof c.hc&&p(F);else if(z instanceof c.Jd){if(!(F=z.D).Wa){var sa=F;sa.Wa=k.createBuffer();sa.Xb=k.createBuffer();
sa.nd=k.createBuffer();W.info.memory.Ta++;var Kb=F,Vb=z,Rb=Kb.l.length;Kb.Md=new Float32Array(3*Rb);Kb.Ld=new Float32Array(3*Rb);Kb.th=new Float32Array(3*Rb);Kb.rp=Rb;n(Kb,Vb);F.na=!0;F.za=!0;F.ac=!0}}else if(z instanceof c.Ga){if(!(F=z.D).Wa)if(F instanceof c.N){var hc=F;hc.Wa=k.createBuffer();hc.Xb=k.createBuffer();hc.xh=k.createBuffer();W.info.memory.Ta++;var Ta=F,rb=z,yb=Ta.l.length;Ta.Md=new Float32Array(3*yb);Ta.Ld=new Float32Array(3*yb);Ta.ip=new Float32Array(1*yb);Ta.xj=yb;n(Ta,rb);F.na=!0;
F.za=!0;F.ji=!0}else F instanceof c.hc&&p(F)}else if(z instanceof c.Tb&&!(F=z.D).Wa)if(F instanceof c.N){var zc=F;zc.Wa=k.createBuffer();zc.Xb=k.createBuffer();W.info.memory.Ta++;var ic=F,hd=z,vc=ic.l.length;ic.Md=new Float32Array(3*vc);ic.Ld=new Float32Array(3*vc);ic.mp=[];ic.Wl=vc;n(ic,hd);F.na=!0;F.za=!0}else F instanceof c.hc&&p(F);if(!z.Vl){if(z instanceof c.Y)if((F=z.D)instanceof c.hc)K(v.Yb,F,z);else{if(F instanceof c.N)for(x in F.Pa)M=F.Pa[x],K(v.Yb,M,z)}else z instanceof c.Jd||z instanceof
c.Ga||z instanceof c.Tb?(F=z.D,K(v.Yb,F,z)):z instanceof c.aj||z.hk?v.Od.push({object:z,Qe:null,Ba:null}):z instanceof c.te?v.yj.push(z):z instanceof c.kh&&v.vj.push(z);z.Vl=!0}l.pf.splice(0,1)}for(;l.qf.length;){var Pb=l.qf[0],id=l;Pb instanceof c.Y||Pb instanceof c.Tb||Pb instanceof c.Jd||Pb instanceof c.Ga?fa(id.Yb,Pb):Pb instanceof c.te?Z(id.yj,Pb):Pb instanceof c.kh?Z(id.vj,Pb):(Pb instanceof c.aj||Pb.hk)&&fa(id.Od,Pb);Pb.Vl=!1;l.qf.splice(0,1)}for(var xd=0,Xd=l.Yb.length;xd<Xd;xd++){var Wb=
l.Yb[xd].object,ia=Wb.D,zb=void 0,Zc=void 0,Sb=void 0;if(Wb instanceof c.Y)if(ia instanceof c.hc)(ia.na||ia.Ae||ia.cf||ia.ac||ia.za||ia.ie)&&w(ia,k.DYNAMIC_DRAW,!ia.wg),ia.na=!1,ia.Ae=!1,ia.cf=!1,ia.ac=!1,ia.za=!1,ia.ie=!1;else{for(var xe=0,tf=ia.ek.length;xe<tf;xe++)if(Sb=q(Wb,zb=ia.ek[xe]),ia.dm&&m(zb,Wb),Zc=Sb.attributes&&Q(Sb),ia.na||ia.vk||ia.Ae||ia.cf||ia.ac||ia.za||ia.ie||Zc){var Xa=zb,uf=Wb,nc=k.DYNAMIC_DRAW,vf=!ia.wg,jd=Sb;if(Xa.Ml){var Se=r(jd),ye=!!jd.C&&jd.C,Te=t(jd),Yd=Se===c.mc,N=void 0,
oa=void 0,pa=void 0,yd=void 0,$c=void 0,wc=void 0,Zd=void 0,kd=void 0,$d=void 0,ae=void 0,ka=void 0,la=void 0,ma=void 0,Wa=void 0,Ac=void 0,Bc=void 0,Cc=void 0,Gd=void 0,Dc=void 0,Ec=void 0,Fc=void 0,Hd=void 0,Gc=void 0,Hc=void 0,Ic=void 0,Id=void 0,Jc=void 0,Kc=void 0,Lc=void 0,Jd=void 0,Mc=void 0,Nc=void 0,Oc=void 0,Kd=void 0,cb=void 0,Ue=void 0,ad=void 0,zd=void 0,Ad=void 0,Cb=void 0,Ve=void 0,Gb=void 0,Hb=void 0,Bd=void 0,ld=void 0,vb=0,Ab=0,md=0,nd=0,xc=0,bc=0,hb=0,cc=0,wb=0,Da=0,Qa=0,E=0,ib=
void 0,Db=Xa.Md,Ld=Xa.Ul,Md=Xa.Tl,oc=Xa.th,jb=Xa.Sl,Eb=Xa.Ld,kb=Xa.Ql,lb=Xa.Rl,ze=Xa.Pl,Ae=Xa.Ol,Be=Xa.xb,B=void 0,Pc=Xa.Ll,jc=Xa.Nl,dc=uf.D,wf=dc.Ae,We=dc.cf,xf=dc.ac,yf=dc.ie,zf=dc.za,Af=dc.vk,od=dc.l,$a=Xa.Vh,ab=Xa.Wh,Lb=dc.s,Ce=dc.R[0],De=dc.R[1],pd=dc.ge,bd=dc.he,cd=dc.L,be=dc.ja;if(dc.na){N=0;for(oa=$a.length;N<oa;N++)ka=od[(pa=Lb[$a[N]]).a],la=od[pa.b],ma=od[pa.c],Db[Ab]=ka.x,Db[Ab+1]=ka.y,Db[Ab+2]=ka.z,Db[Ab+3]=la.x,Db[Ab+4]=la.y,Db[Ab+5]=la.z,Db[Ab+6]=ma.x,Db[Ab+7]=ma.y,Db[Ab+8]=ma.z,Ab+=
9;N=0;for(oa=ab.length;N<oa;N++)ka=od[(pa=Lb[ab[N]]).a],la=od[pa.b],ma=od[pa.c],Wa=od[pa.d],Db[Ab]=ka.x,Db[Ab+1]=ka.y,Db[Ab+2]=ka.z,Db[Ab+3]=la.x,Db[Ab+4]=la.y,Db[Ab+5]=la.z,Db[Ab+6]=ma.x,Db[Ab+7]=ma.y,Db[Ab+8]=ma.z,Db[Ab+9]=Wa.x,Db[Ab+10]=Wa.y,Db[Ab+11]=Wa.z,Ab+=12;k.bindBuffer(k.ARRAY_BUFFER,Xa.Wa);k.bufferData(k.ARRAY_BUFFER,Db,nc)}if(Af)for(Cb=0,Ve=cd.length;Cb<Ve;Cb++){N=Qa=0;for(oa=$a.length;N<oa;N++)pa=Lb[Bd=$a[N]],ka=cd[Cb].l[pa.a],la=cd[Cb].l[pa.b],ma=cd[Cb].l[pa.c],(Gb=ze[Cb])[Qa]=ka.x,
Gb[Qa+1]=ka.y,Gb[Qa+2]=ka.z,Gb[Qa+3]=la.x,Gb[Qa+4]=la.y,Gb[Qa+5]=la.z,Gb[Qa+6]=ma.x,Gb[Qa+7]=ma.y,Gb[Qa+8]=ma.z,jd.ja&&(Yd?(Dc=(ld=be[Cb].M[Bd]).a,Ec=ld.b,Fc=ld.c):Fc=Ec=Dc=be[Cb].Th[Bd],(Hb=Ae[Cb])[Qa]=Dc.x,Hb[Qa+1]=Dc.y,Hb[Qa+2]=Dc.z,Hb[Qa+3]=Ec.x,Hb[Qa+4]=Ec.y,Hb[Qa+5]=Ec.z,Hb[Qa+6]=Fc.x,Hb[Qa+7]=Fc.y,Hb[Qa+8]=Fc.z),Qa+=9;N=0;for(oa=ab.length;N<oa;N++)pa=Lb[Bd=ab[N]],ka=cd[Cb].l[pa.a],la=cd[Cb].l[pa.b],ma=cd[Cb].l[pa.c],Wa=cd[Cb].l[pa.d],(Gb=ze[Cb])[Qa]=ka.x,Gb[Qa+1]=ka.y,Gb[Qa+2]=ka.z,Gb[Qa+3]=
la.x,Gb[Qa+4]=la.y,Gb[Qa+5]=la.z,Gb[Qa+6]=ma.x,Gb[Qa+7]=ma.y,Gb[Qa+8]=ma.z,Gb[Qa+9]=Wa.x,Gb[Qa+10]=Wa.y,Gb[Qa+11]=Wa.z,jd.ja&&(Yd?(Dc=(ld=be[Cb].M[Bd]).a,Ec=ld.b,Fc=ld.c,Hd=ld.d):Hd=Fc=Ec=Dc=be[Cb].Th[Bd],(Hb=Ae[Cb])[Qa]=Dc.x,Hb[Qa+1]=Dc.y,Hb[Qa+2]=Dc.z,Hb[Qa+3]=Ec.x,Hb[Qa+4]=Ec.y,Hb[Qa+5]=Ec.z,Hb[Qa+6]=Fc.x,Hb[Qa+7]=Fc.y,Hb[Qa+8]=Fc.z,Hb[Qa+9]=Hd.x,Hb[Qa+10]=Hd.y,Hb[Qa+11]=Hd.z),Qa+=12;k.bindBuffer(k.ARRAY_BUFFER,Xa.sf[Cb]);k.bufferData(k.ARRAY_BUFFER,ze[Cb],nc);jd.ja&&(k.bindBuffer(k.ARRAY_BUFFER,
Xa.ig[Cb]),k.bufferData(k.ARRAY_BUFFER,Ae[Cb],nc))}if(bd.length){N=0;for(oa=$a.length;N<oa;N++)Jc=bd[(pa=Lb[$a[N]]).a],Kc=bd[pa.b],Lc=bd[pa.c],lb[Da]=Jc.x,lb[Da+1]=Jc.y,lb[Da+2]=Jc.z,lb[Da+3]=Jc.w,lb[Da+4]=Kc.x,lb[Da+5]=Kc.y,lb[Da+6]=Kc.z,lb[Da+7]=Kc.w,lb[Da+8]=Lc.x,lb[Da+9]=Lc.y,lb[Da+10]=Lc.z,lb[Da+11]=Lc.w,Mc=pd[pa.a],Nc=pd[pa.b],Oc=pd[pa.c],kb[Da]=Mc.x,kb[Da+1]=Mc.y,kb[Da+2]=Mc.z,kb[Da+3]=Mc.w,kb[Da+4]=Nc.x,kb[Da+5]=Nc.y,kb[Da+6]=Nc.z,kb[Da+7]=Nc.w,kb[Da+8]=Oc.x,kb[Da+9]=Oc.y,kb[Da+10]=Oc.z,kb[Da+
11]=Oc.w,Da+=12;N=0;for(oa=ab.length;N<oa;N++)Jc=bd[(pa=Lb[ab[N]]).a],Kc=bd[pa.b],Lc=bd[pa.c],Jd=bd[pa.d],lb[Da]=Jc.x,lb[Da+1]=Jc.y,lb[Da+2]=Jc.z,lb[Da+3]=Jc.w,lb[Da+4]=Kc.x,lb[Da+5]=Kc.y,lb[Da+6]=Kc.z,lb[Da+7]=Kc.w,lb[Da+8]=Lc.x,lb[Da+9]=Lc.y,lb[Da+10]=Lc.z,lb[Da+11]=Lc.w,lb[Da+12]=Jd.x,lb[Da+13]=Jd.y,lb[Da+14]=Jd.z,lb[Da+15]=Jd.w,Mc=pd[pa.a],Nc=pd[pa.b],Oc=pd[pa.c],Kd=pd[pa.d],kb[Da]=Mc.x,kb[Da+1]=Mc.y,kb[Da+2]=Mc.z,kb[Da+3]=Mc.w,kb[Da+4]=Nc.x,kb[Da+5]=Nc.y,kb[Da+6]=Nc.z,kb[Da+7]=Nc.w,kb[Da+8]=
Oc.x,kb[Da+9]=Oc.y,kb[Da+10]=Oc.z,kb[Da+11]=Oc.w,kb[Da+12]=Kd.x,kb[Da+13]=Kd.y,kb[Da+14]=Kd.z,kb[Da+15]=Kd.w,Da+=16;0<Da&&(k.bindBuffer(k.ARRAY_BUFFER,Xa.yh),k.bufferData(k.ARRAY_BUFFER,kb,nc),k.bindBuffer(k.ARRAY_BUFFER,Xa.zh),k.bufferData(k.ARRAY_BUFFER,lb,nc))}if(zf&&ye){N=0;for(oa=$a.length;N<oa;N++)wc=(pa=Lb[$a[N]]).C,Zd=pa.color,3===wc.length&&ye===c.eg?(Gc=wc[0],Hc=wc[1],Ic=wc[2]):Ic=Hc=Gc=Zd,Eb[wb]=Gc.r,Eb[wb+1]=Gc.v,Eb[wb+2]=Gc.b,Eb[wb+3]=Hc.r,Eb[wb+4]=Hc.v,Eb[wb+5]=Hc.b,Eb[wb+6]=Ic.r,Eb[wb+
7]=Ic.v,Eb[wb+8]=Ic.b,wb+=9;N=0;for(oa=ab.length;N<oa;N++)wc=(pa=Lb[ab[N]]).C,Zd=pa.color,4===wc.length&&ye===c.eg?(Gc=wc[0],Hc=wc[1],Ic=wc[2],Id=wc[3]):Id=Ic=Hc=Gc=Zd,Eb[wb]=Gc.r,Eb[wb+1]=Gc.v,Eb[wb+2]=Gc.b,Eb[wb+3]=Hc.r,Eb[wb+4]=Hc.v,Eb[wb+5]=Hc.b,Eb[wb+6]=Ic.r,Eb[wb+7]=Ic.v,Eb[wb+8]=Ic.b,Eb[wb+9]=Id.r,Eb[wb+10]=Id.v,Eb[wb+11]=Id.b,wb+=12;0<wb&&(k.bindBuffer(k.ARRAY_BUFFER,Xa.Xb),k.bufferData(k.ARRAY_BUFFER,Eb,nc))}if(yf&&dc.Hf){N=0;for(oa=$a.length;N<oa;N++)Ac=(kd=(pa=Lb[$a[N]]).fd)[0],Bc=kd[1],
Cc=kd[2],jb[hb]=Ac.x,jb[hb+1]=Ac.y,jb[hb+2]=Ac.z,jb[hb+3]=Ac.w,jb[hb+4]=Bc.x,jb[hb+5]=Bc.y,jb[hb+6]=Bc.z,jb[hb+7]=Bc.w,jb[hb+8]=Cc.x,jb[hb+9]=Cc.y,jb[hb+10]=Cc.z,jb[hb+11]=Cc.w,hb+=12;N=0;for(oa=ab.length;N<oa;N++)Ac=(kd=(pa=Lb[ab[N]]).fd)[0],Bc=kd[1],Cc=kd[2],Gd=kd[3],jb[hb]=Ac.x,jb[hb+1]=Ac.y,jb[hb+2]=Ac.z,jb[hb+3]=Ac.w,jb[hb+4]=Bc.x,jb[hb+5]=Bc.y,jb[hb+6]=Bc.z,jb[hb+7]=Bc.w,jb[hb+8]=Cc.x,jb[hb+9]=Cc.y,jb[hb+10]=Cc.z,jb[hb+11]=Cc.w,jb[hb+12]=Gd.x,jb[hb+13]=Gd.y,jb[hb+14]=Gd.z,jb[hb+15]=Gd.w,hb+=
16;k.bindBuffer(k.ARRAY_BUFFER,Xa.Ah);k.bufferData(k.ARRAY_BUFFER,jb,nc)}if(xf&&Se){N=0;for(oa=$a.length;N<oa;N++)if(yd=(pa=Lb[$a[N]]).M,$c=pa.u,3===yd.length&&Yd)for(cb=0;3>cb;cb++)ad=yd[cb],oc[bc]=ad.x,oc[bc+1]=ad.y,oc[bc+2]=ad.z,bc+=3;else for(cb=0;3>cb;cb++)oc[bc]=$c.x,oc[bc+1]=$c.y,oc[bc+2]=$c.z,bc+=3;N=0;for(oa=ab.length;N<oa;N++)if(yd=(pa=Lb[ab[N]]).M,$c=pa.u,4===yd.length&&Yd)for(cb=0;4>cb;cb++)ad=yd[cb],oc[bc]=ad.x,oc[bc+1]=ad.y,oc[bc+2]=ad.z,bc+=3;else for(cb=0;4>cb;cb++)oc[bc]=$c.x,oc[bc+
1]=$c.y,oc[bc+2]=$c.z,bc+=3;k.bindBuffer(k.ARRAY_BUFFER,Xa.nd);k.bufferData(k.ARRAY_BUFFER,oc,nc)}if(We&&Ce&&Te){N=0;for(oa=$a.length;N<oa;N++)if(void 0!==($d=Ce[$a[N]]))for(cb=0;3>cb;cb++)zd=$d[cb],Ld[md]=zd.x,Ld[md+1]=zd.y,md+=2;N=0;for(oa=ab.length;N<oa;N++)if(void 0!==($d=Ce[ab[N]]))for(cb=0;4>cb;cb++)zd=$d[cb],Ld[md]=zd.x,Ld[md+1]=zd.y,md+=2;0<md&&(k.bindBuffer(k.ARRAY_BUFFER,Xa.Ch),k.bufferData(k.ARRAY_BUFFER,Ld,nc))}if(We&&De&&Te){N=0;for(oa=$a.length;N<oa;N++)if(void 0!==(ae=De[$a[N]]))for(cb=
0;3>cb;cb++)Ad=ae[cb],Md[nd]=Ad.x,Md[nd+1]=Ad.y,nd+=2;N=0;for(oa=ab.length;N<oa;N++)if(void 0!==(ae=De[ab[N]]))for(cb=0;4>cb;cb++)Ad=ae[cb],Md[nd]=Ad.x,Md[nd+1]=Ad.y,nd+=2;0<nd&&(k.bindBuffer(k.ARRAY_BUFFER,Xa.Bh),k.bufferData(k.ARRAY_BUFFER,Md,nc))}if(wf){N=0;for(oa=$a.length;N<oa;N++)Pc[xc]=vb,Pc[xc+1]=vb+1,Pc[xc+2]=vb+2,xc+=3,jc[cc]=vb,jc[cc+1]=vb+1,jc[cc+2]=vb,jc[cc+3]=vb+2,jc[cc+4]=vb+1,jc[cc+5]=vb+2,cc+=6,vb+=3;N=0;for(oa=ab.length;N<oa;N++)Pc[xc]=vb,Pc[xc+1]=vb+1,Pc[xc+2]=vb+3,Pc[xc+3]=vb+
1,Pc[xc+4]=vb+2,Pc[xc+5]=vb+3,xc+=6,jc[cc]=vb,jc[cc+1]=vb+1,jc[cc+2]=vb,jc[cc+3]=vb+3,jc[cc+4]=vb+1,jc[cc+5]=vb+2,jc[cc+6]=vb+2,jc[cc+7]=vb+3,cc+=8,vb+=4;k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,Xa.vh);k.bufferData(k.ELEMENT_ARRAY_BUFFER,Pc,nc);k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,Xa.wh);k.bufferData(k.ELEMENT_ARRAY_BUFFER,jc,nc)}if(Be)for(cb=0,Ue=Be.length;cb<Ue;cb++)if((B=Be[cb]).kp.ia){if(E=0,1===B.size)if(void 0===B.Ha||"vertices"===B.Ha){N=0;for(oa=$a.length;N<oa;N++)pa=Lb[$a[N]],B.h[E]=B.value[pa.a],
B.h[E+1]=B.value[pa.b],B.h[E+2]=B.value[pa.c],E+=3;N=0;for(oa=ab.length;N<oa;N++)pa=Lb[ab[N]],B.h[E]=B.value[pa.a],B.h[E+1]=B.value[pa.b],B.h[E+2]=B.value[pa.c],B.h[E+3]=B.value[pa.d],E+=4}else{if("faces"===B.Ha){N=0;for(oa=$a.length;N<oa;N++)ib=B.value[$a[N]],B.h[E]=ib,B.h[E+1]=ib,B.h[E+2]=ib,E+=3;N=0;for(oa=ab.length;N<oa;N++)ib=B.value[ab[N]],B.h[E]=ib,B.h[E+1]=ib,B.h[E+2]=ib,B.h[E+3]=ib,E+=4}}else if(2===B.size)if(void 0===B.Ha||"vertices"===B.Ha){N=0;for(oa=$a.length;N<oa;N++)pa=Lb[$a[N]],ka=
B.value[pa.a],la=B.value[pa.b],ma=B.value[pa.c],B.h[E]=ka.x,B.h[E+1]=ka.y,B.h[E+2]=la.x,B.h[E+3]=la.y,B.h[E+4]=ma.x,B.h[E+5]=ma.y,E+=6;N=0;for(oa=ab.length;N<oa;N++)pa=Lb[ab[N]],ka=B.value[pa.a],la=B.value[pa.b],ma=B.value[pa.c],Wa=B.value[pa.d],B.h[E]=ka.x,B.h[E+1]=ka.y,B.h[E+2]=la.x,B.h[E+3]=la.y,B.h[E+4]=ma.x,B.h[E+5]=ma.y,B.h[E+6]=Wa.x,B.h[E+7]=Wa.y,E+=8}else{if("faces"===B.Ha){N=0;for(oa=$a.length;N<oa;N++)ma=la=ka=ib=B.value[$a[N]],B.h[E]=ka.x,B.h[E+1]=ka.y,B.h[E+2]=la.x,B.h[E+3]=la.y,B.h[E+
4]=ma.x,B.h[E+5]=ma.y,E+=6;N=0;for(oa=ab.length;N<oa;N++)Wa=ma=la=ka=ib=B.value[ab[N]],B.h[E]=ka.x,B.h[E+1]=ka.y,B.h[E+2]=la.x,B.h[E+3]=la.y,B.h[E+4]=ma.x,B.h[E+5]=ma.y,B.h[E+6]=Wa.x,B.h[E+7]=Wa.y,E+=8}}else if(3===B.size){var ya;if(ya="c"===B.type?["r","g","b"]:["x","y","z"],void 0===B.Ha||"vertices"===B.Ha){N=0;for(oa=$a.length;N<oa;N++)pa=Lb[$a[N]],ka=B.value[pa.a],la=B.value[pa.b],ma=B.value[pa.c],B.h[E]=ka[ya[0]],B.h[E+1]=ka[ya[1]],B.h[E+2]=ka[ya[2]],B.h[E+3]=la[ya[0]],B.h[E+4]=la[ya[1]],B.h[E+
5]=la[ya[2]],B.h[E+6]=ma[ya[0]],B.h[E+7]=ma[ya[1]],B.h[E+8]=ma[ya[2]],E+=9;N=0;for(oa=ab.length;N<oa;N++)pa=Lb[ab[N]],ka=B.value[pa.a],la=B.value[pa.b],ma=B.value[pa.c],Wa=B.value[pa.d],B.h[E]=ka[ya[0]],B.h[E+1]=ka[ya[1]],B.h[E+2]=ka[ya[2]],B.h[E+3]=la[ya[0]],B.h[E+4]=la[ya[1]],B.h[E+5]=la[ya[2]],B.h[E+6]=ma[ya[0]],B.h[E+7]=ma[ya[1]],B.h[E+8]=ma[ya[2]],B.h[E+9]=Wa[ya[0]],B.h[E+10]=Wa[ya[1]],B.h[E+11]=Wa[ya[2]],E+=12}else if("faces"===B.Ha){N=0;for(oa=$a.length;N<oa;N++)ma=la=ka=ib=B.value[$a[N]],
B.h[E]=ka[ya[0]],B.h[E+1]=ka[ya[1]],B.h[E+2]=ka[ya[2]],B.h[E+3]=la[ya[0]],B.h[E+4]=la[ya[1]],B.h[E+5]=la[ya[2]],B.h[E+6]=ma[ya[0]],B.h[E+7]=ma[ya[1]],B.h[E+8]=ma[ya[2]],E+=9;N=0;for(oa=ab.length;N<oa;N++)Wa=ma=la=ka=ib=B.value[ab[N]],B.h[E]=ka[ya[0]],B.h[E+1]=ka[ya[1]],B.h[E+2]=ka[ya[2]],B.h[E+3]=la[ya[0]],B.h[E+4]=la[ya[1]],B.h[E+5]=la[ya[2]],B.h[E+6]=ma[ya[0]],B.h[E+7]=ma[ya[1]],B.h[E+8]=ma[ya[2]],B.h[E+9]=Wa[ya[0]],B.h[E+10]=Wa[ya[1]],B.h[E+11]=Wa[ya[2]],E+=12}else if("faceVertices"===B.Ha){N=
0;for(oa=$a.length;N<oa;N++)ka=(ib=B.value[$a[N]])[0],la=ib[1],ma=ib[2],B.h[E]=ka[ya[0]],B.h[E+1]=ka[ya[1]],B.h[E+2]=ka[ya[2]],B.h[E+3]=la[ya[0]],B.h[E+4]=la[ya[1]],B.h[E+5]=la[ya[2]],B.h[E+6]=ma[ya[0]],B.h[E+7]=ma[ya[1]],B.h[E+8]=ma[ya[2]],E+=9;N=0;for(oa=ab.length;N<oa;N++)ka=(ib=B.value[ab[N]])[0],la=ib[1],ma=ib[2],Wa=ib[3],B.h[E]=ka[ya[0]],B.h[E+1]=ka[ya[1]],B.h[E+2]=ka[ya[2]],B.h[E+3]=la[ya[0]],B.h[E+4]=la[ya[1]],B.h[E+5]=la[ya[2]],B.h[E+6]=ma[ya[0]],B.h[E+7]=ma[ya[1]],B.h[E+8]=ma[ya[2]],B.h[E+
9]=Wa[ya[0]],B.h[E+10]=Wa[ya[1]],B.h[E+11]=Wa[ya[2]],E+=12}}else if(4===B.size)if(void 0===B.Ha||"vertices"===B.Ha){N=0;for(oa=$a.length;N<oa;N++)pa=Lb[$a[N]],ka=B.value[pa.a],la=B.value[pa.b],ma=B.value[pa.c],B.h[E]=ka.x,B.h[E+1]=ka.y,B.h[E+2]=ka.z,B.h[E+3]=ka.w,B.h[E+4]=la.x,B.h[E+5]=la.y,B.h[E+6]=la.z,B.h[E+7]=la.w,B.h[E+8]=ma.x,B.h[E+9]=ma.y,B.h[E+10]=ma.z,B.h[E+11]=ma.w,E+=12;N=0;for(oa=ab.length;N<oa;N++)pa=Lb[ab[N]],ka=B.value[pa.a],la=B.value[pa.b],ma=B.value[pa.c],Wa=B.value[pa.d],B.h[E]=
ka.x,B.h[E+1]=ka.y,B.h[E+2]=ka.z,B.h[E+3]=ka.w,B.h[E+4]=la.x,B.h[E+5]=la.y,B.h[E+6]=la.z,B.h[E+7]=la.w,B.h[E+8]=ma.x,B.h[E+9]=ma.y,B.h[E+10]=ma.z,B.h[E+11]=ma.w,B.h[E+12]=Wa.x,B.h[E+13]=Wa.y,B.h[E+14]=Wa.z,B.h[E+15]=Wa.w,E+=16}else if("faces"===B.Ha){N=0;for(oa=$a.length;N<oa;N++)ma=la=ka=ib=B.value[$a[N]],B.h[E]=ka.x,B.h[E+1]=ka.y,B.h[E+2]=ka.z,B.h[E+3]=ka.w,B.h[E+4]=la.x,B.h[E+5]=la.y,B.h[E+6]=la.z,B.h[E+7]=la.w,B.h[E+8]=ma.x,B.h[E+9]=ma.y,B.h[E+10]=ma.z,B.h[E+11]=ma.w,E+=12;N=0;for(oa=ab.length;N<
oa;N++)Wa=ma=la=ka=ib=B.value[ab[N]],B.h[E]=ka.x,B.h[E+1]=ka.y,B.h[E+2]=ka.z,B.h[E+3]=ka.w,B.h[E+4]=la.x,B.h[E+5]=la.y,B.h[E+6]=la.z,B.h[E+7]=la.w,B.h[E+8]=ma.x,B.h[E+9]=ma.y,B.h[E+10]=ma.z,B.h[E+11]=ma.w,B.h[E+12]=Wa.x,B.h[E+13]=Wa.y,B.h[E+14]=Wa.z,B.h[E+15]=Wa.w,E+=16}else if("faceVertices"===B.Ha){N=0;for(oa=$a.length;N<oa;N++)ka=(ib=B.value[$a[N]])[0],la=ib[1],ma=ib[2],B.h[E]=ka.x,B.h[E+1]=ka.y,B.h[E+2]=ka.z,B.h[E+3]=ka.w,B.h[E+4]=la.x,B.h[E+5]=la.y,B.h[E+6]=la.z,B.h[E+7]=la.w,B.h[E+8]=ma.x,B.h[E+
9]=ma.y,B.h[E+10]=ma.z,B.h[E+11]=ma.w,E+=12;N=0;for(oa=ab.length;N<oa;N++)ka=(ib=B.value[ab[N]])[0],la=ib[1],ma=ib[2],Wa=ib[3],B.h[E]=ka.x,B.h[E+1]=ka.y,B.h[E+2]=ka.z,B.h[E+3]=ka.w,B.h[E+4]=la.x,B.h[E+5]=la.y,B.h[E+6]=la.z,B.h[E+7]=la.w,B.h[E+8]=ma.x,B.h[E+9]=ma.y,B.h[E+10]=ma.z,B.h[E+11]=ma.w,B.h[E+12]=Wa.x,B.h[E+13]=Wa.y,B.h[E+14]=Wa.z,B.h[E+15]=Wa.w,E+=16}k.bindBuffer(k.ARRAY_BUFFER,B.buffer);k.bufferData(k.ARRAY_BUFFER,B.h,nc)}vf&&(delete Xa.Ml,delete Xa.Ld,delete Xa.th,delete Xa.Sl,delete Xa.Ul,
delete Xa.Tl,delete Xa.Ll,delete Xa.Md,delete Xa.Nl,delete Xa.Ql,delete Xa.Rl)}}ia.na=!1;ia.vk=!1;ia.Ae=!1;ia.cf=!1;ia.ac=!1;ia.za=!1;ia.ie=!1;ia.dm=!1;Sb.attributes&&O(Sb)}else if(Wb instanceof c.Jd){if(Zc=(Sb=q(Wb,ia)).attributes&&Q(Sb),ia.na||ia.za||ia.ac||Zc){var pc=ia,ce=k.DYNAMIC_DRAW,Nd=void 0,Od=void 0,Pd=void 0,de=void 0,tb=void 0,ee=void 0,fe=void 0,ge=void 0,Xe=void 0,Ib=void 0,Cd=void 0,mb=void 0,ec=void 0,Ye=pc.l,Ze=pc.Za,$e=pc.Ne,Bf=Ye.length,Cf=Ze.length,Df=$e.length,he=pc.Md,ie=pc.Ld,
je=pc.th,Ef=pc.za,Ff=pc.ac,Ee=pc.xb;if(pc.na){for(Nd=0;Nd<Bf;Nd++)de=Ye[Nd],he[tb=3*Nd]=de.x,he[tb+1]=de.y,he[tb+2]=de.z;k.bindBuffer(k.ARRAY_BUFFER,pc.Wa);k.bufferData(k.ARRAY_BUFFER,he,ce)}if(Ef){for(Od=0;Od<Cf;Od++)ee=Ze[Od],ie[tb=3*Od]=ee.r,ie[tb+1]=ee.v,ie[tb+2]=ee.b;k.bindBuffer(k.ARRAY_BUFFER,pc.Xb);k.bufferData(k.ARRAY_BUFFER,ie,ce)}if(Ff){for(Pd=0;Pd<Df;Pd++)fe=$e[Pd],je[tb=3*Pd]=fe.x,je[tb+1]=fe.y,je[tb+2]=fe.z;k.bindBuffer(k.ARRAY_BUFFER,pc.nd);k.bufferData(k.ARRAY_BUFFER,je,ce)}if(Ee)for(ge=
0,Xe=Ee.length;ge<Xe;ge++)if((mb=Ee[ge]).ia&&(void 0===mb.Ha||"vertices"===mb.Ha)){if(tb=0,Cd=mb.value.length,1===mb.size)for(Ib=0;Ib<Cd;Ib++)mb.h[Ib]=mb.value[Ib];else if(2===mb.size)for(Ib=0;Ib<Cd;Ib++)ec=mb.value[Ib],mb.h[tb]=ec.x,mb.h[tb+1]=ec.y,tb+=2;else if(3===mb.size)if("c"===mb.type)for(Ib=0;Ib<Cd;Ib++)ec=mb.value[Ib],mb.h[tb]=ec.r,mb.h[tb+1]=ec.v,mb.h[tb+2]=ec.b,tb+=3;else for(Ib=0;Ib<Cd;Ib++)ec=mb.value[Ib],mb.h[tb]=ec.x,mb.h[tb+1]=ec.y,mb.h[tb+2]=ec.z,tb+=3;else if(4===mb.size)for(Ib=
0;Ib<Cd;Ib++)ec=mb.value[Ib],mb.h[tb]=ec.x,mb.h[tb+1]=ec.y,mb.h[tb+2]=ec.z,mb.h[tb+3]=ec.w,tb+=4;k.bindBuffer(k.ARRAY_BUFFER,mb.buffer);k.bufferData(k.ARRAY_BUFFER,mb.h,ce)}}ia.na=!1;ia.za=!1;ia.ac=!1;Sb.attributes&&O(Sb)}else if(Wb instanceof c.Ga)if(ia instanceof c.hc)(ia.na||ia.za)&&w(ia,k.DYNAMIC_DRAW,!ia.wg),ia.na=!1,ia.za=!1;else{if(Zc=(Sb=q(Wb,ia)).attributes&&Q(Sb),ia.na||ia.za||ia.ji||Zc){var qc=ia,ke=k.DYNAMIC_DRAW,Qd=void 0,Rd=void 0,Sd=void 0,le=void 0,Bb=void 0,me=void 0,af=qc.l,bf=qc.Za,
cf=qc.Im,Gf=af.length,Hf=bf.length,If=cf.length,ne=qc.Md,oe=qc.Ld,df=qc.ip,Jf=qc.za,Kf=qc.ji,Fe=qc.xb,pe=void 0,ef=void 0,Jb=void 0,Dd=void 0,fc=void 0,nb=void 0;if(qc.na){for(Qd=0;Qd<Gf;Qd++)le=af[Qd],ne[Bb=3*Qd]=le.x,ne[Bb+1]=le.y,ne[Bb+2]=le.z;k.bindBuffer(k.ARRAY_BUFFER,qc.Wa);k.bufferData(k.ARRAY_BUFFER,ne,ke)}if(Jf){for(Rd=0;Rd<Hf;Rd++)me=bf[Rd],oe[Bb=3*Rd]=me.r,oe[Bb+1]=me.v,oe[Bb+2]=me.b;k.bindBuffer(k.ARRAY_BUFFER,qc.Xb);k.bufferData(k.ARRAY_BUFFER,oe,ke)}if(Kf){for(Sd=0;Sd<If;Sd++)df[Sd]=
cf[Sd];k.bindBuffer(k.ARRAY_BUFFER,qc.xh);k.bufferData(k.ARRAY_BUFFER,df,ke)}if(Fe)for(pe=0,ef=Fe.length;pe<ef;pe++)if((nb=Fe[pe]).ia&&(void 0===nb.Ha||"vertices"===nb.Ha)){if(Bb=0,Dd=nb.value.length,1===nb.size)for(Jb=0;Jb<Dd;Jb++)nb.h[Jb]=nb.value[Jb];else if(2===nb.size)for(Jb=0;Jb<Dd;Jb++)fc=nb.value[Jb],nb.h[Bb]=fc.x,nb.h[Bb+1]=fc.y,Bb+=2;else if(3===nb.size)if("c"===nb.type)for(Jb=0;Jb<Dd;Jb++)fc=nb.value[Jb],nb.h[Bb]=fc.r,nb.h[Bb+1]=fc.v,nb.h[Bb+2]=fc.b,Bb+=3;else for(Jb=0;Jb<Dd;Jb++)fc=nb.value[Jb],
nb.h[Bb]=fc.x,nb.h[Bb+1]=fc.y,nb.h[Bb+2]=fc.z,Bb+=3;else if(4===nb.size)for(Jb=0;Jb<Dd;Jb++)fc=nb.value[Jb],nb.h[Bb]=fc.x,nb.h[Bb+1]=fc.y,nb.h[Bb+2]=fc.z,nb.h[Bb+3]=fc.w,Bb+=4;k.bindBuffer(k.ARRAY_BUFFER,nb.buffer);k.bufferData(k.ARRAY_BUFFER,nb.h,ke)}}ia.na=!1;ia.za=!1;ia.ji=!1;Sb.attributes&&O(Sb)}else if(Wb instanceof c.Tb)if(ia instanceof c.hc)(ia.na||ia.za)&&w(ia,k.DYNAMIC_DRAW,!ia.wg),ia.na=!1,ia.za=!1;else{if(Zc=(Sb=q(Wb,ia)).attributes&&Q(Sb),ia.na||ia.za||Wb.Ze||Zc){var Qc=ia,Ge=k.DYNAMIC_DRAW,
Td=Wb,gc=void 0,Rc=void 0,Sc=void 0,Na=void 0,Tc=void 0,dd=void 0,qe=Qc.l,He=qe.length,Ie=Qc.Za,ff=Ie.length,qd=Qc.Md,rd=Qc.Ld,Xc=Qc.mp,gf=Qc.na,hf=Qc.za,Yc=Qc.xb,rc=void 0,Ed=void 0,Va=void 0,sc=void 0,db=void 0,Ea=void 0;if(Td.Ze){$b.i(gd);$b.multiply(Td.K);for(gc=0;gc<He;gc++)Sc=qe[gc],gb.i(Sc),gb.Sc($b),Xc[gc]=[gb.z,gc];Xc.sort(C);for(gc=0;gc<He;gc++)Sc=qe[Xc[gc][1]],qd[Na=3*gc]=Sc.x,qd[Na+1]=Sc.y,qd[Na+2]=Sc.z;for(Rc=0;Rc<ff;Rc++)Na=3*Rc,dd=Ie[Xc[Rc][1]],rd[Na]=dd.r,rd[Na+1]=dd.v,rd[Na+2]=dd.b;
if(Yc)for(rc=0,Ed=Yc.length;rc<Ed;rc++)if(void 0===(Ea=Yc[rc]).Ha||"vertices"===Ea.Ha)if(Na=0,sc=Ea.value.length,1===Ea.size)for(Va=0;Va<sc;Va++)Tc=Xc[Va][1],Ea.h[Va]=Ea.value[Tc];else if(2===Ea.size)for(Va=0;Va<sc;Va++)Tc=Xc[Va][1],db=Ea.value[Tc],Ea.h[Na]=db.x,Ea.h[Na+1]=db.y,Na+=2;else if(3===Ea.size)if("c"===Ea.type)for(Va=0;Va<sc;Va++)Tc=Xc[Va][1],db=Ea.value[Tc],Ea.h[Na]=db.r,Ea.h[Na+1]=db.v,Ea.h[Na+2]=db.b,Na+=3;else for(Va=0;Va<sc;Va++)Tc=Xc[Va][1],db=Ea.value[Tc],Ea.h[Na]=db.x,Ea.h[Na+1]=
db.y,Ea.h[Na+2]=db.z,Na+=3;else if(4===Ea.size)for(Va=0;Va<sc;Va++)Tc=Xc[Va][1],db=Ea.value[Tc],Ea.h[Na]=db.x,Ea.h[Na+1]=db.y,Ea.h[Na+2]=db.z,Ea.h[Na+3]=db.w,Na+=4}else{if(gf)for(gc=0;gc<He;gc++)Sc=qe[gc],qd[Na=3*gc]=Sc.x,qd[Na+1]=Sc.y,qd[Na+2]=Sc.z;if(hf)for(Rc=0;Rc<ff;Rc++)dd=Ie[Rc],rd[Na=3*Rc]=dd.r,rd[Na+1]=dd.v,rd[Na+2]=dd.b;if(Yc)for(rc=0,Ed=Yc.length;rc<Ed;rc++)if((Ea=Yc[rc]).ia&&(void 0===Ea.Ha||"vertices"===Ea.Ha))if(sc=Ea.value.length,Na=0,1===Ea.size)for(Va=0;Va<sc;Va++)Ea.h[Va]=Ea.value[Va];
else if(2===Ea.size)for(Va=0;Va<sc;Va++)db=Ea.value[Va],Ea.h[Na]=db.x,Ea.h[Na+1]=db.y,Na+=2;else if(3===Ea.size)if("c"===Ea.type)for(Va=0;Va<sc;Va++)db=Ea.value[Va],Ea.h[Na]=db.r,Ea.h[Na+1]=db.v,Ea.h[Na+2]=db.b,Na+=3;else for(Va=0;Va<sc;Va++)db=Ea.value[Va],Ea.h[Na]=db.x,Ea.h[Na+1]=db.y,Ea.h[Na+2]=db.z,Na+=3;else if(4===Ea.size)for(Va=0;Va<sc;Va++)db=Ea.value[Va],Ea.h[Na]=db.x,Ea.h[Na+1]=db.y,Ea.h[Na+2]=db.z,Ea.h[Na+3]=db.w,Na+=4}if((gf||Td.Ze)&&(k.bindBuffer(k.ARRAY_BUFFER,Qc.Wa),k.bufferData(k.ARRAY_BUFFER,
qd,Ge)),(hf||Td.Ze)&&(k.bindBuffer(k.ARRAY_BUFFER,Qc.Xb),k.bufferData(k.ARRAY_BUFFER,rd,Ge)),Yc)for(rc=0,Ed=Yc.length;rc<Ed;rc++)((Ea=Yc[rc]).ia||Td.Ze)&&(k.bindBuffer(k.ARRAY_BUFFER,Ea.buffer),k.bufferData(k.ARRAY_BUFFER,Ea.h,Ge))}ia.na=!1;ia.za=!1;Sb.attributes&&O(Sb)}}};this.Oq=function(l,z,v,x){var F,H,M,P,D,J,Y,xa;if(l.addEventListener("dispose",d),l instanceof c.pe?D="depth":l instanceof c.qe?D="normal":l instanceof c.Qa?D="basic":l instanceof c.Ac?D="lambert":l instanceof c.jc?D="phong":l instanceof
c.Kb?D="basic":l instanceof c.Id?D="dashed":l instanceof c.re&&(D="particle_basic"),D){var Aa=c.dg[D];l.V=c.nc.clone(Aa.V);l.T=Aa.T;l.S=Aa.S}var Za=H=Y=xa=Aa=0;for(F=z.length;Za<F;Za++)(J=z[Za]).ui||(J instanceof c.zc&&H++,J instanceof c.mf&&Y++,J instanceof c.nf&&xa++,J instanceof c.Yi&&Aa++);Za=H;F=Y;H=xa;var ea=Aa;Aa=J=0;for(xa=z.length;Aa<xa;Aa++)(Y=z[Aa]).qc&&(Y instanceof c.nf&&J++,Y instanceof c.zc&&!Y.Pk&&J++);var na=J;mc&&x&&x.Cd?P=1024:(z=k.getParameter(k.MAX_VERTEX_UNIFORM_VECTORS),z=Math.floor((z-
20)/4),void 0!==x&&x instanceof c.lc&&(z=Math.min(x.Na.length,z))<x.Na.length&&console.warn("WebGLRenderer: too many bones - "+x.Na.length+", this GPU supports just "+z+" (try OpenGL instead of ANGLE)"),P=z);a:{Y=l.S;xa=l.T;Aa=l.V;z=l.attributes;J=l.Uj;var X,ra;v={map:!!l.map,ma:!!l.ma,Ja:!!l.Ja,zb:!!l.zb,ab:!!l.ab,Fa:!!l.Fa,C:l.C,J:v,$n:l.J,wq:v instanceof c.ff,Hb:l.Hb,Aa:l.Aa,tr:P,Cd:mc&&x&&x.Cd,xf:x&&x.xf,wf:x&&x.wf,L:l.L,ja:l.ja,Hg:this.Hg,ni:this.ni,Rm:Za,Tm:F,Vm:H,Sm:ea,Um:na,Xe:this.Xe&&x.Nf,
Ug:this.Ug,Ki:this.Ki,Ji:this.Ji,pd:l.pd,Ig:l.Ig,Lf:l.Lf,Oc:l.Oc,Yj:l.Ad===c.Ed,ck:l.Ad===c.df};x=[];for(X in D?x.push(D):(x.push(Y),x.push(xa)),J)x.push(X),x.push(J[X]);for(ja in v)x.push(ja),x.push(v[ja]);D=x.join();var ja=0;for(X=qa.length;ja<X;ja++)if((x=qa[ja]).code===D){x.Vk++;var ua=x.mb;break a}for(ra in ja="SHADOWMAP_TYPE_BASIC",v.Ug===c.ol?ja="SHADOWMAP_TYPE_PCF":v.Ug===c.pl&&(ja="SHADOWMAP_TYPE_PCF_SOFT"),X=[],J)!1!==(x=J[ra])&&(x="#define "+ra+" "+x,X.push(x));for(va in x=X.join("\n"),
ra=k.createProgram(),X=["precision "+Ra+" float;",x,uc?"#define VERTEX_TEXTURES":"",W.Wc?"#define GAMMA_INPUT":"",W.rm?"#define GAMMA_OUTPUT":"",W.cn?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+v.Rm,"#define MAX_POINT_LIGHTS "+v.Tm,"#define MAX_SPOT_LIGHTS "+v.Vm,"#define MAX_HEMI_LIGHTS "+v.Sm,"#define MAX_SHADOWS "+v.Um,"#define MAX_BONES "+v.tr,v.map?"#define USE_MAP":"",v.ma?"#define USE_ENVMAP":"",v.Ja?"#define USE_LIGHTMAP":"",v.zb?"#define USE_BUMPMAP":"",v.ab?"#define USE_NORMALMAP":
"",v.Fa?"#define USE_SPECULARMAP":"",v.C?"#define USE_COLOR":"",v.Aa?"#define USE_SKINNING":"",v.Cd?"#define BONE_TEXTURE":"",v.xf?"#define N_BONE_PIXEL_X "+v.xf.toFixed(1):"",v.wf?"#define N_BONE_PIXEL_Y "+v.wf.toFixed(1):"",v.L?"#define USE_MORPHTARGETS":"",v.ja?"#define USE_MORPHNORMALS":"",v.Lf?"#define PHONG_PER_PIXEL":"",v.Oc?"#define WRAP_AROUND":"",v.Yj?"#define DOUBLE_SIDED":"",v.ck?"#define FLIP_SIDED":"",v.Xe?"#define USE_SHADOWMAP":"",v.Xe?"#define "+ja:"",v.Ki?"#define SHADOWMAP_DEBUG":
"",v.Ji?"#define SHADOWMAP_CASCADE":"",v.Hb?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n"),
ja=Ba("fragment",(ja=["precision "+Ra+" float;",v.zb||v.ab?"#extension GL_OES_standard_derivatives : enable":"",x,"#define MAX_DIR_LIGHTS "+v.Rm,"#define MAX_POINT_LIGHTS "+v.Tm,"#define MAX_SPOT_LIGHTS "+v.Vm,"#define MAX_HEMI_LIGHTS "+v.Sm,"#define MAX_SHADOWS "+v.Um,v.pd?"#define ALPHATEST "+v.pd:"",W.Wc?"#define GAMMA_INPUT":"",W.rm?"#define GAMMA_OUTPUT":"",W.cn?"#define PHYSICALLY_BASED_SHADING":"",v.$n&&v.J?"#define USE_FOG":"",v.$n&&v.wq?"#define FOG_EXP2":"",v.map?"#define USE_MAP":"",v.ma?
"#define USE_ENVMAP":"",v.Ja?"#define USE_LIGHTMAP":"",v.zb?"#define USE_BUMPMAP":"",v.ab?"#define USE_NORMALMAP":"",v.Fa?"#define USE_SPECULARMAP":"",v.C?"#define USE_COLOR":"",v.Ig?"#define METAL":"",v.Lf?"#define PHONG_PER_PIXEL":"",v.Oc?"#define WRAP_AROUND":"",v.Yj?"#define DOUBLE_SIDED":"",v.ck?"#define FLIP_SIDED":"",v.Xe?"#define USE_SHADOWMAP":"",v.Xe?"#define "+ja:"",v.Ki?"#define SHADOWMAP_DEBUG":"",v.Ji?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n"))+
Y),X=Ba("vertex",X+xa),k.attachShader(ra,X),k.attachShader(ra,ja),k.linkProgram(ra),k.getProgramParameter(ra,k.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+k.getProgramParameter(ra,k.VALIDATE_STATUS)+", gl error ["+k.getError()+"]"),k.deleteShader(ja),k.deleteShader(X),ra.V={},ra.attributes={},ja="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences".split(" "),v.Cd?ja.push("boneTexture"):ja.push("boneGlobalMatrices"),
Aa)ja.push(va);var va=ja;ja=0;for(X=va.length;ja<X;ja++)Aa=va[ja],ra.V[Aa]=k.getUniformLocation(ra,Aa);ja="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");for(va=0;va<v.Hg;va++)ja.push("morphTarget"+va);for(va=0;va<v.ni;va++)ja.push("morphNormal"+va);for(ua in z)ja.push(ua);va=0;for(z=(ua=ja).length;va<z;va++)ja=ua[va],ra.attributes[ja]=k.getAttribLocation(ra,ja);ra.id=T++;qa.push({mb:ra,code:D,Vk:1});W.info.memory.en=qa.length;ua=ra}if(l.mb=ua,va=l.mb.attributes,
l.L)for(l.Jg=0,z="morphTarget",ua=0;ua<this.Hg;ua++)0<=va[z+ua]&&l.Jg++;if(l.ja)for(l.$m=0,z="morphNormal",ua=0;ua<this.ni;ua++)0<=va[z+ua]&&l.$m++;for(M in l.Xn=[],l.V)l.Xn.push([l.V[M],M])};this.Jk=function(l){var z=l.Ad===c.Ed;l=l.Ad===c.df;Tb!==z&&(z?k.disable(k.CULL_FACE):k.enable(k.CULL_FACE),Tb=z);Nb!==l&&(l?k.frontFace(k.CW):k.frontFace(k.CCW),Nb=l)};this.Ve=function(l){fb!==l&&(l?k.enable(k.DEPTH_TEST):k.disable(k.DEPTH_TEST),fb=l)};this.Og=function(l){eb!==l&&(k.depthMask(l),eb=l)};this.Of=
function(l,z,v,x){l!==kc&&(l===c.ml?k.disable(k.BLEND):l===c.Yk?(k.enable(k.BLEND),k.blendEquation(k.FUNC_ADD),k.blendFunc(k.SRC_ALPHA,k.ONE)):l===c.Fl?(k.enable(k.BLEND),k.blendEquation(k.FUNC_ADD),k.blendFunc(k.ZERO,k.ONE_MINUS_SRC_COLOR)):l===c.Fo?(k.enable(k.BLEND),k.blendEquation(k.FUNC_ADD),k.blendFunc(k.ZERO,k.SRC_COLOR)):l===c.al?k.enable(k.BLEND):(k.enable(k.BLEND),k.blendEquationSeparate(k.FUNC_ADD,k.FUNC_ADD),k.blendFuncSeparate(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA,k.ONE,k.ONE_MINUS_SRC_ALPHA)),
kc=l);l===c.al?(z!==Vc&&(k.blendEquation(Fa(z)),Vc=z),(v!==Sa||x!==qb)&&(k.blendFunc(Fa(v),Fa(x)),Sa=v,qb=x)):qb=Sa=Vc=null};this.Pg=function(l,z){if(l.ia){l.Nd||(l.Nd=!0,l.addEventListener("dispose",f),l.Zb=k.createTexture(),W.info.memory.Ib++);k.activeTexture(k.TEXTURE0+z);k.bindTexture(k.TEXTURE_2D,l.Zb);k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,l.flipY);k.pixelStorei(k.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l.premultiplyAlpha);k.pixelStorei(k.UNPACK_ALIGNMENT,l.Uk);z=l.image;var v=0==(z.width&z.width-1)&&0==
(z.height&z.height-1),x=Fa(l.format),F=Fa(l.type);ta(k.TEXTURE_2D,l,v);var H=l.Gb;if(l instanceof c.me)if(0<H.length&&v){for(var M=0,P=H.length;M<P;M++)z=H[M],k.texImage2D(k.TEXTURE_2D,M,x,z.width,z.height,0,x,F,z.data);l.Ob=!1}else k.texImage2D(k.TEXTURE_2D,0,x,z.width,z.height,0,x,F,z.data);else if(l instanceof c.le)for(M=0,P=H.length;M<P;M++)z=H[M],k.compressedTexImage2D(k.TEXTURE_2D,M,x,z.width,z.height,0,z.data);else if(0<H.length&&v){M=0;for(P=H.length;M<P;M++)z=H[M],k.texImage2D(k.TEXTURE_2D,
M,x,x,F,z);l.Ob=!1}else k.texImage2D(k.TEXTURE_2D,0,x,x,F,l.image);l.Ob&&v&&k.generateMipmap(k.TEXTURE_2D);l.ia=!1;l.ti&&l.ti()}else k.activeTexture(k.TEXTURE0+z),k.bindTexture(k.TEXTURE_2D,l.Zb)};this.Kk=function(l){var z=l instanceof c.ve;if(l&&!l.md){void 0===l.Uc&&(l.Uc=!0);void 0===l.cd&&(l.cd=!0);l.addEventListener("dispose",e);l.Zb=k.createTexture();W.info.memory.Ib++;var v=0==(l.width&l.width-1)&&0==(l.height&l.height-1),x=Fa(l.format),F=Fa(l.type);if(z){l.md=[];l.od=[];k.bindTexture(k.TEXTURE_CUBE_MAP,
l.Zb);ta(k.TEXTURE_CUBE_MAP,l,v);for(var H=0;6>H;H++){l.md[H]=k.createFramebuffer();l.od[H]=k.createRenderbuffer();k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+H,0,x,l.width,l.height,0,x,F,null);var M=l,P=k.TEXTURE_CUBE_MAP_POSITIVE_X+H;k.bindFramebuffer(k.FRAMEBUFFER,l.md[H]);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,P,M.Zb,0);Ia(l.od[H],l)}v&&k.generateMipmap(k.TEXTURE_CUBE_MAP)}else l.md=k.createFramebuffer(),l.od=l.$g?l.$g.od:k.createRenderbuffer(),k.bindTexture(k.TEXTURE_2D,l.Zb),
ta(k.TEXTURE_2D,l,v),k.texImage2D(k.TEXTURE_2D,0,x,l.width,l.height,0,x,F,null),x=k.TEXTURE_2D,k.bindFramebuffer(k.FRAMEBUFFER,l.md),k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,x,l.Zb,0),l.$g?l.Uc&&!l.cd?k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,l.od):l.Uc&&l.cd&&k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_STENCIL_ATTACHMENT,k.RENDERBUFFER,l.od):Ia(l.od,l),v&&k.generateMipmap(k.TEXTURE_2D);z?k.bindTexture(k.TEXTURE_CUBE_MAP,null):k.bindTexture(k.TEXTURE_2D,
null);k.bindRenderbuffer(k.RENDERBUFFER,null);k.bindFramebuffer(k.FRAMEBUFFER,null)}l?(z=z?l.md[l.xp]:l.md,v=l.width,l=l.height,F=x=0):(z=null,v=yc,l=Zb,x=ed,F=fd);z!==ub&&(k.bindFramebuffer(k.FRAMEBUFFER,z),k.viewport(x,F,v,l),ub=z);Fb=v;td=l};this.rs=new c.lj;this.yp(this.rs);this.am(new c.To);this.am(new c.Ao)};
c.fg=function(a,b,d){c.Fd.call(this);this.width=a;this.height=b;d=d||{};this.ec=void 0!==d.ec?d.ec:c.Vf;this.fc=void 0!==d.fc?d.fc:c.Vf;this.Fb=void 0!==d.Fb?d.Fb:c.oe;this.kb=void 0!==d.kb?d.kb:c.fj;this.Mb=void 0!==d.Mb?d.Mb:1;this.offset=new c.o(0,0);this.repeat=new c.o(1,1);this.format=void 0!==d.format?d.format:c.bg;this.type=void 0!==d.type?d.type:c.pj;this.Uc=void 0===d.Uc||d.Uc;this.cd=void 0===d.cd||d.cd;this.Ob=!0;this.$g=null};
c.fg.prototype.clone=function(){var a=new c.fg(this.width,this.height);return a.ec=this.ec,a.fc=this.fc,a.Fb=this.Fb,a.kb=this.kb,a.Mb=this.Mb,a.offset.i(this.offset),a.repeat.i(this.repeat),a.format=this.format,a.type=this.type,a.Uc=this.Uc,a.cd=this.cd,a.Ob=this.Ob,a.$g=this.$g,a};c.ve=function(a,b){c.fg.call(this,a,b,{format:c.jj,Fb:c.oe,kb:c.oe});this.xp=0};c.ve.prototype=Object.create(c.fg.prototype);c.Vb=function(){this.Jc=new c.g;this.j=new c.oc;this.visible=!0};
c.Vb.prototype.i=function(a){this.Jc.i(a.Jc);this.j.i(a.j)};c.yl=function(){this.$=new c.Vb;this.ca=new c.Vb;this.sb=new c.Vb;this.og=new c.g;this.Me=new c.g;this.ri=new c.g;this.Ri=0;this.Dd=[new c.g,new c.g,new c.g];this.wc=[new c.g,new c.g,new c.g];this.F=this.color=null;this.bf=[[]];this.z=null};
c.zl=function(){this.$=new c.Vb;this.ca=new c.Vb;this.sb=new c.Vb;this.Wk=new c.Vb;this.og=new c.g;this.Me=new c.g;this.ri=new c.g;this.Ri=0;this.Dd=[new c.g,new c.g,new c.g,new c.g];this.wc=[new c.g,new c.g,new c.g,new c.g];this.F=this.color=null;this.bf=[[]];this.z=null};c.Oo=function(){this.z=this.object=null};c.Bl=function(){this.rotation=this.z=this.y=this.x=this.object=null;this.scale=new c.o;this.F=null};c.Al=function(){this.z=null;this.$=new c.Vb;this.ca=new c.Vb;this.F=null};
c.Da={Wd:function(a,b){var d,e,f=a.l.length,h=b instanceof c.Y?b.D:b,g=a.l,n=h.l,m=a.s,q=h.s;a=a.R[0];h=h.R[0];b instanceof c.Y&&(b.$b&&b.ed(),d=b.matrix,(e=new c.hd).gb(d),e.Bd());b=0;for(var r=n.length;b<r;b++){var t=n[b].clone();d&&t.Z(d);g.push(t)}b=0;for(r=q.length;b<r;b++){var p,w=(t=q[b]).M,u=t.C;t instanceof c.aa?p=new c.aa(t.a+f,t.b+f,t.c+f):t instanceof c.la&&(p=new c.la(t.a+f,t.b+f,t.c+f,t.d+f));p.u.i(t.u);e&&p.u.Bc(e).normalize();g=0;for(n=w.length;g<n;g++){var A=w[g].clone();e&&A.Bc(e).normalize();
p.M.push(A)}p.color.i(t.color);g=0;for(n=u.length;g<n;g++)A=u[g],p.C.push(A.clone());p.xa=t.xa;p.qa.i(t.qa);d&&p.qa.Z(d);m.push(p)}b=0;for(r=h.length;b<r;b++){e=[];g=0;for(n=(d=h[b]).length;g<n;g++)e.push(new c.o(d[g].x,d[g].y));a.push(e)}},zx:function(a,b){for(var d={},e=0,f=b.length;e<f;e++)d[b[e]]=!0;var h;b=[];e=0;for(f=a.s.length;e<f;e++)(h=a.s[e]).xa in d||b.push(h);a.s=b},Dk:function(a,b,d){var e,f,h,g=new c.g,n=c.Da.rf;return 1<(e=c.Da.random())+(f=c.Da.random())&&(e=1-e,f=1-f),h=1-e-f,g.i(a),
g.A(e),n.i(b),n.A(f),g.add(n),n.i(d),n.A(h),g.add(n),g},Tr:function(a,b,d){var e,f,h;if(a instanceof c.aa)return e=b.l[a.a],f=b.l[a.b],h=b.l[a.c],c.Da.Dk(e,f,h);if(a instanceof c.la){e=b.l[a.a];f=b.l[a.b];h=b.l[a.c];var g;b=b.l[a.d];return d?a.Dh&&a.Eh?(d=a.Dh,g=a.Eh):(d=c.Da.$e(e,f,b),g=c.Da.$e(f,h,b),a.Dh=d,a.Eh=g):(d=c.Da.$e(e,f,b),g=c.Da.$e(f,h,b)),c.Da.random()*(d+g)<d?c.Da.Dk(e,f,b):c.Da.Dk(f,h,b)}},wx:function(a,b){function d(u){return function G(y,C){if(C<y)return y;var I=y+Math.floor((C-
y)/2);return w[I]>u?G(y,I-1):w[I]<u?G(I+1,C):I}(0,w.length-1)}var e,f,h,g,n,m,q=a.s,r=a.l,t=q.length,p=0,w=[];for(f=0;f<t;f++)(e=q[f])instanceof c.aa?(h=r[e.a],g=r[e.b],n=r[e.c],e.Yl=c.Da.$e(h,g,n)):e instanceof c.la&&(h=r[e.a],g=r[e.b],n=r[e.c],m=r[e.d],e.Dh=c.Da.$e(h,g,m),e.Eh=c.Da.$e(g,n,m),e.Yl=e.Dh+e.Eh),p+=e.Yl,w[f]=p;e=[];for(f=0;f<b;f++)r=d(r=c.Da.random()*p),e[f]=c.Da.Tr(q[r],a,!0);return e},$e:function(a,b,d){var e=c.Da.rf,f=c.Da.hg;return e.O(b,a),f.O(d,a),e.Dc(f),.5*e.length()},ha:function(a){a.Pj();
var b=a.Tc,d=new c.g;return d.pc(b.min,b.max),d.A(-.5),a.uf((new c.da).kr(d.x,d.y,d.z)),a.Pj(),d},Pw:function(a){for(var b=0,d=(a=a.R[0]).length;b<d;b++)for(var e=a[b],f=0,h=e.length;f<h;f++)1!==e[f].x&&(e[f].x-=Math.floor(e[f].x)),1!==e[f].y&&(e[f].y-=Math.floor(e[f].y))},qy:function(a){var b,d,e=[],f=[],h=[];var g=0;for(b=a.Ec.length;g<b;g++)f[g]=[];g=0;for(b=a.R.length;g<b;g++)h[g]=[];g=0;for(b=a.s.length;g<b;g++)if((d=a.s[g])instanceof c.la){var n=d.a;var m=d.b,q=d.c,r=d.d,t=new c.aa,p=new c.aa;
t.color.i(d.color);p.color.i(d.color);t.xa=d.xa;p.xa=d.xa;t.a=n;t.b=m;t.c=r;p.a=m;p.b=q;p.c=r;4===d.C.length&&(t.C[0]=d.C[0].clone(),t.C[1]=d.C[1].clone(),t.C[2]=d.C[3].clone(),p.C[0]=d.C[1].clone(),p.C[1]=d.C[2].clone(),p.C[2]=d.C[3].clone());e.push(t,p);d=0;for(n=a.R.length;d<n;d++)a.R[d].length&&(m=(t=a.R[d][g])[1],q=t[2],r=t[3],t=[t[0].clone(),m.clone(),r.clone()],m=[m.clone(),q.clone(),r.clone()],h[d].push(t,m));d=0;for(n=a.Ec.length;d<n;d++)a.Ec[d].length&&(m=a.Ec[d][g],f[d].push(m,m))}else{e.push(d);
d=0;for(n=a.Ec.length;d<n;d++)f[d].push(a.Ec[d][g]);d=0;for(n=a.R.length;d<n;d++)h[d].push(a.R[d][g])}a.s=e;a.Ec=f;a.R=h;Uc(a);Fd(a);a.Sd();a.Hf&&a.Nh()},Qx:function(a,b,d,e){a=a.s;e=e||a.length-1;for(d=d||0;d<=e;d++)a[d].xa=b}};c.Da.random=c.Math.Sr;c.Da.rf=new c.g;c.Da.hg=new c.g;
c.Gd={crossOrigin:"anonymous",cr:function(a,b,d,e){var f=new Image,h=new c.wb(f,b);return(b=new c.$i).addEventListener("load",function(g){h.image=g.content;h.ia=!0;d&&d(h)}),b.addEventListener("error",function(g){e&&e(g.message)}),b.crossOrigin=this.crossOrigin,b.load(a,f),h.sourceFile=a,h},Jm:function(a,b,d,e){var f=new c.le;f.mapping=b;var h=new XMLHttpRequest;return h.onload=function(){var g=c.Gd.Bk(h.response,!0);f.format=g.format;f.Gb=g.Gb;f.image.width=g.width;f.image.height=g.height;f.Ob=!1;
f.ia=!0;d&&d(f)},h.onerror=e,h.open("GET",a,!0),h.responseType="arraybuffer",h.send(null),f},dr:function(a,b,d,e){var f=[];f.Ud=0;var h=new c.wb;h.image=f;void 0!==b&&(h.mapping=b);h.flipY=!1;b=0;for(var g=a.length;b<g;++b){var n=new Image;f[b]=n;n.onload=function(){f.Ud+=1;6===f.Ud&&(h.ia=!0,d&&d(h))};n.onerror=e;n.crossOrigin=this.crossOrigin;n.src=a[b]}return h},br:function(a,b,d,e){var f=[];f.Ud=0;var h=new c.le;if(h.image=f,void 0!==b&&(h.mapping=b),h.flipY=!1,h.Ob=!1,b=function(r,t){return function(){var p=
c.Gd.Bk(r.response,!0);t.format=p.format;t.Gb=p.Gb;t.width=p.width;t.height=p.height;f.Ud+=1;6===f.Ud&&(h.format=p.format,h.ia=!0,d&&d(h))}},a instanceof Array)for(var g=0,n=a.length;g<n;++g){var m={};f[g]=m;var q=new XMLHttpRequest;q.onload=b(q,m);q.onerror=e;m=a[g];q.open("GET",m,!0);q.responseType="arraybuffer";q.send(null)}else(q=new XMLHttpRequest).onload=function(){var r=c.Gd.Bk(q.response,!0);if(r.Dm){for(var t=r.Gb.length/r.Kf,p=0;p<t;p++){f[p]={Gb:[]};for(var w=0;w<r.Kf;w++)f[p].Gb.push(r.Gb[p*
r.Kf+w]),f[p].format=r.format,f[p].width=r.width,f[p].height=r.height}h.format=r.format;h.ia=!0;d&&d(h)}},q.onerror=e,q.open("GET",a,!0),q.responseType="arraybuffer",q.send(null);return h},Bk:function(a,b){function d(p){return p.charCodeAt(0)+(p.charCodeAt(1)<<8)+(p.charCodeAt(2)<<16)+(p.charCodeAt(3)<<24)}var e={Gb:[],width:0,height:0,format:null,Kf:1},f=d("DXT1"),h=d("DXT3"),g=d("DXT5");if(542327876!==(n=new Int32Array(a,0,31))[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),
e;if(4&!n[20])return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),e;switch(m=n[21]){case f:f=8;e.format=c.wl;break;case h:f=16;e.format=c.ul;break;case g:f=16;e.format=c.vl;break;default:return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(255&m,m>>8&255,m>>16&255,m>>24&255)),e}e.Kf=1;131072&n[2]&&!1!==b&&(e.Kf=Math.max(1,n[7]));e.Dm=!!(512&n[28]);e.width=n[4];e.height=n[3];var n=n[1]+4,m=(h=e.width,g=e.height,e.Dm?6:
1);for(b=0;b<m;b++){for(var q=0;q<e.Kf;q++){var r=Math.max(4,h)/4*Math.max(4,g)/4*f,t={data:new Uint8Array(a,n,r),width:h,height:g};e.Gb.push(t);n+=r;h=Math.max(.5*h,1);g=Math.max(.5*g,1)}h=e.width;g=e.height}return e},Zu:function(a,b){var d=(b=1|b,a.width),e=a.height,f=document.createElement("canvas");f.width=d;f.height=e;var h=f.getContext("2d");h.drawImage(a,0,0);a=h.getImageData(0,0,d,e).data;for(var g=h.createImageData(d,e),n=g.data,m=0;m<d;m++)for(var q=0;q<e;q++){var r=0>q-1?0:q-1,t=q+1>e-
1?e-1:q+1,p=0>m-1?0:m-1,w=m+1>d-1?d-1:m+1,u=[],A=[0,0,a[4*(q*d+m)]/255*b];u.push([-1,0,a[4*(q*d+p)]/255*b]);u.push([-1,-1,a[4*(r*d+p)]/255*b]);u.push([0,-1,a[4*(r*d+m)]/255*b]);u.push([1,-1,a[4*(r*d+w)]/255*b]);u.push([1,0,a[4*(q*d+w)]/255*b]);u.push([1,1,a[4*(t*d+w)]/255*b]);u.push([0,1,a[4*(t*d+m)]/255*b]);u.push([-1,1,a[4*(t*d+p)]/255*b]);r=[];p=u.length;for(t=0;t<p;t++){w=u[t];var y=u[(t+1)%p];w=[w[0]-A[0],w[1]-A[1],w[2]-A[2]];y=[y[0]-A[0],y[1]-A[1],y[2]-A[2]];var C=r;w=[w[1]*y[2]-w[2]*y[1],w[2]*
y[0]-w[0]*y[2],w[0]*y[1]-w[1]*y[0]];y=Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2]);C.push.call(C,[w[0]/y,w[1]/y,w[2]/y])}u=[0,0,0];for(t=0;t<r.length;t++)u[0]+=r[t][0],u[1]+=r[t][1],u[2]+=r[t][2];u[0]/=r.length;u[1]/=r.length;u[2]/=r.length;n[A=4*(q*d+m)]=(u[0]+1)/2*255|0;n[A+1]=(u[1]+1)/2*255|0;n[A+2]=255*u[2]|0;n[A+3]=255}return h.putImageData(g,0,0),f},Wu:function(a,b,d){for(var e=a*b,f=new Uint8Array(3*e),h=Math.floor(255*d.r),g=Math.floor(255*d.v),n=(d=Math.floor(255*d.b),0);n<e;n++)f[3*n]=h,f[3*
n+1]=g,f[3*n+2]=d;return(a=new c.me(f,a,b,c.jj)).ia=!0,a}};c.lt={bu:function(a,b){for(var d=new c.H,e=0,f=b.length;e<f;e++)d.add(new c.Y(a,b[e]));return d},detach:function(a,b,d){a.uf(b.K);b.remove(a);d.add(a)},At:function(a,b,d){var e=new c.da;e.gb(d.K);a.uf(e);b.remove(a);d.add(a)}};
c.cb={s:{},face:"helvetiker",weight:"normal",style:"normal",size:150,Xj:10,Bq:function(){return this.s[this.face][this.weight][this.style]},Km:function(a){var b=a.Qu.toLowerCase();return this.s[b]=this.s[b]||{},this.s[b][a.Rj]=this.s[b][a.Rj]||{},this.s[b][a.Rj][a.eq]=a,this.s[b][a.Rj][a.eq]=a},lq:function(a){var b=this.Bq(),d=this.size/b.Ax,e=0,f=String(a).split(""),h=f.length,g=[];for(a=0;a<h;a++){var n=new c.se;e+=(n=this.sq(f[a],b,d,e,n)).offset;g.push(n.path)}return{Mr:g,offset:e/2}},sq:function(a,
b,d,e,f){var h,g,n,m,q,r,t=[],p=b.Eq[a]||b.Eq["?"];if(p){if(p.Gr){var w=(b=p.sp||(p.sp=p.Gr.split(" "))).length;for(a=0;a<w;)switch(g=b[a++],g){case "m":g=b[a++]*d+e;var u=b[a++]*d;f.moveTo(g,u);break;case "l":g=b[a++]*d+e;u=b[a++]*d;f.lineTo(g,u);break;case "q":if(g=b[a++]*d+e,u=b[a++]*d,n=b[a++]*d+e,m=b[a++]*d,f.quadraticCurveTo(n,m,g,u),t[t.length-1]){var A=1;for(h=this.Xj;A<=h;A++);}break;case "b":if(g=b[a++]*d+e,u=b[a++]*d,n=b[a++]*d+e,m=b[a++]*-d,q=b[a++]*d+e,r=b[a++]*-d,f.bezierCurveTo(g,u,
n,m,q,r),t[t.length-1])for(A=1,h=this.Xj;A<=h;A++);}}return{offset:p.jv*d,path:f}}}};
c.cb.xq=function(a,b){var d=void 0!==(b=b||{}).tg?b.tg:4,e=void 0!==b.font?b.font:"helvetiker",f=void 0!==b.weight?b.weight:"normal",h=void 0!==b.style?b.style:"normal";c.cb.size=void 0!==b.size?b.size:100;c.cb.Xj=d;c.cb.face=e;c.cb.weight=f;c.cb.style=h;e=[];f=0;for(h=(d=c.cb.lq(a).Mr).length;f<h;f++){a=Array.prototype.push;b=a.apply;var g=e,n;var m=void 0,q,r=d[f],t=[],p=new c.se;var w=0;for(q=r.actions.length;w<q;w++){var u=(n=r.actions[w]).Nb;(n=n.action)==c.Ub.gj&&0!=p.actions.length&&(t.push(p),
p=new c.se);p[n].apply(p,u)}if(0!=p.actions.length&&t.push(p),0==t.length)n=[];else if(u=[],w=!c.fa.W.He(t[0].Gf()),1==t.length)n=(p=t[0],(m=new c.fa).actions=p.actions,m.Sa=p.Sa,u.push(m),u);else{if(w)for(m=new c.fa,w=0,q=t.length;w<q;w++)p=t[w],c.fa.W.He(p.Gf())?(m.actions=p.actions,m.Sa=p.Sa,u.push(m),m=new c.fa):m.$c.push(p);else{w=0;for(q=t.length;w<q;w++)p=t[w],c.fa.W.He(p.Gf())?(m&&u.push(m),(m=new c.fa).actions=p.actions,m.Sa=p.Sa):m.$c.push(p);u.push(m)}n=u}b.call(a,g,n)}return e};
(function(a){function b(d){for(var e=d.length,f=0,h=e-1,g=0;g<e;h=g++)f+=d[h].x*d[g].y-d[g].x*d[h].y;return.5*f}a.ue=function(d,e){var f=d.length;if(3>f)return null;var h,g,n,m=[],q=[],r=[];if(0<b(d))for(g=0;g<f;g++)q[g]=g;else for(g=0;g<f;g++)q[g]=f-1-g;var t=2*f;for(g=f-1;2<f;){if(0>=t--){console.log("Warning, unable to triangulate polygon!");break}f<=(h=g)&&(h=0);f<=(g=h+1)&&(g=0);f<=(n=g+1)&&(n=0);a:{var p,w,u,A,y=(p=d[q[h]].x,d[q[h]].y),C=d[q[g]].x,G=d[q[g]].y,I=d[q[n]].x;if(1E-10>(C-p)*((w=
d[q[n]].y)-y)-(G-y)*(I-p))var L=!1;else{var K,Q,O,fa=void 0,Z=(O=Q=K=A=u=void 0,I-C),Ga=w-G,R=p-I,V=y-w,aa=C-p,U=G-y;for(L=0;L<f;L++)if(L!==h&&L!==g&&L!==n&&(O=(u=d[q[L]].x)-C,fa=(A=d[q[L]].y)-G,K=aa*(Q=A-y)-U*(K=u-p),Q=R*(A-=w)-V*(u-=I),0<=(O=Z*fa-Ga*O)&&0<=Q&&0<=K)){L=!1;break a}L=!0}}if(L){m.push([d[q[h]],d[q[g]],d[q[n]]]);r.push([q[h],q[g],q[n]]);h=g;for(n=g+1;n<f;h++,n++)q[h]=q[n];t=2*--f}}return e?r:m};a.ue.vf=b})(c.cb);self.Ud={s:c.cb.s,Km:c.cb.Km};c.ka=function(){};Oa=c.ka.prototype;
Oa.Ia=function(){return console.log("Warning, getPoint() not implemented!"),null};Oa.Ag=function(a){return a=Je(this,a),this.Ia(a)};Oa.Gf=function(a){a||=5;var b,d=[];for(b=0;b<=a;b++)d.push(this.Ia(b/a));return d};Oa.ci=function(a){a||=5;var b,d=[];for(b=0;b<=a;b++)d.push(this.Ag(b/a));return d};Oa.zg=function(){var a=Ke(this);return a[a.length-1]};
function Ke(a){var b;if(b||=a.hp?a.hp:200,a.Lj&&a.Lj.length==b+1&&!a.ia)return a.Lj;a.ia=!1;var d,e,f=[],h=a.Ia(0),g=0;f.push(0);for(e=1;e<=b;e++)g+=(d=a.Ia(e/b)).Td(h),f.push(g),h=d;return a.Lj=f}function Je(a,b,d){a=Ke(a);var e=0,f=a.length;b=d||b*a[f-1];for(var h=0,g=f-1;h<=g;)if(0>(d=a[e=Math.floor(h+(g-h)/2)]-b))h=e+1;else{if(!(0<d)){g=e;break}g=e-1}return a[e=g]==b?e/(f-1):(e+(b-(h=a[e]))/(a[e+1]-h))/(f-1)}Oa.di=function(a){var b=a-1E-4;return 0>b&&(b=0),1<(a+=1E-4)&&(a=1),b=this.Ia(b),this.Ia(a).clone().sub(b).normalize()};
c.hf=function(a,b){this.$=a;this.ca=b};c.hf.prototype=Object.create(c.ka.prototype);c.hf.prototype.Ia=function(a){var b=this.ca.clone().sub(this.$);return b.A(a).add(this.$),b};c.hf.prototype.Ag=function(a){return this.Ia(a)};c.hf.prototype.di=function(){return this.ca.clone().sub(this.$).normalize()};c.ph=function(a,b,d){this.nb=a;this.$=b;this.ca=d};c.ph.prototype=Object.create(c.ka.prototype);
c.ph.prototype.Ia=function(a){var b;return b=c.fa.W.we(a,this.nb.x,this.$.x,this.ca.x),a=c.fa.W.we(a,this.nb.y,this.$.y,this.ca.y),new c.o(b,a)};c.ph.prototype.di=function(a){var b;return b=c.ka.W.Ln(a,this.nb.x,this.$.x,this.ca.x),a=c.ka.W.Ln(a,this.nb.y,this.$.y,this.ca.y),(b=new c.o(b,a)).normalize(),b};c.fh=function(a,b,d,e){this.nb=a;this.$=b;this.ca=d;this.sb=e};c.fh.prototype=Object.create(c.ka.prototype);
c.fh.prototype.Ia=function(a){var b;return b=c.fa.W.xe(a,this.nb.x,this.$.x,this.ca.x,this.sb.x),a=c.fa.W.xe(a,this.nb.y,this.$.y,this.ca.y,this.sb.y),new c.o(b,a)};c.fh.prototype.di=function(a){var b;return b=c.ka.W.Kn(a,this.nb.x,this.$.x,this.ca.x,this.sb.x),a=c.ka.W.Kn(a,this.nb.y,this.$.y,this.ca.y,this.sb.y),(b=new c.o(b,a)).normalize(),b};c.nj=function(a){this.points=null==a?[]:a};c.nj.prototype=Object.create(c.ka.prototype);
c.nj.prototype.Ia=function(a){var b,d=new c.o,e=[],f=this.points;return b=(f.length-1)*a,b-=a=Math.floor(b),e[0]=0==a?a:a-1,e[1]=a,e[2]=a>f.length-2?f.length-1:a+1,e[3]=a>f.length-3?f.length-1:a+2,d.x=c.ka.W.sc(f[e[0]].x,f[e[1]].x,f[e[2]].x,f[e[3]].x,b),d.y=c.ka.W.sc(f[e[0]].y,f[e[1]].y,f[e[2]].y,f[e[3]].y,b),d};c.Wf=function(a,b,d,e,f,h,g){this.vp=a;this.wp=b;this.Ts=d;this.Us=e;this.Zl=f;this.up=h;this.tp=g};c.Wf.prototype=Object.create(c.ka.prototype);
c.Wf.prototype.Ia=function(a){var b=this.up-this.Zl;return this.tp||(a=1-a),b=this.Zl+a*b,a=this.vp+this.Ts*Math.cos(b),b=this.wp+this.Us*Math.sin(b),new c.o(a,b)};c.ho=function(a,b,d,e,f,h){c.Wf.call(this,a,b,d,d,e,f,h)};c.ho.prototype=Object.create(c.Wf.prototype);
c.ka.W={Ln:function(a,b,d,e){return 2*(1-a)*(d-b)+2*a*(e-d)},Kn:function(a,b,d,e,f){return-3*b*(1-a)*(1-a)+3*d*(1-a)*(1-a)-6*a*d*(1-a)+6*a*e*(1-a)-3*a*a*e+3*a*a*f},gy:function(a){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},sc:function(a,b,d,e,f){var h=f*f;return(2*b-2*d+(a=.5*(d-a))+(e=.5*(e-b)))*f*h+(-3*b+3*d-2*a-e)*h+a*f+b}};c.ka.create=function(a,b){return a.prototype=Object.create(c.ka.prototype),a.prototype.Ia=b,a};
c.gt=c.ka.create(function(a,b){this.$=a;this.ca=b},function(a){var b=new c.g;return b.O(this.ca,this.$),b.A(a),b.add(this.$),b});c.kt=c.ka.create(function(a,b,d){this.nb=a;this.$=b;this.ca=d},function(a){var b,d;return b=c.fa.W.we(a,this.nb.x,this.$.x,this.ca.x),d=c.fa.W.we(a,this.nb.y,this.$.y,this.ca.y),a=c.fa.W.we(a,this.nb.z,this.$.z,this.ca.z),new c.g(b,d,a)});
c.Zs=c.ka.create(function(a,b,d,e){this.nb=a;this.$=b;this.ca=d;this.sb=e},function(a){var b,d;return b=c.fa.W.xe(a,this.nb.x,this.$.x,this.ca.x,this.sb.x),d=c.fa.W.xe(a,this.nb.y,this.$.y,this.ca.y,this.sb.y),a=c.fa.W.xe(a,this.nb.z,this.$.z,this.ca.z,this.sb.z),new c.g(b,d,a)});
c.ot=c.ka.create(function(a){this.points=null==a?[]:a},function(a){var b,d=new c.g,e=[],f=this.points;a=(f.length-1)*a;a-=b=Math.floor(a);e[0]=0==b?b:b-1;e[1]=b;e[2]=b>f.length-2?f.length-1:b+1;e[3]=b>f.length-3?f.length-1:b+2;b=f[e[0]];var h=f[e[1]],g=f[e[2]];e=f[e[3]];return d.x=c.ka.W.sc(b.x,h.x,g.x,e.x,a),d.y=c.ka.W.sc(b.y,h.y,g.y,e.y,a),d.z=c.ka.W.sc(b.z,h.z,g.z,e.z,a),d});
c.Xs=c.ka.create(function(a){this.points=null==a?[]:a},function(a){var b,d=new c.g,e=[],f=this.points;return b=(f.length-0)*a,b-=a=Math.floor(b),a+=0<a?0:(Math.floor(Math.abs(a)/f.length)+1)*f.length,e[0]=(a-1)%f.length,e[1]=a%f.length,e[2]=(a+1)%f.length,e[3]=(a+2)%f.length,d.x=c.ka.W.sc(f[e[0]].x,f[e[1]].x,f[e[2]].x,f[e[3]].x,b),d.y=c.ka.W.sc(f[e[0]].y,f[e[1]].y,f[e[2]].y,f[e[3]].y,b),d.z=c.ka.W.sc(f[e[0]].z,f[e[1]].z,f[e[2]].z,f[e[3]].z,b),d});c.gh=function(){this.Sa=[];this.Jh=[]};
c.gh.prototype=Object.create(c.ka.prototype);Oa=c.gh.prototype;Oa.add=function(a){this.Sa.push(a)};Oa.closePath=function(){var a=this.Sa[0].Ia(0),b=this.Sa[this.Sa.length-1].Ia(1);a.ra(b)||this.Sa.push(new c.hf(b,a))};Oa.Ia=function(a){var b=a*this.zg(),d=Le(this);for(a=0;a<d.length;){if(d[a]>=b)return b=1-(b=d[a]-b)/(a=this.Sa[a]).zg(),a.Ag(b);a++}return null};Oa.zg=function(){var a=Le(this);return a[a.length-1]};
function Le(a){if(a.Mj&&a.Mj.length==a.Sa.length)return a.Mj;var b,d=[],e=0,f=a.Sa.length;for(b=0;b<f;b++)e+=a.Sa[b].zg(),d.push(e);return a.Mj=d}Oa.bi=function(){var a,b,d,e,f=this.Gf();var h=a=Number.NEGATIVE_INFINITY;var g=d=Number.POSITIVE_INFINITY;var n,m,q=f[0]instanceof c.g;var r=q?new c.g:new c.o;var t=0;for(m=f.length;t<m;t++)(n=f[t]).x>h?h=n.x:n.x<g&&(g=n.x),n.y>a?a=n.y:n.y<d&&(d=n.y),q&&(n.z>b?b=n.z:n.z<e&&(e=n.z)),r.add(n);return f={Fw:g,Gw:d,ur:h,sw:a,qa:r.Vc(m)},q&&(f.tw=b,f.Hw=e),f};
function Me(a,b,d){var e,f=a.Gf(b);d||=a.Jh;b=0;for(e=d.length;b<e;b++)f=Ne(a,f,d[b]);return f}function Oe(a,b,d){var e,f=a.ci(b);d||=a.Jh;b=0;for(e=d.length;b<e;b++)f=Ne(a,f,d[b]);return f}function Ne(a,b,d){var e,f,h=a.bi();a=0;for(e=b.length;a<e;a++){var g=(f=b[a]).x;var n=f.y;var m=g/h.ur;m=Je(d,m,g);g=d.Ia(m);n=d.av(m).A(n);f.x=g.x+n.x;f.y=g.y+n.y}return b}c.jh=function(){c.H.call(this)};c.jh.prototype=Object.create(c.H.prototype);Oa=c.jh.prototype;
Oa.Jb=function(a){this.$b&&this.ed();(this.$a||a)&&(this.parent?(this.K.Ea(this.parent.K,this.matrix),this.K.Ph(this.Pn,this.Zr,this.on),this.matrix.Ph(this.Ks,this.nn,this.$r),this.K.Zp(this.Pn,this.nn,this.on)):this.K.i(this.matrix),this.$a=!1,a=!0);for(var b=0,d=this.children.length;b<d;b++)this.children[b].Jb(a)};Oa.Pn=new c.g;Oa.Ks=new c.g;Oa.Zr=new c.Lb;Oa.nn=new c.Lb;Oa.on=new c.g;Oa.$r=new c.g;
c.se=function(a){c.gh.call(this);this.actions=[];if(a){this.moveTo(a[0].x,a[0].y);for(var b=1,d=a.length;b<d;b++)this.lineTo(a[b].x,a[b].y)}};c.se.prototype=Object.create(c.gh.prototype);c.Ub={gj:"moveTo",gl:"lineTo",sl:"quadraticCurveTo",Zk:"bezierCurveTo",lo:"splineThru",eo:"arc",cl:"ellipse"};Oa=c.se.prototype;Oa.moveTo=function(a,b){this.actions.push({action:c.Ub.gj,Nb:Array.prototype.slice.call(arguments)})};
Oa.lineTo=function(a,b){var d=Array.prototype.slice.call(arguments),e=this.actions[this.actions.length-1].Nb;e=new c.hf(new c.o(e[e.length-2],e[e.length-1]),new c.o(a,b));this.Sa.push(e);this.actions.push({action:c.Ub.gl,Nb:d})};Oa.quadraticCurveTo=function(a,b,d,e){var f=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].Nb;h=new c.ph(new c.o(h[h.length-2],h[h.length-1]),new c.o(a,b),new c.o(d,e));this.Sa.push(h);this.actions.push({action:c.Ub.sl,Nb:f})};
Oa.bezierCurveTo=function(a,b,d,e,f,h){var g=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].Nb;n=new c.fh(new c.o(n[n.length-2],n[n.length-1]),new c.o(a,b),new c.o(d,e),new c.o(f,h));this.Sa.push(n);this.actions.push({action:c.Ub.Zk,Nb:g})};Oa.arc=function(a,b,d,e,f,h){var g=this.actions[this.actions.length-1].Nb;this.$l(a+g[g.length-2],b+g[g.length-1],d,d,e,f,h)};
Oa.ellipse=function(a,b,d,e,f,h,g){var n=this.actions[this.actions.length-1].Nb;this.$l(a+n[n.length-2],b+n[n.length-1],d,e,f,h,g)};Oa.$l=function(a,b,d,e,f,h,g){var n=Array.prototype.slice.call(arguments),m=new c.Wf(a,b,d,e,f,h,g);this.Sa.push(m);m=m.Ia(g?1:0);n.push(m.x);n.push(m.y);this.actions.push({action:c.Ub.cl,Nb:n})};Oa.ci=function(a){a||=40;for(var b=[],d=0;d<a;d++)b.push(this.Ia(d/a));return b};
Oa.Gf=function(a){if(this.Qs)return console.log("tata"),this.ci(a);a=a||12;var b,d,e,f,h,g=[];var n=0;for(b=this.actions.length;n<b;n++)switch(d=this.actions[n],e=d.action,d=d.Nb,e){case c.Ub.gj:case c.Ub.gl:g.push(new c.o(d[0],d[1]));break;case c.Ub.sl:var m=d[2];var q=d[3];var r=d[0];var t=d[1];0<g.length?(f=(e=g[g.length-1]).x,h=e.y):(f=(e=this.actions[n-1].Nb)[e.length-2],h=e[e.length-1]);for(d=1;d<=a;d++){var p=d/a;e=c.fa.W.we(p,f,r,m);p=c.fa.W.we(p,h,t,q);g.push(new c.o(e,p))}break;case c.Ub.Zk:m=
d[4];q=d[5];r=d[0];t=d[1];var w=d[2];var u=d[3];0<g.length?(f=(e=g[g.length-1]).x,h=e.y):(f=(e=this.actions[n-1].Nb)[e.length-2],h=e[e.length-1]);for(d=1;d<=a;d++)p=d/a,e=c.fa.W.xe(p,f,r,w,m),p=c.fa.W.xe(p,h,t,u,q),g.push(new c.o(e,p));break;case c.Ub.lo:e=this.actions[n-1].Nb;p=[new c.o(e[e.length-2],e[e.length-1])];e=a*d[0].length;p=p.concat(d[0]);p=new c.nj(p);for(d=1;d<=e;d++)g.push(p.Ag(d/e));break;case c.Ub.eo:m=d[0];q=d[1];t=d[2];w=d[3];e=d[4];r=!!d[5];f=e-w;h=2*a;for(d=1;d<=h;d++)p=d/h,r||
(p=1-p),p=w+p*f,e=m+t*Math.cos(p),p=q+t*Math.sin(p),g.push(new c.o(e,p));break;case c.Ub.cl:for(m=d[0],q=d[1],t=d[2],u=d[3],w=d[4],e=d[5],r=!!d[6],f=e-w,h=2*a,d=1;d<=h;d++)p=d/h,r||(p=1-p),p=w+p*f,e=m+t*Math.cos(p),p=q+u*Math.sin(p),g.push(new c.o(e,p))}return n=g[g.length-1],1E-10>Math.abs(n.x-g[0].x)&&1E-10>Math.abs(n.y-g[0].y)&&g.splice(g.length-1,1),g};c.fa=function(){c.se.apply(this,arguments);this.$c=[]};c.fa.prototype=Object.create(c.se.prototype);
function Pe(a,b){if(a.Qs){var d=Oe(a,b),e,f=a.$c.length,h=[];for(e=0;e<f;e++)h[e]=Oe(a.$c[e],b,a.Jh);a={shape:d,$c:h}}else{d=Me(a,b);f=a.$c.length;h=[];for(e=0;e<f;e++)h[e]=Me(a.$c[e],b,a.Jh);a={shape:d,$c:h}}return a}
c.fa.W={Ur:function(a,b){var d,e,f,h,g=a.concat(),n=g.concat(),m=[];for(f=0;f<b.length;f++){var q=b[f];Array.prototype.push.apply(n,q);var r=Number.POSITIVE_INFINITY;for(a=0;a<q.length;a++){var t=q[a];var p=[];for(h=0;h<g.length;h++){var w=g[h];w=t.ud(w);p.push(w);w<r&&(r=w,d=a,e=h)}}a=0<=e-1?e-1:g.length-1;r=0<=d-1?d-1:q.length-1;var u=[q[d],g[e],g[a]];h=c.cb.ue.vf(u);var A=[q[d],q[r],g[e]];t=c.cb.ue.vf(A);p=e;w=d;d+=-1;0>(e+=1)&&(e+=g.length);e%=g.length;0>d&&(d+=q.length);d%=q.length;a=0<=e-1?
e-1:g.length-1;r=0<=d-1?d-1:q.length-1;u=[q[d],g[e],g[a]];u=c.cb.ue.vf(u);A=[q[d],q[r],g[e]];h+t>u+c.cb.ue.vf(A)&&(d=w,0>(e=p)&&(e+=g.length),e%=g.length,0>d&&(d+=q.length),d%=q.length,a=0<=e-1?e-1:g.length-1,r=0<=d-1?d-1:q.length-1);h=g.slice(0,e);t=g.slice(e);p=q.slice(d);w=q.slice(0,d);r=[q[d],q[r],g[e]];m.push([q[d],g[e],g[a]]);m.push(r);g=h.concat(p).concat(w).concat(t)}return{shape:g,Tq:m,zp:n}},Qn:function(a,b){var d,e=(h=c.fa.W.Ur(a,b)).zp,f=h.Tq,h=c.cb.ue(h.shape,!1),g={};a=0;for(b=e.length;a<
b;a++)void 0!==g[d=e[a].x+":"+e[a].y]&&console.log("Duplicate point",d),g[d]=a;a=0;for(b=h.length;a<b;a++){var n=h[a];for(e=0;3>e;e++)void 0!==(d=g[d=n[e].x+":"+n[e].y])&&(n[e]=d)}a=0;for(b=f.length;a<b;a++)for(n=f[a],e=0;3>e;e++)void 0!==(d=g[d=n[e].x+":"+n[e].y])&&(n[e]=d);return h.concat(f)},He:function(a){return 0>c.cb.ue.vf(a)},Hp:function(a,b){a=1-a;return a*a*b},Ip:function(a,b){return 2*(1-a)*a*b},Jp:function(a,b){return a*a*b},we:function(a,b,d,e){return this.Hp(a,b)+this.Ip(a,d)+this.Jp(a,
e)},Kp:function(a,b){a=1-a;return a*a*a*b},Lp:function(a,b){var d=1-a;return 3*d*d*a*b},Mp:function(a,b){return 3*(1-a)*a*a*b},Np:function(a,b){return a*a*a*b},xe:function(a,b,d,e,f){return this.Kp(a,b)+this.Lp(a,d)+this.Mp(a,e)+this.Np(a,f)}};
c.Ca=function(){function a(f,h){h.push(f);for(var g=0;g<f.children.length;g++)a(f.children[g],h)}var b=[],d={},e={update:function(f){for(var h=0;h<b.length;h++)b[h].update(f)},Gh:function(f){-1===b.indexOf(f)&&b.push(f)},yi:function(f){-1!==(f=b.indexOf(f))&&b.splice(f,1)},add:function(f){if(void 0!==d[f.name]&&console.log("THREE.AnimationHandler.add: Warning! "+f.name+" already exists in library. Overwriting."),d[f.name]=f,!0!==f.Qq){for(var h=0;h<f.B.length;h++){for(var g=0;g<f.B[h].keys.length;g++)if(0>
f.B[h].keys[g].time&&(f.B[h].keys[g].time=0),void 0!==f.B[h].keys[g].Ue&&!(f.B[h].keys[g].Ue instanceof c.Lb)){var n=f.B[h].keys[g].Ue;f.B[h].keys[g].Ue=new c.Lb(n[0],n[1],n[2],n[3])}if(f.B[h].keys.length&&void 0!==f.B[h].keys[0].L){n={};for(g=0;g<f.B[h].keys.length;g++)for(var m=0;m<f.B[h].keys[g].L.length;m++){var q=f.B[h].keys[g].L[m];n[q]=-1}f.B[h].wy=n;for(g=0;g<f.B[h].keys.length;g++){var r={};for(q in n){for(m=0;m<f.B[h].keys[g].L.length;m++)if(f.B[h].keys[g].L[m]===q){r[q]=f.B[h].keys[g].Ar[m];
break}m===f.B[h].keys[g].L.length&&(r[q]=0)}f.B[h].keys[g].Ar=r}}for(g=1;g<f.B[h].keys.length;g++)f.B[h].keys[g].time===f.B[h].keys[g-1].time&&(f.B[h].keys.splice(g,1),g--);for(g=0;g<f.B[h].keys.length;g++)f.B[h].keys[g].index=g}g=parseInt(f.length*f.yg,10);f.bj={};f.bj.B=[];for(h=0;h<f.B.length;h++)f.bj.B.push(Array(g));f.Qq=!0}},get:function(f){if("string"==typeof f)return d[f]?d[f]:(console.log("THREE.AnimationHandler.get: Couldn't find animation "+f),null)},parse:function(f){var h=[];if(f instanceof
c.lc)for(var g=0;g<f.Na.length;g++)h.push(f.Na[g]);else a(f,h);return h}};return e.LINEAR=0,e.Ui=1,e.Uf=2,e}();c.Animation=function(a,b,d){this.root=a;this.data=c.Ca.get(b);this.B=c.Ca.parse(a);this.currentTime=0;this.Tk=1;this.xd=!1;this.loop=this.Gc=!0;this.wd=void 0!==d?d:c.Ca.LINEAR;this.points=[];this.target=new c.g};Oa=c.Animation.prototype;
Oa.play=function(a,b){if(!1===this.xd){this.xd=!0;this.loop=void 0===a||a;this.currentTime=void 0!==b?b:0;var d=this.B.length;for(a=0;a<d;a++){b=this.B[a];this.wd!==c.Ca.Uf&&(b.Mc=!0);b.$b=!0;void 0===b.Xa&&(b.Xa={},b.Xa.Te={Mf:0,Ue:0,Ci:0},b.Xa.Le={Mf:0,Ue:0,Ci:0},b.Xa.vi=b instanceof c.yc?b.vc:b.matrix);var e=b.Xa.Te;b=b.Xa.Le;e.Mf=this.data.B[a].keys[0];e.Ue=this.data.B[a].keys[0];e.Ci=this.data.B[a].keys[0];b.Mf=this.vd("pos",a,1);b.Ue=this.vd("rot",a,1);b.Ci=this.vd("scl",a,1)}this.update(0)}this.Gc=
!1;c.Ca.Gh(this)};Oa.pause=function(){!0===this.Gc?c.Ca.Gh(this):c.Ca.yi(this);this.Gc=!this.Gc};Oa.stop=function(){this.Gc=this.xd=!1;c.Ca.yi(this)};
Oa.update=function(a){if(!1!==this.xd){var b,d,e,f=["pos","rot","scl"];var h=this.currentTime+=a*this.Tk;var g=this.currentTime%=this.data.length;parseInt(Math.min(g*this.data.yg,this.data.length*this.data.yg),10);for(var n=0,m=this.B.length;n<m;n++){var q=(a=this.B[n]).Xa;for(var r=0;3>r;r++){if(b=f[r],d=q.Te[b],(e=q.Le[b]).time<=h){if(g<h){if(!this.loop)return void this.stop();d=this.data.B[n].keys[0];for(e=this.vd(b,n,1);e.time<g;)d=e,e=this.vd(b,n,e.index+1)}else{do d=e,e=this.vd(b,n,e.index+
1);while(e.time<g)}q.Te[b]=d;q.Le[b]=e}a.$b=!0;a.$a=!0;var t=(g-d.time)/(e.time-d.time);var p=d[b];var w=e[b];(0>t||1<t)&&(console.log("THREE.Animation.update: Warning! Scale out of bounds:"+t+" on bone "+n),t=0>t?0:1);"pos"===b?(b=a.position,this.wd===c.Ca.LINEAR?(b.x=p[0]+(w[0]-p[0])*t,b.y=p[1]+(w[1]-p[1])*t,b.z=p[2]+(w[2]-p[2])*t):this.wd!==c.Ca.Ui&&this.wd!==c.Ca.Uf||(this.points[0]=this.fk("pos",n,d.index-1).Mf,this.points[1]=p,this.points[2]=w,this.points[3]=this.vd("pos",n,e.index+1).Mf,t=
.33*t+.33,p=Qe(this,this.points,t),b.x=p[0],b.y=p[1],b.z=p[2],this.wd===c.Ca.Uf&&(t=Qe(this,this.points,1.01*t),this.target.set(t[0],t[1],t[2]),this.target.sub(b),this.target.y=0,this.target.normalize(),t=Math.atan2(this.target.x,this.target.z),a.rotation.set(0,t,0)))):"rot"===b?c.Lb.Qk(p,w,a.bc,t):"scl"===b&&((b=a.scale).x=p[0]+(w[0]-p[0])*t,b.y=p[1]+(w[1]-p[1])*t,b.z=p[2]+(w[2]-p[2])*t)}}}};
function Qe(a,b,d){var e,f,h,g,n,m,q=[],r=[];return e=(b.length-1)*d,e-=f=Math.floor(e),q[0]=0===f?f:f-1,q[1]=f,q[2]=f>b.length-2?f:f+1,q[3]=f>b.length-3?f:f+2,f=b[q[0]],g=b[q[1]],n=b[q[2]],m=b[q[3]],h=e*(q=e*e),r[0]=a.sc(f[0],g[0],n[0],m[0],e,q,h),r[1]=a.sc(f[1],g[1],n[1],m[1],e,q,h),r[2]=a.sc(f[2],g[2],n[2],m[2],e,q,h),r}Oa.sc=function(a,b,d,e,f,h,g){return(2*(b-d)+(a=.5*(d-a))+(e=.5*(e-b)))*g+(-3*(b-d)-2*a-e)*h+a*f+b};
Oa.vd=function(a,b,d){var e=this.data.B[b].keys;for(d=this.wd===c.Ca.Ui||this.wd===c.Ca.Uf?d<e.length-1?d:e.length-1:d%e.length;d<e.length;d++)if(void 0!==e[d][a])return e[d];return this.data.B[b].keys[0]};Oa.fk=function(a,b,d){var e=this.data.B[b].keys;for(d=this.wd===c.Ca.Ui||this.wd===c.Ca.Uf?0<d?d:0:0<=d?d:d+e.length;0<=d;d--)if(void 0!==e[d][a])return e[d];return this.data.B[b].keys[e.length-1]};
c.yo=function(a,b,d){this.root=a;this.data=c.Ca.get(b);this.B=c.Ca.parse(a);this.currentTime=0;this.Tk=.001;this.xd=!1;this.loop=this.Gc=!0;this.cj=void 0===d||d;a=0;for(b=this.B.length;a<b;a++){d=this.data.B[a].ss;var e=this.B[a];if(this.data.B[a].keys.length&&d){for(var f=0;f<d.length;f++){var h=d[f],g=this.vd(h,a,0);g&&g.apply(h)}e.$b=!1;this.data.B[a].node.ed();e.$a=!0}}};Oa=c.yo.prototype;
Oa.play=function(a,b){if(!this.xd){this.xd=!0;this.loop=void 0===a||a;this.currentTime=void 0!==b?b:0;this.En=b;this.startTime=1E7;this.endTime=-this.startTime;var d=this.B.length;for(a=0;a<d;a++){b=this.B[a];var e=this.data.B[a];b.Mc=!0;void 0===e.Xa&&(e.Xa={},e.Xa.Te=null,e.Xa.Le=null,e.Xa.vi=b instanceof c.yc?b.vc:b.matrix);(b=this.data.B[a].keys).length&&(e.Xa.Te=b[0],e.Xa.Le=b[1],this.startTime=Math.min(b[0].time,this.startTime),this.endTime=Math.max(b[b.length-1].time,this.endTime))}this.update(0)}this.Gc=
!1;c.Ca.Gh(this)};Oa.pause=function(){this.Gc?c.Ca.Gh(this):c.Ca.yi(this);this.Gc=!this.Gc};Oa.stop=function(){this.Gc=this.xd=!1;c.Ca.yi(this);for(var a=0;a<this.data.B.length;a++){var b=this.B[a],d=this.data.B[a];if(void 0!==d.Xa){var e=d.Xa.vi;b instanceof c.yc?(e.i(b.vc),b.vc=e):(e.i(b.matrix),b.matrix=e);delete d.Xa}}};
Oa.update=function(a){if(this.xd){var b,d,e,f,h,g,n,m=this.data.bj.B;if(g=this.currentTime+=a*this.Tk,(h=this.currentTime%=this.data.length)<this.En&&(h=this.currentTime=this.En+h),f=parseInt(Math.min(h*this.data.yg,this.data.length*this.data.yg),10),(n=h<g)&&!this.loop){a=0;for(var q=this.B.length;a<q;a++){var r=this.data.B[a].keys;m=this.data.B[a].ss;if(e=r.length-1,f=this.B[a],r.length){for(r=0;r<m.length;r++)h=m[r],(g=this.fk(h,a,e))&&g.apply(h);this.data.B[a].node.ed();f.$a=!0}}this.stop()}else if(!(h<
this.startTime)){a=0;for(q=this.B.length;a<q;a++){e=this.B[a];r=(b=this.data.B[a]).keys;var t=b.Xa;if(this.cj&&void 0!==m[a][f])e instanceof c.yc?(e.vc=m[a][f],e.$a=!1):(e.matrix=m[a][f],e.$a=!0);else if(r.length){if((this.cj&&t&&(e instanceof c.yc?e.vc=t.vi:e.matrix=t.vi),b=t.Te,d=t.Le,b&&d)&&d.time<=g){if(n&&this.loop)for(b=r[0],d=r[1];d.time<h;)d=r[(b=d).index+1];else if(!n)for(var p=r.length-1;d.time<h&&d.index!==p;)d=r[(b=d).index+1];t.Te=b;t.Le=d}this.data.B[a].node.ed();e.$a=!0}}if(this.cj&&
void 0===m[0][f])for(this.B[0].Jb(!0),a=0;a<this.B.length;a++)m[a][f]=this.B[a]instanceof c.yc?this.B[a].vc.clone():this.B[a].matrix.clone()}}};Oa.vd=function(a,b,d){for(d%=(b=this.data.B[b].keys).length;d<b.length;d++)if(b[d].Iq(a))return b[d];return b[0]};Oa.fk=function(a,b,d){b=this.data.B[b].keys;for(d=0<=d?d:d+b.length;0<=d;d--)if(b[d].Iq(a))return b[d];return b[b.length-1]};
c.ro=function(a,b,d){c.H.call(this);var e=new c.kc(90,1,a,b);e.dd.set(0,-1,0);e.jb(new c.g(1,0,0));this.add(e);e=new c.kc(90,1,a,b);e.dd.set(0,-1,0);e.jb(new c.g(-1,0,0));this.add(e);e=new c.kc(90,1,a,b);e.dd.set(0,0,1);e.jb(new c.g(0,1,0));this.add(e);e=new c.kc(90,1,a,b);e.dd.set(0,0,-1);e.jb(new c.g(0,-1,0));this.add(e);e=new c.kc(90,1,a,b);e.dd.set(0,-1,0);e.jb(new c.g(0,0,1));this.add(e);a=new c.kc(90,1,a,b);a.dd.set(0,-1,0);a.jb(new c.g(0,0,-1));this.add(a);this.kn=new c.ve(d,d)};
c.ro.prototype=Object.create(c.H.prototype);c.Vi=function(a,b,d,e,f,h,g){c.Rb.call(this);this.Ce=d;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2;this.Rd=new c.$f(a/-2,a/2,b/2,b/-2,h,g);this.rd=new c.kc(d,a/b,e,f);this.zoom=1;Re(this)};c.Vi.prototype=Object.create(c.Rb.prototype);function Re(a){a.Ka=a.rd.Ka;a.Oa=a.rd.Oa;a.rd.Ce=a.Ce/a.zoom;a.rd.je();a.ta=a.rd.ta;a.Bm=!0}c.Vi.prototype.Gi=function(a,b){this.rd.lg=a/b;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2};
c.Vi.prototype.je=function(){if(this.Bm)Re(this);else{Re(this);var a=this.rd.lg,b=(this.rd.Ka+this.rd.Oa)/2;a=2*(b*=Math.tan(this.Ce/2))*a/2;b/=this.zoom;a/=this.zoom;this.Rd.left=-a;this.Rd.right=a;this.Rd.top=b;this.Rd.bottom=-b;this.Rd.je();this.Ka=this.Rd.Ka;this.Oa=this.Rd.Oa;this.ta=this.Rd.ta;this.Bm=!1}};
c.eh=function(a,b){c.N.call(this);var d=[[a,0,0],[b,0,0],[-a,0,0],[-b,0,0],[0,a,0],[0,b,0],[0,-a,0],[0,-b,0],[0,0,a],[0,0,b],[0,0,-a],[0,0,-b],[d=.707*a,d,0],[e=.707*b,e,0],[-d,-d,0],[-e,-e,0],[d,-d,0],[e,-e,0],[-d,d,0],[-e,e,0],[d,0,d],[e,0,e],[-d,0,-d],[-e,0,-e],[d,0,-d],[e,0,-e],[-d,0,d],[-e,0,e],[0,d,d],[0,e,e],[0,-d,-d],[0,-e,-e],[0,d,-d],[0,e,-e],[0,-d,d],[0,-e,e]],e=0;for(a=d.length;e<a;e++)this.l.push(new c.g(d[e][0],d[e][1],d[e][2]))};c.eh.prototype=Object.create(c.N.prototype);
c.no=function(a,b,d,e){c.N.call(this);a=a||50;d=void 0!==d?d:0;e=void 0!==e?e:2*Math.PI;b=void 0!==b?Math.max(3,b):8;var f=[];var h=new c.g;var g=new c.o(.5,.5);this.l.push(h);f.push(g);for(h=0;h<=b;h++){var n=new c.g;n.x=a*Math.cos(d+h/b*e);n.y=a*Math.sin(d+h/b*e);this.l.push(n);f.push(new c.o((n.x/a+1)/2,-(n.y/a+1)/2+1))}d=new c.g(0,0,-1);for(h=1;h<=b;h++)this.s.push(new c.aa(h,h+1,0,[d,d,d])),this.R[0].push([f[h],f[h+1],g]);Uc(this);Fd(this);this.yb=new c.Kd(new c.g,a)};c.no.prototype=Object.create(c.N.prototype);
c.$k=function(a,b,d,e,f,h){function g(m,q,r,t,p,w,u,A){var y,C=n.gd,G=n.Zc,I=p/2,L=w/2,K=n.l.length;"x"===m&&"y"===q||"y"===m&&"x"===q?y="z":"x"===m&&"z"===q||"z"===m&&"x"===q?(y="y",G=n.Wj):("z"===m&&"y"===q||"y"===m&&"z"===q)&&(y="x",C=n.Wj);var Q=C+1,O=G+1,fa=p/C,Z=w/G,Ga=new c.g;Ga[y]=0<u?1:-1;for(p=0;p<O;p++)for(w=0;w<Q;w++){var R=new c.g;R[m]=(w*fa-I)*r;R[q]=(p*Z-L)*t;R[y]=u;n.l.push(R)}for(p=0;p<G;p++)for(w=0;w<C;w++)(m=new c.la(w+Q*p+K,w+Q*(p+1)+K,w+1+Q*(p+1)+K,w+1+Q*p+K)).u.i(Ga),m.M.push(Ga.clone(),
Ga.clone(),Ga.clone(),Ga.clone()),m.xa=A,n.s.push(m),n.R[0].push([new c.o(w/C,1-p/G),new c.o(w/C,1-(p+1)/G),new c.o((w+1)/C,1-(p+1)/G),new c.o((w+1)/C,1-p/G)])}c.N.call(this);var n=this;this.width=a;this.height=b;this.depth=d;this.gd=e||1;this.Zc=f||1;this.Wj=h||1;a=this.width/2;b=this.height/2;d=this.depth/2;g("z","y",-1,-1,this.depth,this.height,a,0);g("z","y",1,-1,this.depth,this.height,-a,1);g("x","z",1,1,this.width,this.depth,b,2);g("x","z",1,-1,this.width,this.depth,-b,3);g("x","y",1,-1,this.width,
this.height,d,4);g("x","y",-1,-1,this.width,this.height,-d,5);Uc(this);Wd(this)};c.$k.prototype=Object.create(c.N.prototype);
c.hh=function(a,b,d,e,f,h){c.N.call(this);a=void 0!==a?a:20;b=void 0!==b?b:20;var g,n,m=(d=void 0!==d?d:100)/2,q=(e=e||8,f=f||1,[]),r=[];for(n=0;n<=f;n++){var t=[],p=[],w=(A=n/f)*(b-a)+a;for(g=0;g<=e;g++){var u=g/e;(y=new c.g).x=w*Math.sin(2*u*Math.PI);y.y=-A*d+m;y.z=w*Math.cos(2*u*Math.PI);this.l.push(y);t.push(this.l.length-1);p.push(new c.o(u,1-A))}q.push(t);r.push(p)}d=(b-a)/d;for(g=0;g<e;g++)for(0!==a?(t=this.l[q[0][g]].clone(),p=this.l[q[0][g+1]].clone()):(t=this.l[q[1][g]].clone(),p=this.l[q[1][g+
1]].clone()),t.Hi(Math.sqrt(t.x*t.x+t.z*t.z)*d).normalize(),p.Hi(Math.sqrt(p.x*p.x+p.z*p.z)*d).normalize(),n=0;n<f;n++){var A=q[n][g],y=(w=q[n+1][g],u=q[n+1][g+1],q[n][g+1]),C=t.clone(),G=t.clone(),I=p.clone(),L=p.clone(),K=r[n][g].clone(),Q=r[n+1][g].clone(),O=r[n+1][g+1].clone(),fa=r[n][g+1].clone();this.s.push(new c.la(A,w,u,y,[C,G,I,L]));this.R[0].push([K,Q,O,fa])}if(!h&&0<a)for(this.l.push(new c.g(0,m,0)),g=0;g<e;g++)A=q[0][g],w=q[0][g+1],u=this.l.length-1,C=new c.g(0,1,0),G=new c.g(0,1,0),I=
new c.g(0,1,0),K=r[0][g].clone(),Q=r[0][g+1].clone(),O=new c.o(Q.Ms,0),this.s.push(new c.aa(A,w,u,[C,G,I])),this.R[0].push([K,Q,O]);if(!h&&0<b)for(this.l.push(new c.g(0,-m,0)),g=0;g<e;g++)A=q[n][g+1],w=q[n][g],u=this.l.length-1,C=new c.g(0,-1,0),G=new c.g(0,-1,0),I=new c.g(0,-1,0),K=r[n][g+1].clone(),Q=r[n][g].clone(),O=new c.o(Q.Ms,1),this.s.push(new c.aa(A,w,u,[C,G,I])),this.R[0].push([K,Q,O]);Uc(this);Fd(this)};c.hh.prototype=Object.create(c.N.prototype);
c.La=function(a,b){void 0!==a&&(c.N.call(this),a=a instanceof Array?a:[a],a[a.length-1].bi(),this.Bj(a,b),Uc(this),Fd(this))};c.La.prototype=Object.create(c.N.prototype);c.La.prototype.Bj=function(a,b){for(var d=a.length,e=0;e<d;e++)this.Aj(a[e],b)};
c.La.prototype.Aj=function(a,b){function d(Ka,ha,wa){return ha||console.log("die"),ha.clone().A(wa).add(Ka)}function e(Ka,ha,wa){var Ua=c.La.rf,k=c.La.hg,W=c.La.np,qa=c.La.op,T=c.La.pp,La=c.La.qp;return Ua.set(Ka.x-ha.x,Ka.y-ha.y),k.set(Ka.x-wa.x,Ka.y-wa.y),Ua=Ua.normalize(),k=k.normalize(),W.set(-Ua.y,Ua.x),qa.set(k.y,-k.x),T.i(Ka).add(W),La.i(Ka).add(qa),T.ra(La)?qa.clone():(T.i(ha).add(W),La.i(wa).add(qa),W=Ua.ba(qa),qa=La.sub(T).ba(qa),0===W&&(console.log("Either infinite or no solutions!"),0===
qa?console.log("Its finite solutions."):console.log("Too bad, no solutions.")),0>(qa/=W)?((ha=Math.atan2(ha.y-Ka.y,ha.x-Ka.x))>(Ka=Math.atan2(wa.y-Ka.y,wa.x-Ka.x))&&(Ka+=2*Math.PI),wa=(ha+Ka)/2,Ka=-Math.cos(wa),wa=-Math.sin(wa),new c.o(Ka,wa)):Ua.A(qa).add(T).sub(Ka).clone())}function f(Ka,ha){var wa;for(S=Ka.length;0<=--S;){var Ua=S;0>(wa=S-1)&&(wa=Ka.length-1);var k,W=G+2*A;for(k=0;k<W;k++){var qa=Ka,T=k,La=W,ub=Ua,bb=wa,Ma=(Ma=ha+Ua+(ob=Ba*k))+Ga,ob=(ob=ha+wa+ob)+Ga,pb=(pb=ha+wa+(Xb=Ba*(k+1)))+
Ga,Xb=(Xb=ha+Ua+Xb)+Ga;Z.s.push(new c.la(Ma,ob,pb,Xb,null,null,Q));Ma=O.yq(Z,a,qa,b,Ma,ob,pb,Xb,T,La,ub,bb);Z.R[0].push(Ma)}}}function h(Ka,ha,wa){Z.l.push(new c.g(Ka,ha,wa))}function g(Ka,ha,wa,Ua){Ka+=Ga;ha+=Ga;wa+=Ga;Z.s.push(new c.aa(Ka,ha,wa,null,null,K));Ka=Ua?O.sm(Z,a,b,Ka,ha,wa):O.tm(Z,a,b,Ka,ha,wa);Z.R[0].push(Ka)}var n,m,q,r,t,p=void 0!==b.amount?b.amount:100,w=void 0!==b.Jj?b.Jj:6,u=void 0!==b.Ij?b.Ij:w-2,A=void 0!==b.Op?b.Op:3,y=void 0===b.Hj||b.Hj,C=void 0!==b.tg?b.tg:12,G=void 0!==b.Fs?
b.Fs:1,I=b.Pu,L=!1,K=b.F,Q=b.Ou,O=void 0!==b.oj?b.oj:c.La.Jl;I&&(n=I.ci(G),L=!0,y=!1,m=void 0!==b.frames?b.frames:new c.sh.dl(I,G,!1),q=new c.g,r=new c.g,t=new c.g);y||(u=w=A=0);var fa,Z=this,Ga=this.l.length,R=(C=Pe(a,C)).shape;C=C.$c;if(I=!c.fa.W.He(R)){R=R.reverse();var V=0;for(fa=C.length;V<fa;V++){var aa=C[V];c.fa.W.He(aa)&&(C[V]=aa.reverse())}I=!1}var U=c.fa.W.Qn(R,C);I=R;V=0;for(fa=C.length;V<fa;V++)aa=C[V],R=R.concat(aa);var ba,da,Ba=R.length,ta=U.length,Ia=[],S=0,Fa=I.length;var Ca=Fa-1;
for(ba=S+1;S<Fa;S++,Ca++,ba++)Ca===Fa&&(Ca=0),ba===Fa&&(ba=0),Ia[S]=e(I[S],I[Ca],I[ba]);var Ra=[],Ja=Ia.concat();V=0;for(fa=C.length;V<fa;V++){aa=C[V];var ca=[];S=0;Ca=(Fa=aa.length)-1;for(ba=S+1;S<Fa;S++,Ca++,ba++)Ca===Fa&&(Ca=0),ba===Fa&&(ba=0),ca[S]=e(aa[S],aa[Ca],aa[ba]);Ra.push(ca);Ja=Ja.concat(ca)}for(Ca=0;Ca<A;Ca++){var za=w*(1-(aa=Ca/A));ba=u*Math.sin(aa*Math.PI/2);S=0;for(Fa=I.length;S<Fa;S++)h((da=d(I[S],Ia[S],ba)).x,da.y,-za);V=0;for(fa=C.length;V<fa;V++)for(aa=C[V],ca=Ra[V],S=0,Fa=aa.length;S<
Fa;S++)h((da=d(aa[S],ca[S],ba)).x,da.y,-za)}ba=u;for(S=0;S<Ba;S++)da=y?d(R[S],Ja[S],ba):R[S],L?(r.i(m.Ne[0]).A(da.x),q.i(m.Kh[0]).A(da.y),t.i(n[0]).add(r).add(q),h(t.x,t.y,t.z)):h(da.x,da.y,0);for(aa=1;aa<=G;aa++)for(S=0;S<Ba;S++)da=y?d(R[S],Ja[S],ba):R[S],L?(r.i(m.Ne[aa]).A(da.x),q.i(m.Kh[aa]).A(da.y),t.i(n[aa]).add(r).add(q),h(t.x,t.y,t.z)):h(da.x,da.y,p/G*aa);for(Ca=A-1;0<=Ca;Ca--){za=w*(1-(aa=Ca/A));ba=u*Math.sin(aa*Math.PI/2);S=0;for(Fa=I.length;S<Fa;S++)h((da=d(I[S],Ia[S],ba)).x,da.y,p+za);
V=0;for(fa=C.length;V<fa;V++)for(aa=C[V],ca=Ra[V],S=0,Fa=aa.length;S<Fa;S++)da=d(aa[S],ca[S],ba),L?h(da.x,da.y+n[G-1].y,n[G-1].x+za):h(da.x,da.y,p+za)}if(y){w=0*Ba;for(S=0;S<ta;S++)g((p=U[S])[2]+w,p[1]+w,p[0]+w,!0);w=Ba*(G+2*A);for(S=0;S<ta;S++)g((p=U[S])[0]+w,p[1]+w,p[2]+w,!1)}else{for(S=0;S<ta;S++)g((p=U[S])[2],p[1],p[0],!0);for(S=0;S<ta;S++)g((p=U[S])[0]+Ba*G,p[1]+Ba*G,p[2]+Ba*G,!1)}f(I,p=0);p+=I.length;V=0;for(fa=C.length;V<fa;V++)f(aa=C[V],p),p+=aa.length};
c.La.Jl={tm:function(a,b,d,e,f,h){return b=a.l[f].x,f=a.l[f].y,d=a.l[h].x,h=a.l[h].y,[new c.o(a.l[e].x,a.l[e].y),new c.o(b,f),new c.o(d,h)]},sm:function(a,b,d,e,f,h){return this.tm(a,b,d,e,f,h)},yq:function(a,b,d,e,f,h,g,n){b=a.l[f].x;d=a.l[f].y;f=a.l[f].z;e=a.l[h].x;var m=a.l[h].y,q=(h=a.l[h].z,a.l[g].x),r=a.l[g].y,t=(g=a.l[g].z,a.l[n].x),p=a.l[n].y;a=a.l[n].z;return.01>Math.abs(d-m)?[new c.o(b,1-f),new c.o(e,1-h),new c.o(q,1-g),new c.o(t,1-a)]:[new c.o(d,1-f),new c.o(m,1-h),new c.o(r,1-g),new c.o(p,
1-a)]}};c.La.rf=new c.o;c.La.hg=new c.o;c.La.np=new c.o;c.La.op=new c.o;c.La.pp=new c.o;c.La.qp=new c.o;c.mj=function(a,b){c.N.call(this);0==a instanceof Array&&(a=[a]);a[a.length-1].bi();this.Bj(a,b);Uc(this);Fd(this)};c.mj.prototype=Object.create(c.N.prototype);c.mj.prototype.Bj=function(a,b){for(var d=0,e=a.length;d<e;d++)this.Aj(a[d],b)};
c.mj.prototype.Aj=function(a,b){void 0===b&&(b={});var d,e,f=b.F,h=void 0===b.oj?c.La.Jl:b.oj,g=this.l.length,n=(d=Pe(a,void 0!==b.tg?b.tg:12)).shape,m=d.$c;if(!c.fa.W.He(n))for(n=n.reverse(),d=0,e=m.length;d<e;d++){var q=m[d];c.fa.W.He(q)&&(m[d]=q.reverse())}var r=c.fa.W.Qn(n,m);d=0;for(e=m.length;d<e;d++)q=m[d],n=n.concat(q);m=n.length;e=r.length;for(d=0;d<m;d++)q=n[d],this.l.push(new c.g(q.x,q.y,0));for(d=0;d<e;d++)n=(m=r[d])[0]+g,q=m[1]+g,m=m[2]+g,this.s.push(new c.aa(n,q,m,null,null,f)),this.R[0].push(h.sm(this,
a,b,n,q,m))};
c.zo=function(a,b,d,e){c.N.call(this);b=b||12;d=d||0;e=e||2*Math.PI;for(var f=1/(a.length-1),h=1/b,g=0,n=b;g<=n;g++)for(var m=d+g*h*e,q=Math.cos(m),r=Math.sin(m),t=(m=0,a.length);m<t;m++){var p=a[m],w=new c.g;w.x=q*p.x-r*p.y;w.y=r*p.x+q*p.y;w.z=p.z;this.l.push(w)}d=a.length;g=0;for(n=b;g<n;g++)for(m=0,t=a.length-1;m<t;m++)e=b=m+d*g,r=b+d,q=b+1+d,this.s.push(new c.la(e,r,q,b+1)),e=(q=g*h)+h,r=(b=m*f)+f,this.R[0].push([new c.o(q,b),new c.o(e,b),new c.o(e,r),new c.o(q,r)]);Wd(this);Uc(this);Fd(this);
this.Sd()};c.zo.prototype=Object.create(c.N.prototype);
c.ql=function(a,b,d,e){c.N.call(this);this.width=a;this.height=b;this.gd=d||1;this.Zc=e||1;d=a/2;var f=b/2,h=(e=this.gd,this.Zc),g=e+1,n=h+1,m=this.width/e,q=this.height/h,r=new c.g(0,0,1);for(a=0;a<n;a++)for(b=0;b<g;b++)this.l.push(new c.g(b*m-d,-(a*q-f),0));for(a=0;a<h;a++)for(b=0;b<e;b++)(d=new c.la(b+g*a,b+g*(a+1),b+1+g*(a+1),b+1+g*a)).u.i(r),d.M.push(r.clone(),r.clone(),r.clone(),r.clone()),this.s.push(d),this.R[0].push([new c.o(b/e,1-a/h),new c.o(b/e,1-(a+1)/h),new c.o((b+1)/e,1-(a+1)/h),new c.o((b+
1)/e,1-a/h)]);Uc(this)};c.ql.prototype=Object.create(c.N.prototype);
c.ld=function(a,b,d,e,f,h,g){c.N.call(this);this.P=a||50;this.gd=Math.max(3,Math.floor(b)||8);this.Zc=Math.max(2,Math.floor(d)||6);e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;h=void 0!==h?h:0;g=void 0!==g?g:Math.PI;var n=[],m=[];for(d=0;d<=this.Zc;d++){var q=[],r=[];for(b=0;b<=this.gd;b++){var t=b/this.gd,p=d/this.Zc;(w=new c.g).x=-this.P*Math.cos(e+t*f)*Math.sin(h+p*g);w.y=this.P*Math.cos(h+p*g);w.z=this.P*Math.sin(e+t*f)*Math.sin(h+p*g);this.l.push(w);q.push(this.l.length-1);r.push(new c.o(t,1-p))}n.push(q);
m.push(r)}for(d=0;d<this.Zc;d++)for(b=0;b<this.gd;b++){e=n[d][b+1];f=n[d][b];h=n[d+1][b];g=n[d+1][b+1];q=this.l[e].clone().normalize();r=this.l[f].clone().normalize();t=this.l[h].clone().normalize();p=this.l[g].clone().normalize();var w=m[d][b+1].clone(),u=m[d][b].clone(),A=m[d+1][b].clone(),y=m[d+1][b+1].clone();Math.abs(this.l[e].y)===this.P?(this.s.push(new c.aa(e,h,g,[q,t,p])),this.R[0].push([w,A,y])):Math.abs(this.l[h].y)===this.P?(this.s.push(new c.aa(e,f,h,[q,r,t])),this.R[0].push([w,u,A])):
(this.s.push(new c.la(e,f,h,g,[q,r,t,p])),this.R[0].push([w,u,A,y]))}Uc(this);Fd(this);this.yb=new c.Kd(new c.g,a)};c.ld.prototype=Object.create(c.N.prototype);c.Yo=function(a,b){a=c.cb.xq(a,b);b.amount=void 0!==b.height?b.height:50;void 0===b.Jj&&(b.Jj=10);void 0===b.Ij&&(b.Ij=8);void 0===b.Hj&&(b.Hj=!1);c.La.call(this,a,b)};c.Yo.prototype=Object.create(c.La.prototype);
c.Hl=function(a,b,d,e){c.N.call(this);this.P=a||100;this.af=b||40;this.Pb=d||8;this.bb=e||6;this.arc=f||2*Math.PI;var f=new c.g;a=[];b=[];for(d=0;d<=this.Pb;d++)for(e=0;e<=this.bb;e++){var h=e/this.bb*this.arc,g=2*d/this.Pb*Math.PI;f.x=this.P*Math.cos(h);f.y=this.P*Math.sin(h);(n=new c.g).x=(this.P+this.af*Math.cos(g))*Math.cos(h);n.y=(this.P+this.af*Math.cos(g))*Math.sin(h);n.z=this.af*Math.sin(g);this.l.push(n);a.push(new c.o(e/this.bb,d/this.Pb));b.push(n.clone().sub(f).normalize())}for(d=1;d<=
this.Pb;d++)for(e=1;e<=this.bb;e++){f=(this.bb+1)*d+e-1;h=(this.bb+1)*(d-1)+e-1;g=(this.bb+1)*(d-1)+e;var n=(this.bb+1)*d+e,m=new c.la(f,h,g,n,[b[f],b[h],b[g],b[n]]);m.u.add(b[f]);m.u.add(b[h]);m.u.add(b[g]);m.u.add(b[n]);m.u.normalize();this.s.push(m);this.R[0].push([a[f].clone(),a[h].clone(),a[g].clone(),a[n].clone()])}Uc(this)};c.Hl.prototype=Object.create(c.N.prototype);
c.$o=function(a,b,d,e,f,h,g){function n(t,p,w,u,A,y){var C=Math.cos(t);return Math.cos(p),p=Math.sin(t),t*=w/u,C*=.5*A*(2+(w=Math.cos(t))),p*=.5*A*(2+w),A=.5*y*A*Math.sin(t),new c.g(C,p,A)}c.N.call(this);this.P=a||100;this.af=b||40;this.Pb=d||64;this.bb=e||8;this.p=f||2;this.q=h||3;this.Am=g||1;this.grid=Array(this.Pb);d=new c.g;e=new c.g;f=new c.g;for(a=0;a<this.Pb;++a)for(this.grid[a]=Array(this.bb),b=0;b<this.bb;++b){h=n(m=a/this.Pb*2*this.p*Math.PI,g=b/this.bb*2*Math.PI,this.q,this.p,this.P,this.Am);
var m=n(m+.01,g,this.q,this.p,this.P,this.Am);d.O(m,h);e.pc(m,h);f.Ab(d,e);e.Ab(f,d);f.normalize();e.normalize();m=-this.af*Math.cos(g);g=this.af*Math.sin(g);h.x+=m*e.x+g*f.x;h.y+=m*e.y+g*f.y;h.z+=m*e.z+g*f.z;this.grid[a][b]=this.l.push(new c.g(h.x,h.y,h.z))-1}for(a=0;a<this.Pb;++a)for(b=0;b<this.bb;++b){f=(a+1)%this.Pb;h=(b+1)%this.bb;d=this.grid[a][b];e=this.grid[f][b];f=this.grid[f][h];h=this.grid[a][h];g=new c.o(a/this.Pb,b/this.bb);m=new c.o((a+1)/this.Pb,b/this.bb);var q=new c.o((a+1)/this.Pb,
(b+1)/this.bb),r=new c.o(a/this.Pb,(b+1)/this.bb);this.s.push(new c.la(d,e,f,h));this.R[0].push([g,m,q,r])}Uc(this);Fd(this);this.Sd()};c.$o.prototype=Object.create(c.N.prototype);
c.sh=function(a,b,d,e,f,h){c.N.call(this);this.path=a;this.be=b||64;this.P=d||1;this.ae=e||8;this.closed=f||!1;h&&(this.debug=new c.H);this.grid=[];f=this.be+1;h=new c.g;var g=(b=new c.sh.dl(this.path,this.be,this.closed)).Mn;var n=b.Ne;var m=b.Kh;this.Mn=g;this.Ne=n;this.Kh=m;for(b=0;b<f;b++){this.grid[b]=[];e=b/(f-1);var q=a.Ag(e);e=g[b];var r=n[b];var t=m[b];this.debug&&(this.debug.add(new c.vb(e,q,d,255)),this.debug.add(new c.vb(r,q,d,16711680)),this.debug.add(new c.vb(t,q,d,65280)));for(e=0;e<
this.ae;e++){var p=e/this.ae*2*Math.PI;var w=-this.P*Math.cos(p);p=this.P*Math.sin(p);h.i(q);h.x+=w*r.x+p*t.x;h.y+=w*r.y+p*t.y;h.z+=w*r.z+p*t.z;this.grid[b][e]=this.l.push(new c.g(h.x,h.y,h.z))-1}}for(b=0;b<this.be;b++)for(e=0;e<this.ae;e++)f=this.closed?(b+1)%this.be:b+1,h=(e+1)%this.ae,a=this.grid[b][e],d=this.grid[f][e],f=this.grid[f][h],h=this.grid[b][h],g=new c.o(b/this.be,e/this.ae),n=new c.o((b+1)/this.be,e/this.ae),m=new c.o((b+1)/this.be,(e+1)/this.ae),r=new c.o(b/this.be,(e+1)/this.ae),
this.s.push(new c.la(a,d,f,h)),this.R[0].push([g,n,m,r]);Uc(this);Fd(this);this.Sd()};c.sh.prototype=Object.create(c.N.prototype);
c.sh.dl=function(a,b,d){var e=new c.g,f,h=[],g=[],n=[],m=new c.g,q=new c.da;b+=1;this.Mn=h;this.Ne=g;this.Kh=n;for(f=0;f<b;f++){var r=f/(b-1);var t=f;var p=a,w=r;r=(w=Je(p,w),p.di(w));h[t]=r;h[f].normalize()}g[0]=new c.g;n[0]=new c.g;a=Number.MAX_VALUE;f=Math.abs(h[0].x);r=Math.abs(h[0].y);t=Math.abs(h[0].z);f<=a&&(a=f,e.set(1,0,0));r<=a&&(a=r,e.set(0,1,0));t<=a&&e.set(0,0,1);m.Ab(h[0],e).normalize();g[0].Ab(h[0],m);n[0].Ab(h[0],g[0]);for(f=1;f<b;f++)g[f]=g[f-1].clone(),n[f]=n[f-1].clone(),m.Ab(h[f-
1],h[f]),1E-4<m.length()&&(m.normalize(),e=Math.acos(h[f-1].ba(h[f])),g[f].Z(q.Nm(m,e))),n[f].Ab(h[f],g[f]);if(d)for(e=Math.acos(g[0].ba(g[b-1])),e/=b-1,0<h[0].ba(m.Ab(g[0],g[b-1]))&&(e=-e),f=1;f<b;f++)g[f].Z(q.Nm(h[f],e*f)),n[f].Ab(h[f],g[f])};
c.oh=function(a,b,d,e){function f(p){var w=p.normalize().clone();w.index=m.l.push(w)-1;var u=Math.atan2(p.z,-p.x)/2/Math.PI+.5;p=Math.atan2(-p.y,Math.sqrt(p.x*p.x+p.z*p.z))/Math.PI+.5;return w.va=new c.o(u,1-p),w}function h(p,w,u,A){1>A?((A=new c.aa(p.index,w.index,u.index,[p.clone(),w.clone(),u.clone()])).qa.add(p).add(w).add(u).Vc(3),A.u=A.qa.clone().normalize(),m.s.push(A),A=Math.atan2(A.qa.z,-A.qa.x),m.R[0].push([n(p.va,p,A),n(w.va,w,A),n(u.va,u,A)])):(--A,h(p,g(p,w),g(p,u),A),h(g(p,w),w,g(w,
u),A),h(g(p,u),g(w,u),u,A),h(g(p,w),g(w,u),g(p,u),A))}function g(p,w){t[p.index]||(t[p.index]=[]);t[w.index]||(t[w.index]=[]);var u=t[p.index][w.index];return void 0===u&&(t[p.index][w.index]=t[w.index][p.index]=u=f((new c.g).pc(p,w).Vc(2))),u}function n(p,w,u){return 0>u&&1===p.x&&(p=new c.o(p.x-1,p.y)),0===w.x&&0===w.z&&(p=new c.o(u/2/Math.PI+.5,p.y)),p}c.N.call(this);d=d||1;e=e||0;for(var m=this,q=0,r=a.length;q<r;q++)f(new c.g(a[q][0],a[q][1],a[q][2]));var t=[];a=this.l;q=0;for(r=b.length;q<r;q++)h(a[b[q][0]],
a[b[q][1]],a[b[q][2]],e);Wd(this);q=0;for(r=this.l.length;q<r;q++)this.l[q].A(d);Uc(this);this.yb=new c.Kd(new c.g,d)};c.oh.prototype=Object.create(c.N.prototype);
c.Zi=function(a,b){var d=(1+Math.sqrt(5))/2;c.oh.call(this,[[-1,d,0],[1,d,0],[-1,-d,0],[1,-d,0],[0,-1,d],[0,1,d],[0,-1,-d],[0,1,-d],[d,0,-1],[d,0,1],[-d,0,-1],[-d,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],a,b)};c.Zi.prototype=Object.create(c.N.prototype);
c.Ho=function(a,b){c.oh.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],a,b)};c.Ho.prototype=Object.create(c.N.prototype);c.Xo=function(a,b){c.oh.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],a,b)};c.Xo.prototype=Object.create(c.N.prototype);
c.Mo=function(a,b,d,e){c.N.call(this);var f,h,g=this.l,n=this.s,m=this.R[0],q=(e=void 0!==e&&e,b+1);for(f=0;f<=d;f++){var r=f/d;for(h=0;h<=b;h++){var t=a(t=h/b,r);g.push(t)}}for(f=0;f<d;f++)for(h=0;h<b;h++){a=f*q+h;g=f*q+h+1;r=(f+1)*q+h;t=(f+1)*q+h+1;var p=new c.o(h/b,f/d);var w=new c.o((h+1)/b,f/d);var u=new c.o(h/b,(f+1)/d);var A=new c.o((h+1)/b,(f+1)/d);e?(n.push(new c.aa(a,g,r)),n.push(new c.aa(g,t,r)),m.push([p,w,u]),m.push([w,A,u])):(n.push(new c.la(a,g,t,r)),m.push([p,w,A,u]))}Uc(this);Fd(this);
this.Sd()};c.Mo.prototype=Object.create(c.N.prototype);
c.qo=function(a){function b(A){var y=A.length();return new c.o(A.x/y,A.y/y)}c.N.call(this);for(var d=[[0,1,2],[0,2,1]],e=3;e<a.length;e++){var f=e,h=a[f].clone(),g=h.length();h.x+=2E-6*g*(Math.random()-.5);h.y+=2E-6*g*(Math.random()-.5);h.z+=2E-6*g*(Math.random()-.5);g=[];for(var n=0;n<d.length;){var m=d[n],q=h,r=a[m[0]];var t=r;var p=a[m[1]],w=new c.g,u=new c.g;if(w.O(a[m[2]],p),u.O(t,p),w.Dc(u),w.normalize(),r=(t=w).ba(r),t.ba(q)>=r){for(q=0;3>q;q++){r=[m[q],m[(q+1)%3]];t=!0;for(p=0;p<g.length;p++)if(g[p][0]===
r[1]&&g[p][1]===r[0]){g[p]=g[g.length-1];g.pop();t=!1;break}t&&g.push(r)}d[n]=d[d.length-1];d.pop()}else n++}for(p=0;p<g.length;p++)d.push([g[p][0],g[p][1],f])}f=0;h=Array(a.length);for(e=0;e<d.length;e++)for(g=d[e],n=0;3>n;n++)void 0===h[g[n]]&&(h[g[n]]=f++,this.l.push(a[g[n]])),g[n]=h[g[n]];for(e=0;e<d.length;e++)this.s.push(new c.aa(d[e][0],d[e][1],d[e][2]));for(e=0;e<this.s.length;e++)g=this.s[e],this.R[0].push([b(this.l[g.a]),b(this.l[g.b]),b(this.l[g.c])]);Uc(this);Fd(this);this.Sd()};
c.qo.prototype=Object.create(c.N.prototype);c.jo=function(a){var b=new c.N;b.l.push(new c.g,new c.g(a||1,0,0),new c.g,new c.g(0,a||1,0),new c.g,new c.g(0,0,a||1));b.Za.push(new c.G(16711680),new c.G(16755200),new c.G(65280),new c.G(11206400),new c.G(255),new c.G(43775));a=new c.Kb({C:c.eg});c.Ga.call(this,b,a,c.jf)};c.jo.prototype=Object.create(c.Ga.prototype);
c.vb=function(a,b,d,e){c.H.call(this);void 0===d&&(d=20);void 0===e&&(e=16776960);var f=new c.N;f.l.push(new c.g(0,0,0));f.l.push(new c.g(0,1,0));this.line=new c.Ga(f,new c.Kb({color:e}));this.add(this.line);f=new c.hh(0,.05,.25,5,1);this.Qj=new c.Y(f,new c.Qa({color:e}));this.Qj.position.set(0,1,0);this.add(this.Qj);b instanceof c.g&&(this.position=b);this.setDirection(a);this.Fi(d)};c.vb.prototype=Object.create(c.H.prototype);
c.vb.prototype.setDirection=function(a){var b=c.vb.rf.i(a).normalize();.999<b.y?this.rotation.set(0,0,0):-.999>b.y?this.rotation.set(Math.PI,0,0):(a=c.vb.hg.set(b.z,0,-b.x).normalize(),b=Math.acos(b.y),a=c.vb.lp.qn(a,b),this.rotation.bs(a,this.Be))};c.vb.prototype.Fi=function(a){this.scale.set(a,a,a)};c.vb.prototype.setColor=function(a){this.line.F.color.uc(a);this.Qj.F.color.uc(a)};c.vb.rf=new c.g;c.vb.hg=new c.g;c.vb.lp=new c.Lb;
c.ic=function(a){function b(f,h,g){d(f,g);d(h,g)}function d(f,h){e.D.l.push(new c.g);e.D.Za.push(new c.G(h));void 0===e.xi[f]&&(e.xi[f]=[]);e.xi[f].push(e.D.l.length-1)}c.Ga.call(this);var e=this;this.D=new c.N;this.F=new c.Kb({color:16777215,C:c.ne});this.type=c.jf;this.K=a.K;this.$b=!1;this.xi={};b("n1","n2",16755200);b("n2","n4",16755200);b("n4","n3",16755200);b("n3","n1",16755200);b("f1","f2",16755200);b("f2","f4",16755200);b("f4","f3",16755200);b("f3","f1",16755200);b("n1","f1",16755200);b("n2",
"f2",16755200);b("n3","f3",16755200);b("n4","f4",16755200);b("p","n1",16711680);b("p","n2",16711680);b("p","n3",16711680);b("p","n4",16711680);b("u1","u2",43775);b("u2","u3",43775);b("u3","u1",43775);b("c","t",16777215);b("p","c",3355443);b("cn1","cn2",3355443);b("cn3","cn4",3355443);b("cf1","cf2",3355443);b("cf3","cf4",3355443);this.Nj=a;this.update(a)};c.ic.prototype=Object.create(c.Ga.prototype);
c.ic.prototype.update=function(){function a(d,e,f,h){if(c.ic.tj.set(e,f,h),c.ic.rj.Zn(c.ic.tj,c.ic.Kl),void 0!==(d=b.xi[d]))for(e=0,f=d.length;e<f;e++)b.D.l[d[e]].i(c.ic.tj)}var b=this;c.ic.Kl.ta.i(this.Nj.ta);a("c",0,0,-1);a("t",0,0,1);a("n1",-1,-1,-1);a("n2",1,-1,-1);a("n3",-1,1,-1);a("n4",1,1,-1);a("f1",-1,-1,1);a("f2",1,-1,1);a("f3",-1,1,1);a("f4",1,1,1);a("u1",.7,1.1,-1);a("u2",-.7,1.1,-1);a("u3",0,2,-1);a("cf1",-1,0,1);a("cf2",1,0,1);a("cf3",0,-1,1);a("cf4",0,1,1);a("cn1",-1,0,-1);a("cn2",1,
0,-1);a("cn3",0,-1,-1);a("cn4",0,1,-1);this.D.na=!0};c.ic.rj=new c.ij;c.ic.tj=new c.g;c.ic.Kl=new c.Rb;
c.bl=function(a,b){c.H.call(this);this.sa=a;this.position=a.position;this.direction=new c.g;this.direction.O(a.target.position,a.position);var d=c.Math.Ya(a.ib,0,1);this.color=a.color.clone();this.color.A(d);d=this.color.Xc();var e=new c.ld(b,16,8),f=new c.eh(1.25*b,2.25*b),h=new c.Qa({color:d,J:!1}),g=new c.Kb({color:d,J:!1});this.wa=new c.Y(e,h);this.Vd=new c.Ga(f,g,c.jf);this.add(this.wa);this.add(this.Vd);this.wa.ea.Fc=!0;this.wa.ea.Cg=a;this.wa.ea.Bg=this;this.Va=null;void 0!==a.target.ea.Nn&&
(e=new c.ld(b,8,4),f=new c.Qa({color:d,U:!0,J:!1}),this.Va=new c.Y(e,f),this.Va.position=a.target.position,this.Va.ea.Fc=!0,this.Va.ea.Cg=a.target,this.Va.ea.Bg=this.Va,d=new c.Id({color:d,sd:4,Ff:4,opacity:.75,Ba:!0,J:!1}),(e=new c.N).l.push(this.position.clone()),e.l.push(this.Va.position.clone()),Vd(e),this.dc=new c.Ga(e,d),this.dc.ea.Fc=!0);this.ea.Fc=!0};c.bl.prototype=Object.create(c.H.prototype);
c.bl.prototype.update=function(){this.direction.O(this.sa.target.position,this.sa.position);var a=c.Math.Ya(this.sa.ib,0,1);this.color.i(this.sa.color);this.color.A(a);this.wa.F.color.i(this.color);this.Vd.F.color.i(this.color);null!==this.Va&&(this.Va.F.color.i(this.color),this.dc.F.color.i(this.color),this.dc.D.l[0].i(this.sa.position),this.dc.D.l[1].i(this.sa.target.position),Vd(this.dc.D),this.dc.D.na=!0)};
c.fl=function(a,b,d){c.H.call(this);this.sa=a;this.position=a.position;var e=c.Math.Ya(a.ib,0,1);this.color=a.color.clone();this.color.A(e);var f=this.color.Xc();this.Yc=a.Yc.clone();this.Yc.A(e);e=this.Yc.Xc();for(var h=new c.ld(b,16,8,0,2*Math.PI,0,.5*Math.PI),g=new c.ld(b,16,8,0,2*Math.PI,.5*Math.PI,Math.PI),n=new c.Qa({color:f,J:!1}),m=new c.Qa({color:e,J:!1}),q=0,r=h.s.length;q<r;q++)h.s[q].xa=0;q=0;for(r=g.s.length;q<r;q++)g.s[q].xa=1;c.Da.Wd(h,g);this.wa=new c.Y(h,new c.Sb([n,m]));this.jk=
new c.vb(new c.g(0,1,0),new c.g(0,1.1*(b+d),0),d,f);this.jk.rotation.x=Math.PI;this.Gm=new c.vb(new c.g(0,1,0),new c.g(0,-1.1*(b+d),0),d,e);(b=new c.H).rotation.x=.5*-Math.PI;b.add(this.wa);b.add(this.jk);b.add(this.Gm);this.add(b);this.wa.ea.Fc=!0;this.wa.ea.Cg=a;this.wa.ea.Bg=this;this.ea.Fc=!0;this.target=new c.g;this.jb(this.target)};c.fl.prototype=Object.create(c.H.prototype);
c.fl.prototype.update=function(){var a=c.Math.Ya(this.sa.ib,0,1);this.color.i(this.sa.color);this.color.A(a);this.Yc.i(this.sa.Yc);this.Yc.A(a);this.wa.F.oa[0].color.i(this.color);this.wa.F.oa[1].color.i(this.Yc);this.jk.setColor(this.color.Xc());this.Gm.setColor(this.Yc.Xc());this.jb(this.target)};
c.rl=function(a,b){c.H.call(this);this.sa=a;this.position=a.position;var d=c.Math.Ya(a.ib,0,1);this.color=a.color.clone();this.color.A(d);var e=this.color.Xc(),f=(d=new c.ld(b,16,8),new c.eh(1.25*b,2.25*b));b=new c.Zi(1,2);var h=new c.Qa({color:e,J:!1}),g=new c.Kb({color:e,J:!1});e=new c.Qa({color:e,J:!1,U:!0,opacity:.1,Ba:!0});this.wa=new c.Y(d,h);this.Vd=new c.Ga(f,g,c.jf);this.Je=new c.Y(b,e);0===(d=a.Bb)?this.Je.visible=!1:this.Je.scale.set(d,d,d);this.add(this.wa);this.add(this.Vd);this.add(this.Je);
this.wa.ea.Fc=!0;this.wa.ea.Cg=a;this.wa.ea.Bg=this;this.ea.Fc=!0};c.rl.prototype=Object.create(c.H.prototype);c.rl.prototype.update=function(){var a=c.Math.Ya(this.sa.ib,0,1);this.color.i(this.sa.color);this.color.A(a);this.wa.F.color.i(this.color);this.Vd.F.color.i(this.color);this.Je.F.color.i(this.color);0===(a=this.sa.Bb)?this.Je.visible=!1:(this.Je.visible=!0,this.Je.scale.set(a,a,a))};
c.Dl=function(a,b){c.H.call(this);this.sa=a;this.position=a.position;this.direction=new c.g;this.direction.O(a.target.position,a.position);var d=c.Math.Ya(a.ib,0,1);this.color=a.color.clone();this.color.A(d);d=this.color.Xc();var e=new c.ld(b,16,8),f=new c.eh(1.25*b,2.25*b),h=new c.hh(1E-4,1,1,8,1,!0);(n=new c.da).ln(-Math.PI/2);n.translate(new c.g(0,-.5,0));h.uf(n);var g=new c.Qa({color:d,J:!1}),n=new c.Kb({color:d,J:!1}),m=new c.Qa({color:d,J:!1,U:!0,opacity:.3,Ba:!0});this.wa=new c.Y(e,g);this.ii=
new c.Y(h,m);h=2*(e=a.Bb?a.Bb:1E4)*Math.tan(.5*a.angle);this.ii.scale.set(h,h,e);this.Vd=new c.Ga(f,n,c.jf);this.gk=new c.jh;this.gk.add(this.wa);this.gk.add(this.Vd);this.add(this.gk);this.add(this.ii);this.jb(a.target.position);this.wa.ea.Fc=!0;this.wa.ea.Cg=a;this.wa.ea.Bg=this;this.Va=null;void 0!==a.target.ea.Nn&&(f=new c.ld(b,8,4),n=new c.Qa({color:d,U:!0,J:!1}),this.Va=new c.Y(f,n),this.Va.position=a.target.position,this.Va.ea.Fc=!0,this.Va.ea.Cg=a.target,this.Va.ea.Bg=this.Va,d=new c.Id({color:d,
sd:4,Ff:4,opacity:.75,Ba:!0,J:!1}),(f=new c.N).l.push(this.position.clone()),f.l.push(this.Va.position.clone()),Vd(f),this.dc=new c.Ga(f,d),this.dc.ea.Fc=!0);this.ea.Fc=!0};c.Dl.prototype=Object.create(c.H.prototype);
c.Dl.prototype.update=function(){this.direction.O(this.sa.target.position,this.sa.position);this.jb(this.sa.target.position);var a=this.sa.Bb?this.sa.Bb:1E4,b=2*a*Math.tan(.5*this.sa.angle);this.ii.scale.set(b,b,a);a=c.Math.Ya(this.sa.ib,0,1);this.color.i(this.sa.color);this.color.A(a);this.wa.F.color.i(this.color);this.Vd.F.color.i(this.color);this.ii.F.color.i(this.color);null!==this.Va&&(this.Va.F.color.i(this.color),this.dc.F.color.i(this.color),this.dc.D.l[0].i(this.sa.position),this.dc.D.l[1].i(this.sa.target.position),
Vd(this.dc.D),this.dc.D.na=!0)};c.aj=function(){c.H.call(this);this.I=function(){}};c.aj.prototype=Object.create(c.H.prototype);c.kh=function(a,b,d,e,f){c.H.call(this);this.Fg=[];this.j=new c.g;this.gm=void 0;void 0!==a&&this.add(a,b,d,e,f)};c.kh.prototype=Object.create(c.H.prototype);
c.kh.prototype.add=function(a,b,d,e,f,h){void 0===b&&(b=-1);void 0===d&&(d=0);void 0===h&&(h=1);void 0===f&&(f=new c.G(16777215));void 0===e&&(e=c.nh);d=Math.min(d,Math.max(0,d));this.Fg.push({Is:a,size:b,Bb:d,x:0,y:0,z:0,scale:1,rotation:1,opacity:h,color:f,qb:e})};
c.jl=function(a,b){c.Y.call(this,a,b);this.cm={};this.Cj=[];b=this.D.L.length;a=b-1;b/=1;var d=0;d={Ds:d,Mu:a,length:a-d+1,yg:b,duration:(a-d)/b,ik:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,Bf:!1,Xd:!1};this.cm.__default=d;this.Cj.push(d);(a=this.cm.__default)&&(a.weight=1)};c.jl.prototype=Object.create(c.Y.prototype);
c.jl.prototype.update=function(a){for(var b=0,d=this.Cj.length;b<d;b++){var e=this.Cj[b];if(e.active){var f=e.duration/e.length;e.time+=e.direction*a;e.Xd?(e.time>e.duration||0>e.time)&&(e.direction*=-1,e.time>e.duration&&(e.time=e.duration,e.Bf=!0),0>e.time&&(e.time=0,e.Bf=!1)):(e.time%=e.duration,0>e.time&&(e.time+=e.duration));var h=e.Ds+c.Math.Ya(Math.floor(e.time/f),0,e.length-1),g=e.weight;h!==e.currentFrame&&(this.Ic[e.ik]=0,this.Ic[e.currentFrame]=1*g,this.Ic[h]=0,e.ik=e.currentFrame,e.currentFrame=
h);f=e.time%f/f;e.Bf&&(f=1-f);this.Ic[e.currentFrame]=f*g;this.Ic[e.ik]=(1-f)*g}}};
c.Ao=function(){function a(u,A){var y=b.createProgram(),C=b.createShader(b.FRAGMENT_SHADER),G=b.createShader(b.VERTEX_SHADER);A="precision "+A+" float;\n";return b.shaderSource(C,A+u.S),b.shaderSource(G,A+u.T),b.compileShader(C),b.compileShader(G),b.attachShader(y,C),b.attachShader(y,G),b.linkProgram(y),y}var b,d,e,f,h,g,n,m,q,r,t,p,w;this.Dg=function(u){b=u.context;d=u;e=u.ym();f=new Float32Array(16);h=new Uint16Array(6);u=0;f[u++]=-1;f[u++]=-1;f[u++]=0;f[u++]=0;f[u++]=1;f[u++]=-1;f[u++]=1;f[u++]=
0;f[u++]=1;f[u++]=1;f[u++]=1;f[u++]=1;f[u++]=-1;f[u++]=1;f[u++]=0;f[u++]=1;u=0;h[u++]=0;h[u++]=1;h[u++]=2;h[u++]=0;h[u++]=2;h[u++]=3;g=b.createBuffer();n=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,g);b.bufferData(b.ARRAY_BUFFER,f,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,n);b.bufferData(b.ELEMENT_ARRAY_BUFFER,h,b.STATIC_DRAW);m=b.createTexture();q=b.createTexture();b.bindTexture(b.TEXTURE_2D,m);b.texImage2D(b.TEXTURE_2D,0,b.RGB,16,16,0,b.RGB,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.bindTexture(b.TEXTURE_2D,q);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,16,16,0,b.RGBA,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);
b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);0>=b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(r=!1,t=a(c.Cl.Uq,e)):(r=!0,t=a(c.Cl.Vq,e));w={};(p={}).co=b.getAttribLocation(t,"position");p.va=b.getAttribLocation(t,"uv");w.Hk=b.getUniformLocation(t,"renderType");w.map=b.getUniformLocation(t,"map");w.Hr=b.getUniformLocation(t,"occlusionMap");w.opacity=b.getUniformLocation(t,"opacity");w.color=b.getUniformLocation(t,"color");w.scale=b.getUniformLocation(t,"scale");w.rotation=b.getUniformLocation(t,
"rotation");w.Di=b.getUniformLocation(t,"screenPosition")};this.I=function(u,A,y,C){var G=(u=u.vj).length;if(G){var I,L,K,Q,O=new c.g,fa=C/y,Z=.5*y,Ga=.5*C,R=16/C,V=new c.o(R*fa,R),aa=new c.g(1,1,0),U=new c.o(1,1),ba=w;R=p;b.useProgram(t);b.enableVertexAttribArray(p.co);b.enableVertexAttribArray(p.va);b.uniform1i(ba.Hr,0);b.uniform1i(ba.map,1);b.bindBuffer(b.ARRAY_BUFFER,g);b.vertexAttribPointer(R.co,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(R.va,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,
n);b.disable(b.CULL_FACE);b.depthMask(!1);for(I=0;I<G;I++)if(R=16/C,V.set(R*fa,R),K=u[I],O.set(K.K.elements[12],K.K.elements[13],K.K.elements[14]),O.Z(A.Ua),O.Sc(A.ta),aa.i(O),U.x=aa.x*Z+Z,U.y=aa.y*Ga+Ga,r||0<U.x&&U.x<y&&0<U.y&&U.y<C){b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,m);b.copyTexImage2D(b.TEXTURE_2D,0,b.RGB,U.x-8,U.y-8,16,16,0);b.uniform1i(ba.Hk,0);b.uniform2f(ba.scale,V.x,V.y);b.uniform3f(ba.Di,aa.x,aa.y,aa.z);b.disable(b.BLEND);b.enable(b.DEPTH_TEST);b.drawElements(b.TRIANGLES,
6,b.UNSIGNED_SHORT,0);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,q);b.copyTexImage2D(b.TEXTURE_2D,0,b.RGBA,U.x-8,U.y-8,16,16,0);b.uniform1i(ba.Hk,1);b.disable(b.DEPTH_TEST);b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,m);b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);K.j.i(aa);if(K.gm)K.gm(K);else{var da=void 0;var Ba=K,ta=Ba.Fg.length,Ia=2*-Ba.j.x,S=2*-Ba.j.y;for(L=0;L<ta;L++)(da=Ba.Fg[L]).x=Ba.j.x+Ia*da.Bb,da.y=Ba.j.y+S*da.Bb,da.Ss=.25*da.x*Math.PI,da.rotation+=.25*(da.Ss-
da.rotation)}b.uniform1i(ba.Hk,2);b.enable(b.BLEND);da=0;for(L=K.Fg.length;da<L;da++).001<(Q=K.Fg[da]).opacity&&.001<Q.scale&&(aa.x=Q.x,aa.y=Q.y,aa.z=Q.z,R=Q.size*Q.scale/C,V.x=R*fa,V.y=R,b.uniform3f(ba.Di,aa.x,aa.y,aa.z),b.uniform2f(ba.scale,V.x,V.y),b.uniform1f(ba.rotation,Q.rotation),b.uniform1f(ba.opacity,Q.opacity),b.uniform3f(ba.color,Q.color.r,Q.color.v,Q.color.b),d.Of(Q.qb,Q.blendEquation,Q.ze,Q.ye),d.Pg(Q.Is,1),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0))}b.enable(b.CULL_FACE);b.enable(b.DEPTH_TEST);
b.depthMask(!0)}}};
c.lj=function(){var a,b,d,e,f,h,g=new c.gf,n=new c.da,m=new c.g,q=new c.g,r=new c.g;this.Dg=function(t){a=t.context;b=t;t=c.dg.im;var p=c.nc.clone(t.V);d=new c.Ra({S:t.S,T:t.T,V:p});e=new c.Ra({S:t.S,T:t.T,V:p,L:!0});f=new c.Ra({S:t.S,T:t.T,V:p,Aa:!0});h=new c.Ra({S:t.S,T:t.T,V:p,L:!0,Aa:!0});d.Pd=!0;e.Pd=!0;f.Pd=!0;h.Pd=!0};this.I=function(t,p){b.Xe&&b.qs&&this.update(t,p)};this.update=function(t,p){var w,u,A,y=[];var C=0;a.clearColor(1,1,1,1);a.disable(a.BLEND);a.enable(a.CULL_FACE);a.frontFace(a.CCW);
b.zn===c.Wi?a.cullFace(a.FRONT):a.cullFace(a.BACK);b.Ve(!0);var G=0;for(w=t.Wb.length;G<w;G++)if((u=t.Wb[G]).qc)if(u instanceof c.zc&&u.Pk)for(A=0;A<u.ms;A++){if(u.Ii[A])var I=u.Ii[A];else{var L=u;var K=A;(I=new c.zc).Sq=!0;I.ui=!0;I.qc=!0;I.Rg=L.Rg;I.Qg=L.Qg;I.Mk=L.Mk;I.Nk=L.Nk;I.Lk=L.Lk;I.Ok=L.Ok;I.de=L.de;I.ee=L.ee;I.Qf=L.wn[K];I.Vg=L.ps[K];I.Sg=L.ns[K];I.dn=[];I.Ck=[];var Q=I.dn;var O=I.Ck;for(var fa=0;8>fa;fa++)Q[fa]=new c.g,O[fa]=new c.g;Q=L.yn[K];L=L.xn[K];O[0].set(-1,-1,Q);O[1].set(1,-1,Q);
O[2].set(-1,1,Q);O[3].set(1,1,Q);O[4].set(-1,-1,L);O[5].set(1,-1,L);O[6].set(-1,1,L);O[7].set(1,1,L);I.Jr=p;(O=new c.jh).position=u.os;O.add(I);O.add(I.target);p.add(O);u.Ii[A]=I;console.log("Created virtualLight",I)}Q=A;(L=(K=u).Ii[Q]).position.i(K.position);L.target.position.i(K.target.position);L.jb(L.target);L.de=K.de;L.ee=K.ee;L.Qf=K.wn[Q];O=K.yn[Q];K=K.xn[Q];(L=L.Ck)[0].z=O;L[1].z=O;L[2].z=O;L[3].z=O;L[4].z=K;L[5].z=K;L[6].z=K;L[7].z=K;y[C]=I;C++}else y[C]=u,C++;G=0;for(w=y.length;G<w;G++){if((u=
y[G]).We||(A=c.oe,b.Ug===c.pl&&(A=c.kf),u.We=new c.fg(u.Vg,u.Sg,{kb:A,Fb:A,format:c.bg}),u.Tg=new c.o(u.Vg,u.Sg),u.Ye=new c.da),!u.zd){if(u instanceof c.nf)u.zd=new c.kc(u.ls,u.Vg/u.Sg,u.Rg,u.Qg);else{if(!(u instanceof c.zc)){console.error("Unsupported light type for shadow");continue}u.zd=new c.$f(u.Mk,u.Nk,u.Ok,u.Lk,u.Rg,u.Qg)}t.add(u.zd);b.Fj&&t.Jb()}if(u.de&&!u.ng&&(u.ng=new c.ic(u.zd),u.zd.add(u.ng)),u.Sq&&I.Jr==p){A=p;C=u.zd;O=u.Ck;L=u.dn;m.set(1/0,1/0,1/0);q.set(-1/0,-1/0,-1/0);for(K=0;8>K;K++)(Q=
L[K]).i(O[K]),c.lj.rj.Zn(Q,A),Q.Z(C.Ua),Q.x<m.x&&(m.x=Q.x),Q.x>q.x&&(q.x=Q.x),Q.y<m.y&&(m.y=Q.y),Q.y>q.y&&(q.y=Q.y),Q.z<m.z&&(m.z=Q.z),Q.z>q.z&&(q.z=Q.z);C.left=m.x;C.right=q.x;C.top=q.y;C.bottom=m.y;C.je()}C=u.We;O=u.Ye;(A=u.zd).position.hb(u.K);r.hb(u.target.K);A.jb(r);A.Jb();A.Ua.gb(A.K);u.ng&&(u.ng.visible=u.de);u.de&&u.ng.update();O.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);O.multiply(A.ta);O.multiply(A.Ua);n.Ea(A.ta,A.Ua);g.Ei(n);b.Kk(C);b.clear();u=0;for(C=(L=t.Yb).length;u<C;u++)O=(K=L[u]).object,
K.I=!1,!O.visible||!O.qc||(O instanceof c.Y||O instanceof c.Tb)&&O.De&&!g.gi(O)||(O.Rc.Ea(A.Ua,O.K),K.I=!0);u=0;for(C=L.length;u<C;u++)(K=L[u]).I&&(O=K.object,K=K.buffer,fa=O.F instanceof c.Sb?O.F.oa[0]:O.F,Q=0<O.D.L.length&&fa.L,fa=O instanceof c.lc&&fa.Aa,Q=O.Oh?O.Oh:fa?Q?h:f:Q?e:d,K instanceof c.hc?b.Fk(A,t.Wb,null,Q,K,O):b.Ek(A,t.Wb,null,Q,K,O));u=0;for(C=(L=t.Od).length;u<C;u++)(O=(K=L[u]).object).visible&&O.qc&&(O.Rc.Ea(A.Ua,O.K),b.Gk(A,t.Wb,null,d,O))}G=b.vm();w=b.um();a.clearColor(G.r,G.v,
G.b,w);a.enable(a.BLEND);b.zn===c.Wi&&a.cullFace(a.BACK)}};c.lj.rj=new c.ij;
c.To=function(){function a(t,p){return t.z!==p.z?p.z-t.z:p.id-t.id}var b,d,e,f,h,g,n,m,q,r;this.Dg=function(t){b=t.context;d=t;e=t.ym();f=new Float32Array(16);h=new Uint16Array(6);t=0;f[t++]=-1;f[t++]=-1;f[t++]=0;f[t++]=0;f[t++]=1;f[t++]=-1;f[t++]=1;f[t++]=0;f[t++]=1;f[t++]=1;f[t++]=1;f[t++]=1;f[t++]=-1;f[t++]=1;f[t++]=0;f[t++]=1;t=0;h[t++]=0;h[t++]=1;h[t++]=2;h[t++]=0;h[t++]=2;h[t++]=3;g=b.createBuffer();n=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,g);b.bufferData(b.ARRAY_BUFFER,f,b.STATIC_DRAW);
b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,n);b.bufferData(b.ELEMENT_ARRAY_BUFFER,h,b.STATIC_DRAW);t=c.Qo.Cs;var p=b.createProgram(),w=b.createShader(b.FRAGMENT_SHADER),u=b.createShader(b.VERTEX_SHADER),A="precision "+e+" float;\n";b.shaderSource(w,A+t.S);b.shaderSource(u,A+t.T);b.compileShader(w);b.compileShader(u);b.attachShader(p,w);b.attachShader(p,u);b.linkProgram(p);m=p;r={};(q={}).position=b.getAttribLocation(m,"position");q.va=b.getAttribLocation(m,"uv");r.Rf=b.getUniformLocation(m,"uvOffset");r.Sf=
b.getUniformLocation(m,"uvScale");r.rotation=b.getUniformLocation(m,"rotation");r.scale=b.getUniformLocation(m,"scale");r.tf=b.getUniformLocation(m,"alignment");r.color=b.getUniformLocation(m,"color");r.map=b.getUniformLocation(m,"map");r.opacity=b.getUniformLocation(m,"opacity");r.Nc=b.getUniformLocation(m,"useScreenCoordinates");r.Hb=b.getUniformLocation(m,"sizeAttenuation");r.Di=b.getUniformLocation(m,"screenPosition");r.Wm=b.getUniformLocation(m,"modelViewMatrix");r.ta=b.getUniformLocation(m,
"projectionMatrix");r.ai=b.getUniformLocation(m,"fogType");r.Yh=b.getUniformLocation(m,"fogDensity");r.$h=b.getUniformLocation(m,"fogNear");r.Zh=b.getUniformLocation(m,"fogFar");r.Xh=b.getUniformLocation(m,"fogColor");r.pd=b.getUniformLocation(m,"alphaTest")};this.I=function(t,p,w,u){var A=t.yj,y=A.length;if(y){var C=q,G=r,I=u/w,L=(w=.5*w,.5*u);b.useProgram(m);b.enableVertexAttribArray(C.position);b.enableVertexAttribArray(C.va);b.disable(b.CULL_FACE);b.enable(b.BLEND);b.bindBuffer(b.ARRAY_BUFFER,
g);b.vertexAttribPointer(C.position,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(C.va,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,n);b.uniformMatrix4fv(G.ta,!1,p.ta.elements);b.activeTexture(b.TEXTURE0);b.uniform1i(G.map,0);var K=C=0;(Z=t.J)?(b.uniform3f(G.Xh,Z.color.r,Z.color.v,Z.color.b),Z instanceof c.Xf?(b.uniform1f(G.$h,Z.Ka),b.uniform1f(G.Zh,Z.Oa),b.uniform1i(G.ai,1),K=C=1):Z instanceof c.ff&&(b.uniform1f(G.Yh,Z.Rh),b.uniform1i(G.ai,2),K=C=2)):(b.uniform1i(G.ai,0),K=C=0);for(var Q,O,
fa=[],Z=0;Z<y;Z++)O=(Q=A[Z]).F,Q.visible&&0!==O.opacity&&(O.Nc?Q.z=-Q.position.z:(Q.Rc.Ea(p.Ua,Q.K),Q.z=-Q.Rc.elements[14]));A.sort(a);for(Z=0;Z<y;Z++)O=(Q=A[Z]).F,Q.visible&&0!==O.opacity&&O.map&&O.map.image&&O.map.image.width&&(b.uniform1f(G.pd,O.pd),!0===O.Nc?(b.uniform1i(G.Nc,1),b.uniform3f(G.Di,(Q.position.x*d.devicePixelRatio-w)/w,(L-Q.position.y*d.devicePixelRatio)/L,Math.max(0,Math.min(1,Q.position.z))),fa[0]=d.devicePixelRatio,fa[1]=d.devicePixelRatio):(b.uniform1i(G.Nc,0),b.uniform1i(G.Hb,
O.Hb?1:0),b.uniformMatrix4fv(G.Wm,!1,Q.Rc.elements),fa[0]=1,fa[1]=1),C!==(p=t.J&&O.J?K:0)&&(b.uniform1i(G.ai,p),C=p),p=1/(O.Ng?u:1),fa[0]=fa[0]*p*I*Q.scale.x,fa[1]=fa[1]*p*Q.scale.y,b.uniform2f(G.Sf,O.Sf.x,O.Sf.y),b.uniform2f(G.Rf,O.Rf.x,O.Rf.y),b.uniform2f(G.tf,O.tf.x,O.tf.y),b.uniform1f(G.opacity,O.opacity),b.uniform3f(G.color,O.color.r,O.color.v,O.color.b),b.uniform1f(G.rotation,Q.rotation),b.uniform2fv(G.scale,fa),d.Of(O.qb,O.blendEquation,O.ze,O.ye),d.Ve(O.rc),d.Og(O.td),d.Pg(O.map,0),b.drawElements(b.TRIANGLES,
6,b.UNSIGNED_SHORT,0));b.enable(b.CULL_FACE)}}};
c.dt=function(){this.enabled=!1;this.kn=null;var a,b,d,e,f,h,g=new c.gf,n=new c.da;this.Dg=function(m){a=m.context;b=m;m=c.dg.im;var q=c.nc.clone(m.V);d=new c.Ra({S:m.S,T:m.T,V:q});e=new c.Ra({S:m.S,T:m.T,V:q,L:!0});f=new c.Ra({S:m.S,T:m.T,V:q,Aa:!0});h=new c.Ra({S:m.S,T:m.T,V:q,L:!0,Aa:!0});d.Pd=!0;e.Pd=!0;f.Pd=!0;h.Pd=!0};this.I=function(m,q){this.enabled&&this.update(m,q)};this.update=function(m,q){var r,t,p,w,u;a.clearColor(1,1,1,1);a.disable(a.BLEND);b.Ve(!0);b.Fj&&m.Jb();q.Ua.gb(q.K);n.Ea(q.ta,
q.Ua);g.Ei(n);b.Kk(this.kn);b.clear();var A=0;for(r=(w=m.Yb).length;A<r;A++){var y=(t=w[A]).object;t.I=!1;!y.visible||(y instanceof c.Y||y instanceof c.Tb)&&y.De&&!g.gi(y)||(y.Rc.Ea(q.Ua,y.K),t.I=!0)}A=0;for(r=w.length;A<r;A++)!(t=w[A]).I||(y=t.object,t=t.buffer,y instanceof c.Tb&&!y.Oh)||((u=y.F instanceof c.Sb?y.F.oa[0]:y.F)&&b.Jk(y.F),p=0<y.D.L.length&&u.L,u=y instanceof c.lc&&u.Aa,p=y.Oh?y.Oh:u?p?h:f:p?e:d,t instanceof c.hc?b.Fk(q,m.Wb,null,p,t,y):b.Ek(q,m.Wb,null,p,t,y));A=0;for(r=(w=m.Od).length;A<
r;A++)(y=w[A].object).visible&&(y.Rc.Ea(q.Ua,y.K),b.Gk(q,m.Wb,null,d,y));A=b.vm();r=b.um();a.clearColor(A.r,A.v,A.b,r);a.enable(a.BLEND)}};
c.Cl={Vq:{T:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility = (       visibility.r / 9.0 ) *\n( 1.0 - visibility.g / 9.0 ) *\n(       visibility.b / 9.0 ) *\n( 1.0 - visibility.a / 9.0 );\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",S:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},
Uq:{T:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",S:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};
c.Qo={Cs:{T:"uniform int useScreenCoordinates;\nuniform int sizeAttenuation;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position + alignment;\nvec2 rotatedPosition;\nrotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;\nrotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );\n} else {\nfinalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );\n}\ngl_Position = finalPosition;\n}",
S:"uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"}};
var jf,kf,lf,mf,nf,of,pf=50,qf=85,rf=window.innerWidth/2;function sf(){rf=window.innerWidth/2;kf.lg=window.innerWidth/window.innerHeight;kf.je();mf.Gi(window.innerWidth,window.innerHeight)}function Lf(a){qf=a.clientX-rf}function Mf(a){1===a.touches.length&&(a.preventDefault(),qf=a.touches[0].pageX-rf)}function Nf(a){1===a.touches.length&&(a.preventDefault(),qf=a.touches[0].pageX-rf)}
function Of(){requestAnimationFrame(Of);kf.position.x+=.05*(qf-kf.position.x);kf.position.y=150;kf.position.z=300;kf.jb(lf.position);for(var a=0,b=0;70>b;b++)for(var d=0;70>d;d++)(of=nf[a++]).position.y=50*Math.sin(.3*(b+pf))+50*Math.sin(.5*(d+pf)),of.scale.x=of.scale.y=2*(Math.sin(.3*(b+pf))+1)+2*(Math.sin(.5*(d+pf))+1);mf.I(lf,kf);pf+=.1}
(function(){jf=document.createElement("div");var a=document.getElementById("anim1");document.getElementById("anim").insertBefore(jf,a);(kf=new c.kc(120,window.innerWidth/window.innerHeight,1,1E4)).position.z=1E3;lf=new c.cg;nf=[];var b=2*Math.PI;a=new c.ag({color:8912904,mb:function(h){h.beginPath();h.arc(0,0,.6,0,b,!0);h.fill()}});for(var d=0,e=0;70>e;e++)for(var f=0;70>f;f++)(of=nf[d++]=new c.lf(a)).position.x=50*e-1750,of.position.z=50*f-1750,lf.add(of);(mf=new c.mo).Gi(window.innerWidth,window.innerHeight);
jf.appendChild(mf.km);document.addEventListener("mousemove",Lf,!1);document.addEventListener("touchstart",Mf,!1);document.addEventListener("touchmove",Nf,!1);window.addEventListener("resize",sf,!1)})();Of();
